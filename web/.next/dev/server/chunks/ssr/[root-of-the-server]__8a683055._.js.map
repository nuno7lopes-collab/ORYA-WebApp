{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/env.ts"],"sourcesContent":["// Central helper for server-side environment variables (server-only).\n// ⚠️ Não importar este módulo em componentes com \"use client\".\nconst required = [\n  \"SUPABASE_URL\",\n  \"SUPABASE_ANON_KEY\",\n  \"SUPABASE_SERVICE_ROLE\",\n  \"DATABASE_URL\",\n  \"STRIPE_SECRET_KEY\",\n  \"STRIPE_WEBHOOK_SECRET\",\n  \"QR_SECRET_KEY\",\n  \"RESEND_API_KEY\",\n] as const;\n\ntype EnvKey = (typeof required)[number];\n\nfunction getEnv(key: EnvKey): string {\n  const value = process.env[key];\n  if (!value) {\n    throw new Error(`Missing env var: ${key}`);\n  }\n  return value;\n}\n\nfunction getOptionalUrlEnv(...keys: string[]) {\n  for (const key of keys) {\n    const value = process.env[key];\n    if (typeof value === \"string\" && value.trim().length > 0) {\n      return value.trim().replace(/\\/+$/, \"\"); // remove trailing slash para URLs previsíveis\n    }\n  }\n  return \"\";\n}\n\nfunction parseBoolean(raw: unknown, fallback: boolean) {\n  if (typeof raw === \"boolean\") return raw;\n  if (typeof raw === \"string\") {\n    const normalized = raw.trim().toLowerCase();\n    if ([\"1\", \"true\", \"yes\", \"on\"].includes(normalized)) return true;\n    if ([\"0\", \"false\", \"no\", \"off\"].includes(normalized)) return false;\n  }\n  return fallback;\n}\n\nfunction parseNumber(raw: unknown, fallback: number) {\n  const n = Number(raw);\n  return Number.isFinite(n) ? n : fallback;\n}\n\nexport const env = {\n  supabaseUrl: getEnv(\"SUPABASE_URL\"),\n  supabaseAnonKey: getEnv(\"SUPABASE_ANON_KEY\"),\n  serviceRoleKey: getEnv(\"SUPABASE_SERVICE_ROLE\"),\n  dbUrl: getEnv(\"DATABASE_URL\"),\n  stripeSecretKey: getEnv(\"STRIPE_SECRET_KEY\"),\n  stripeWebhookSecret: getEnv(\"STRIPE_WEBHOOK_SECRET\"),\n  qrSecretKey: getEnv(\"QR_SECRET_KEY\"),\n  resendApiKey: getEnv(\"RESEND_API_KEY\"),\n  resendFrom:\n    process.env.RESEND_FROM ??\n    process.env.RESEND_FROM_EMAIL ??\n    \"no-reply@orya.pt\",\n  appBaseUrl: getOptionalUrlEnv(\"APP_BASE_URL\", \"NEXT_PUBLIC_BASE_URL\", \"NEXT_PUBLIC_SITE_URL\", \"VERCEL_URL\"),\n  uploadsBucket:\n    process.env.SUPABASE_STORAGE_BUCKET_UPLOADS ??\n    process.env.SUPABASE_STORAGE_BUCKET ??\n    \"uploads\",\n  avatarsBucket: process.env.SUPABASE_STORAGE_BUCKET_AVATARS ?? \"\",\n  eventCoversBucket: process.env.SUPABASE_STORAGE_BUCKET_EVENT_COVERS ?? \"\",\n  storageSignedUrls: parseBoolean(process.env.SUPABASE_STORAGE_SIGNED_URLS, false),\n  storageSignedTtlSeconds: parseNumber(process.env.SUPABASE_STORAGE_SIGNED_TTL_SECONDS, 60 * 60 * 24 * 30), // 30 dias\n};\n"],"names":[],"mappings":"AAAA,sEAAsE;AACtE,+DAA+D;;;;;AAC/D,MAAM,WAAW;IACf;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAID,SAAS,OAAO,GAAW;IACzB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;IAC9B,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,KAAK;IAC3C;IACA,OAAO;AACT;AAEA,SAAS,kBAAkB,GAAG,IAAc;IAC1C,KAAK,MAAM,OAAO,KAAM;QACtB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;QAC9B,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,GAAG,MAAM,GAAG,GAAG;YACxD,OAAO,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,KAAK,8CAA8C;QACzF;IACF;IACA,OAAO;AACT;AAEA,SAAS,aAAa,GAAY,EAAE,QAAiB;IACnD,IAAI,OAAO,QAAQ,WAAW,OAAO;IACrC,IAAI,OAAO,QAAQ,UAAU;QAC3B,MAAM,aAAa,IAAI,IAAI,GAAG,WAAW;QACzC,IAAI;YAAC;YAAK;YAAQ;YAAO;SAAK,CAAC,QAAQ,CAAC,aAAa,OAAO;QAC5D,IAAI;YAAC;YAAK;YAAS;YAAM;SAAM,CAAC,QAAQ,CAAC,aAAa,OAAO;IAC/D;IACA,OAAO;AACT;AAEA,SAAS,YAAY,GAAY,EAAE,QAAgB;IACjD,MAAM,IAAI,OAAO;IACjB,OAAO,OAAO,QAAQ,CAAC,KAAK,IAAI;AAClC;AAEO,MAAM,MAAM;IACjB,aAAa,OAAO;IACpB,iBAAiB,OAAO;IACxB,gBAAgB,OAAO;IACvB,OAAO,OAAO;IACd,iBAAiB,OAAO;IACxB,qBAAqB,OAAO;IAC5B,aAAa,OAAO;IACpB,cAAc,OAAO;IACrB,YACE,QAAQ,GAAG,CAAC,WAAW,IACvB,QAAQ,GAAG,CAAC,iBAAiB,IAC7B;IACF,YAAY,kBAAkB,gBAAgB,wBAAwB,wBAAwB;IAC9F,eACE,QAAQ,GAAG,CAAC,+BAA+B,IAC3C,QAAQ,GAAG,CAAC,uBAAuB,IACnC;IACF,eAAe,QAAQ,GAAG,CAAC,+BAA+B,IAAI;IAC9D,mBAAmB,QAAQ,GAAG,CAAC,oCAAoC,IAAI;IACvE,mBAAmB,aAAa,QAAQ,GAAG,CAAC,4BAA4B,EAAE;IAC1E,yBAAyB,YAAY,QAAQ,GAAG,CAAC,mCAAmC,EAAE,KAAK,KAAK,KAAK;AACvG"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\nimport { Prisma, PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\nimport { env } from \"@/lib/env\";\n\n// Toggle de logs verbose (queries) via env: PRISMA_LOG_QUERIES=true\nconst enableQueryLog = process.env.PRISMA_LOG_QUERIES === \"true\";\nconst logLevels: (Prisma.LogLevel | Prisma.LogDefinition)[] =\n  process.env.NODE_ENV === \"development\"\n    ? enableQueryLog\n      ? [\"query\", \"error\", \"warn\"]\n      : [\"error\", \"warn\"]\n    : [\"error\"];\n\n// Evitar múltiplas instâncias em dev (hot reload)\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n};\n\n// Pool e adapter para usar o client engine (\"library\") com Postgres\nconst pool = new Pool({\n  connectionString: env.dbUrl,\n  ssl:\n    process.env.NODE_ENV === \"production\"\n      ? undefined\n      : { rejectUnauthorized: false },\n});\n\nconst adapter = new PrismaPg(pool);\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: logLevels,\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AACA;AACA;AACA;;;;;;;;;;AAEA,oEAAoE;AACpE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,kBAAkB,KAAK;AAC1D,MAAM,YACJ,uCACI,iBACE;IAAC;IAAS;IAAS;CAAO,GAC1B;IAAC;IAAS;CAAO,GACnB;AAEN,kDAAkD;AAClD,MAAM,kBAAkB;AAIxB,oEAAoE;AACpE,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,iHAAG,CAAC,KAAK;IAC3B,KACE,sCACI,0BACA;QAAE,oBAAoB;IAAM;AACpC;AAEA,MAAM,UAAU,IAAI,8JAAQ,CAAC;AAEtB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf;IACA,KAAK;AACP;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/inscricoes/%5Bid%5D/FormSubmissionClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FormSubmissionClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call FormSubmissionClient() from the server but FormSubmissionClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/inscricoes/[id]/FormSubmissionClient.tsx <module evaluation>\",\n    \"FormSubmissionClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,uBAAuB,IAAA,wQAAuB,EACvD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,8EACA","ignoreList":[0]}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/inscricoes/%5Bid%5D/FormSubmissionClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FormSubmissionClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call FormSubmissionClient() from the server but FormSubmissionClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/inscricoes/[id]/FormSubmissionClient.tsx\",\n    \"FormSubmissionClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,uBAAuB,IAAA,wQAAuB,EACvD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,0DACA","ignoreList":[0]}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerPremium.ts"],"sourcesContent":["import type { LiveHubModule } from \"@/lib/liveHubConfig\";\n\ntype OrganizerRef = {\n  id?: number | null;\n  username?: string | null;\n  // Gerido por subscrição (SaaS), não editar manualmente na UI.\n  liveHubPremiumEnabled?: boolean | null;\n};\n\ntype OrganizerPremiumModules = {\n  inscricoes?: boolean;\n  loja?: boolean;\n  galeria?: boolean;\n};\n\ntype LiveHubMatchOrder = \"ONEVONE\";\n\ntype OrganizerPremiumConfig = {\n  key: \"ONEVONE\";\n  organizerId: number;\n  username: string;\n  liveHubModules?: LiveHubModule[];\n  profileModules?: OrganizerPremiumModules;\n  liveHubMatchOrder?: LiveHubMatchOrder;\n};\n\nconst CUSTOM_PREMIUM_CONFIGS: OrganizerPremiumConfig[] = [\n  {\n    key: \"ONEVONE\",\n    organizerId: 23,\n    username: \"onevone\",\n    liveHubModules: [\"HERO\", \"VIDEO\", \"NOW_PLAYING\", \"NEXT_MATCHES\", \"RESULTS\", \"BRACKET\", \"SPONSORS\"],\n    profileModules: { inscricoes: true, loja: true, galeria: true },\n    liveHubMatchOrder: \"ONEVONE\",\n  },\n];\n\nconst normalizeUsername = (value?: string | null) => (typeof value === \"string\" ? value.trim().toLowerCase() : \"\");\n\nexport function getCustomPremiumConfig(organizer?: OrganizerRef | null) {\n  if (!organizer) return null;\n  const normalizedUsername = normalizeUsername(organizer.username);\n  return (\n    CUSTOM_PREMIUM_CONFIGS.find(\n      (config) =>\n        (config.organizerId && organizer.id === config.organizerId) ||\n        (normalizedUsername && config.username === normalizedUsername),\n    ) ?? null\n  );\n}\n\nexport function isCustomPremiumOrganizer(organizer?: OrganizerRef | null) {\n  return Boolean(getCustomPremiumConfig(organizer));\n}\n\nexport function isCustomPremiumActive(organizer?: OrganizerRef | null, premiumEnabled?: boolean | null) {\n  const config = getCustomPremiumConfig(organizer);\n  if (!config) return false;\n  const enabled = premiumEnabled ?? organizer?.liveHubPremiumEnabled ?? false;\n  return Boolean(enabled);\n}\n\nexport function getCustomPremiumKey(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.key ?? null;\n}\n\nexport function getCustomLiveHubModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubModules ?? null;\n}\n\nexport function getCustomPremiumProfileModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.profileModules ?? null;\n}\n\nexport function getCustomLiveHubMatchOrder(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubMatchOrder ?? null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AA0BA,MAAM,yBAAmD;IACvD;QACE,KAAK;QACL,aAAa;QACb,UAAU;QACV,gBAAgB;YAAC;YAAQ;YAAS;YAAe;YAAgB;YAAW;YAAW;SAAW;QAClG,gBAAgB;YAAE,YAAY;YAAM,MAAM;YAAM,SAAS;QAAK;QAC9D,mBAAmB;IACrB;CACD;AAED,MAAM,oBAAoB,CAAC,QAA2B,OAAO,UAAU,WAAW,MAAM,IAAI,GAAG,WAAW,KAAK;AAExG,SAAS,uBAAuB,SAA+B;IACpE,IAAI,CAAC,WAAW,OAAO;IACvB,MAAM,qBAAqB,kBAAkB,UAAU,QAAQ;IAC/D,OACE,uBAAuB,IAAI,CACzB,CAAC,SACC,AAAC,OAAO,WAAW,IAAI,UAAU,EAAE,KAAK,OAAO,WAAW,IACzD,sBAAsB,OAAO,QAAQ,KAAK,uBAC1C;AAET;AAEO,SAAS,yBAAyB,SAA+B;IACtE,OAAO,QAAQ,uBAAuB;AACxC;AAEO,SAAS,sBAAsB,SAA+B,EAAE,cAA+B;IACpG,MAAM,SAAS,uBAAuB;IACtC,IAAI,CAAC,QAAQ,OAAO;IACpB,MAAM,UAAU,kBAAkB,WAAW,yBAAyB;IACtE,OAAO,QAAQ;AACjB;AAEO,SAAS,oBAAoB,SAA+B;IACjE,OAAO,uBAAuB,YAAY,OAAO;AACnD;AAEO,SAAS,wBAAwB,SAA+B;IACrE,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,+BAA+B,SAA+B;IAC5E,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,2BAA2B,SAA+B;IACxE,OAAO,uBAAuB,YAAY,qBAAqB;AACjE"}},
    {"offset": {"line": 287, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/inscricoes/%5Bid%5D/page.tsx"],"sourcesContent":["import { notFound } from \"next/navigation\";\nimport { prisma } from \"@/lib/prisma\";\nimport { FormSubmissionClient } from \"./FormSubmissionClient\";\nimport { getCustomPremiumProfileModules, isCustomPremiumActive } from \"@/lib/organizerPremium\";\n\ntype Params = { id: string };\n\nexport default async function PublicFormPage({ params }: { params: Promise<Params> }) {\n  const { id } = await params;\n  const formId = Number(id);\n  if (!formId || Number.isNaN(formId)) notFound();\n\n  const form = await prisma.organizationForm.findUnique({\n    where: { id: formId },\n    include: {\n      organizer: {\n        select: {\n          id: true,\n          status: true,\n          publicName: true,\n          businessName: true,\n          username: true,\n          liveHubPremiumEnabled: true,\n        },\n      },\n      fields: { orderBy: { order: \"asc\" } },\n    },\n  });\n\n  if (!form || form.organizer.status !== \"ACTIVE\") {\n    notFound();\n  }\n\n  const premiumActive = isCustomPremiumActive(form.organizer);\n  const premiumModules = premiumActive ? getCustomPremiumProfileModules(form.organizer) ?? {} : {};\n  const allowInscricoes = Boolean(premiumModules.inscricoes);\n  const isPublic = form.status !== \"ARCHIVED\";\n  if (!isPublic) {\n    notFound();\n  }\n\n  const moduleEnabled = await prisma.organizationModuleEntry.findFirst({\n    where: { organizerId: form.organizer.id, moduleKey: \"INSCRICOES\", enabled: true },\n    select: { organizerId: true },\n  });\n\n  if (!moduleEnabled || !allowInscricoes) {\n    notFound();\n  }\n\n  const organizerName =\n    form.organizer.publicName ||\n    form.organizer.businessName ||\n    form.organizer.username ||\n    \"Organização\";\n\n  const fields = form.fields.map((field) => ({\n    id: field.id,\n    label: field.label,\n    fieldType: field.fieldType,\n    required: field.required,\n    helpText: field.helpText ?? null,\n    placeholder: field.placeholder ?? null,\n    options: Array.isArray(field.options)\n      ? field.options.map((opt) => String(opt))\n      : null,\n  }));\n\n  return (\n    <FormSubmissionClient\n      form={{\n        id: form.id,\n        title: form.title,\n        description: form.description ?? null,\n        status: form.status,\n        organizerName,\n        organizerUsername: form.organizer.username ?? null,\n        capacity: form.capacity ?? null,\n        waitlistEnabled: form.waitlistEnabled,\n        startAt: form.startAt ? form.startAt.toISOString() : null,\n        endAt: form.endAt ? form.endAt.toISOString() : null,\n        fields,\n      }}\n    />\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;AAIe,eAAe,eAAe,EAAE,MAAM,EAA+B;IAClF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,SAAS,OAAO;IACtB,IAAI,CAAC,UAAU,OAAO,KAAK,CAAC,SAAS,IAAA,iMAAQ;IAE7C,MAAM,OAAO,MAAM,uHAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC;QACpD,OAAO;YAAE,IAAI;QAAO;QACpB,SAAS;YACP,WAAW;gBACT,QAAQ;oBACN,IAAI;oBACJ,QAAQ;oBACR,YAAY;oBACZ,cAAc;oBACd,UAAU;oBACV,uBAAuB;gBACzB;YACF;YACA,QAAQ;gBAAE,SAAS;oBAAE,OAAO;gBAAM;YAAE;QACtC;IACF;IAEA,IAAI,CAAC,QAAQ,KAAK,SAAS,CAAC,MAAM,KAAK,UAAU;QAC/C,IAAA,iMAAQ;IACV;IAEA,MAAM,gBAAgB,IAAA,gJAAqB,EAAC,KAAK,SAAS;IAC1D,MAAM,iBAAiB,gBAAgB,IAAA,yJAA8B,EAAC,KAAK,SAAS,KAAK,CAAC,IAAI,CAAC;IAC/F,MAAM,kBAAkB,QAAQ,eAAe,UAAU;IACzD,MAAM,WAAW,KAAK,MAAM,KAAK;IACjC,IAAI,CAAC,UAAU;QACb,IAAA,iMAAQ;IACV;IAEA,MAAM,gBAAgB,MAAM,uHAAM,CAAC,uBAAuB,CAAC,SAAS,CAAC;QACnE,OAAO;YAAE,aAAa,KAAK,SAAS,CAAC,EAAE;YAAE,WAAW;YAAc,SAAS;QAAK;QAChF,QAAQ;YAAE,aAAa;QAAK;IAC9B;IAEA,IAAI,CAAC,iBAAiB,CAAC,iBAAiB;QACtC,IAAA,iMAAQ;IACV;IAEA,MAAM,gBACJ,KAAK,SAAS,CAAC,UAAU,IACzB,KAAK,SAAS,CAAC,YAAY,IAC3B,KAAK,SAAS,CAAC,QAAQ,IACvB;IAEF,MAAM,SAAS,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,QAAU,CAAC;YACzC,IAAI,MAAM,EAAE;YACZ,OAAO,MAAM,KAAK;YAClB,WAAW,MAAM,SAAS;YAC1B,UAAU,MAAM,QAAQ;YACxB,UAAU,MAAM,QAAQ,IAAI;YAC5B,aAAa,MAAM,WAAW,IAAI;YAClC,SAAS,MAAM,OAAO,CAAC,MAAM,OAAO,IAChC,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,MAAQ,OAAO,QAClC;QACN,CAAC;IAED,qBACE,8OAAC,4KAAoB;QACnB,MAAM;YACJ,IAAI,KAAK,EAAE;YACX,OAAO,KAAK,KAAK;YACjB,aAAa,KAAK,WAAW,IAAI;YACjC,QAAQ,KAAK,MAAM;YACnB;YACA,mBAAmB,KAAK,SAAS,CAAC,QAAQ,IAAI;YAC9C,UAAU,KAAK,QAAQ,IAAI;YAC3B,iBAAiB,KAAK,eAAe;YACrC,SAAS,KAAK,OAAO,GAAG,KAAK,OAAO,CAAC,WAAW,KAAK;YACrD,OAAO,KAAK,KAAK,GAAG,KAAK,KAAK,CAAC,WAAW,KAAK;YAC/C;QACF;;;;;;AAGN"}}]
}