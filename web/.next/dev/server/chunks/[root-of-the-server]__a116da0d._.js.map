{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/env.ts"],"sourcesContent":["// Central helper for server-side environment variables (server-only).\n// ⚠️ Não importar este módulo em componentes com \"use client\".\nconst required = [\n  \"SUPABASE_URL\",\n  \"SUPABASE_ANON_KEY\",\n  \"SUPABASE_SERVICE_ROLE\",\n  \"DATABASE_URL\",\n  \"STRIPE_SECRET_KEY\",\n  \"STRIPE_WEBHOOK_SECRET\",\n  \"QR_SECRET_KEY\",\n  \"RESEND_API_KEY\",\n] as const;\n\ntype EnvKey = (typeof required)[number];\n\nfunction getEnv(key: EnvKey): string {\n  const value = process.env[key];\n  if (!value) {\n    throw new Error(`Missing env var: ${key}`);\n  }\n  return value;\n}\n\nfunction getOptionalUrlEnv(...keys: string[]) {\n  for (const key of keys) {\n    const value = process.env[key];\n    if (typeof value === \"string\" && value.trim().length > 0) {\n      return value.trim().replace(/\\/+$/, \"\"); // remove trailing slash para URLs previsíveis\n    }\n  }\n  return \"\";\n}\n\nfunction parseBoolean(raw: unknown, fallback: boolean) {\n  if (typeof raw === \"boolean\") return raw;\n  if (typeof raw === \"string\") {\n    const normalized = raw.trim().toLowerCase();\n    if ([\"1\", \"true\", \"yes\", \"on\"].includes(normalized)) return true;\n    if ([\"0\", \"false\", \"no\", \"off\"].includes(normalized)) return false;\n  }\n  return fallback;\n}\n\nfunction parseNumber(raw: unknown, fallback: number) {\n  const n = Number(raw);\n  return Number.isFinite(n) ? n : fallback;\n}\n\nfunction parseList(raw: unknown) {\n  if (typeof raw !== \"string\") return [];\n  return raw\n    .split(/[,\\s]+/g)\n    .map((item) => item.trim())\n    .filter(Boolean);\n}\n\nexport const env = {\n  supabaseUrl: getEnv(\"SUPABASE_URL\"),\n  supabaseAnonKey: getEnv(\"SUPABASE_ANON_KEY\"),\n  serviceRoleKey: getEnv(\"SUPABASE_SERVICE_ROLE\"),\n  dbUrl: getEnv(\"DATABASE_URL\"),\n  stripeSecretKey: getEnv(\"STRIPE_SECRET_KEY\"),\n  stripeWebhookSecret: getEnv(\"STRIPE_WEBHOOK_SECRET\"),\n  qrSecretKey: getEnv(\"QR_SECRET_KEY\"),\n  resendApiKey: getEnv(\"RESEND_API_KEY\"),\n  resendFrom:\n    process.env.RESEND_FROM ??\n    process.env.RESEND_FROM_EMAIL ??\n    \"no-reply@orya.pt\",\n  appBaseUrl: getOptionalUrlEnv(\"APP_BASE_URL\", \"NEXT_PUBLIC_BASE_URL\", \"NEXT_PUBLIC_SITE_URL\", \"VERCEL_URL\"),\n  uploadsBucket:\n    process.env.SUPABASE_STORAGE_BUCKET_UPLOADS ??\n    process.env.SUPABASE_STORAGE_BUCKET ??\n    \"uploads\",\n  avatarsBucket: process.env.SUPABASE_STORAGE_BUCKET_AVATARS ?? \"\",\n  eventCoversBucket: process.env.SUPABASE_STORAGE_BUCKET_EVENT_COVERS ?? \"\",\n  storageSignedUrls: parseBoolean(process.env.SUPABASE_STORAGE_SIGNED_URLS, false),\n  storageSignedTtlSeconds: parseNumber(process.env.SUPABASE_STORAGE_SIGNED_TTL_SECONDS, 60 * 60 * 24 * 30), // 30 dias\n  stripePremiumPriceIds: parseList(process.env.STRIPE_PREMIUM_PRICE_IDS),\n  stripePremiumProductIds: parseList(process.env.STRIPE_PREMIUM_PRODUCT_IDS),\n};\n"],"names":[],"mappings":"AAAA,sEAAsE;AACtE,+DAA+D;;;;;AAC/D,MAAM,WAAW;IACf;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAID,SAAS,OAAO,GAAW;IACzB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;IAC9B,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,KAAK;IAC3C;IACA,OAAO;AACT;AAEA,SAAS,kBAAkB,GAAG,IAAc;IAC1C,KAAK,MAAM,OAAO,KAAM;QACtB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;QAC9B,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,GAAG,MAAM,GAAG,GAAG;YACxD,OAAO,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,KAAK,8CAA8C;QACzF;IACF;IACA,OAAO;AACT;AAEA,SAAS,aAAa,GAAY,EAAE,QAAiB;IACnD,IAAI,OAAO,QAAQ,WAAW,OAAO;IACrC,IAAI,OAAO,QAAQ,UAAU;QAC3B,MAAM,aAAa,IAAI,IAAI,GAAG,WAAW;QACzC,IAAI;YAAC;YAAK;YAAQ;YAAO;SAAK,CAAC,QAAQ,CAAC,aAAa,OAAO;QAC5D,IAAI;YAAC;YAAK;YAAS;YAAM;SAAM,CAAC,QAAQ,CAAC,aAAa,OAAO;IAC/D;IACA,OAAO;AACT;AAEA,SAAS,YAAY,GAAY,EAAE,QAAgB;IACjD,MAAM,IAAI,OAAO;IACjB,OAAO,OAAO,QAAQ,CAAC,KAAK,IAAI;AAClC;AAEA,SAAS,UAAU,GAAY;IAC7B,IAAI,OAAO,QAAQ,UAAU,OAAO,EAAE;IACtC,OAAO,IACJ,KAAK,CAAC,WACN,GAAG,CAAC,CAAC,OAAS,KAAK,IAAI,IACvB,MAAM,CAAC;AACZ;AAEO,MAAM,MAAM;IACjB,aAAa,OAAO;IACpB,iBAAiB,OAAO;IACxB,gBAAgB,OAAO;IACvB,OAAO,OAAO;IACd,iBAAiB,OAAO;IACxB,qBAAqB,OAAO;IAC5B,aAAa,OAAO;IACpB,cAAc,OAAO;IACrB,YACE,QAAQ,GAAG,CAAC,WAAW,IACvB,QAAQ,GAAG,CAAC,iBAAiB,IAC7B;IACF,YAAY,kBAAkB,gBAAgB,wBAAwB,wBAAwB;IAC9F,eACE,QAAQ,GAAG,CAAC,+BAA+B,IAC3C,QAAQ,GAAG,CAAC,uBAAuB,IACnC;IACF,eAAe,QAAQ,GAAG,CAAC,+BAA+B,IAAI;IAC9D,mBAAmB,QAAQ,GAAG,CAAC,oCAAoC,IAAI;IACvE,mBAAmB,aAAa,QAAQ,GAAG,CAAC,4BAA4B,EAAE;IAC1E,yBAAyB,YAAY,QAAQ,GAAG,CAAC,mCAAmC,EAAE,KAAK,KAAK,KAAK;IACrG,uBAAuB,UAAU,QAAQ,GAAG,CAAC,wBAAwB;IACrE,yBAAyB,UAAU,QAAQ,GAAG,CAAC,0BAA0B;AAC3E"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/supabaseServer.ts"],"sourcesContent":["import \"server-only\";\nimport { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\nimport { env } from \"@/lib/env\";\n\nfunction decodeBase64Cookie(raw: string) {\n  const BASE64_PREFIX = \"base64-\";\n  if (!raw.startsWith(BASE64_PREFIX)) return raw;\n\n  const base = raw.slice(BASE64_PREFIX.length);\n  const encodings: BufferEncoding[] = [\"base64url\", \"base64\"];\n\n  for (const enc of encodings) {\n    try {\n      return Buffer.from(base, enc).toString(\"utf-8\");\n    } catch {\n      /* try next */\n    }\n  }\n\n  // Se não conseguirmos decodificar, tratamos como cookie ausente para evitar JSON.parse de strings inválidas\n  return undefined;\n}\n\n/**\n * Server-side Supabase client (SSR + Route Handlers)\n * - Safe cookie reading\n * - Safe cookie writing\n * - Prevents JSON parse errors\n * - No profile fetching here\n */\nexport async function createSupabaseServer() {\n  const cookieStore = (await cookies());\n\n  const supabase = createServerClient(\n    env.supabaseUrl,\n    env.supabaseAnonKey,\n    {\n      cookies: {\n        get(name: string) {\n          try {\n            // Só devolvemos cookies do Supabase (sb-*) e ignoramos o resto\n            if (!name.startsWith(\"sb-\")) return undefined;\n            const raw = cookieStore.get(name)?.value;\n            if (!raw) return undefined;\n\n            // Se for um chunk (sb-*.0, sb-*.1, ...), deixamos intacto para o combinador do Supabase tratar\n            const isChunk = /\\.\\d+$/.test(name);\n            return isChunk ? raw : decodeBase64Cookie(raw);\n          } catch {\n            return undefined;\n          }\n        },\n        set(name: string, value: string, options: Record<string, unknown>) {\n          try {\n            cookieStore.set({ name, value, ...options });\n          } catch {\n            /* ignore errors for RSC */\n          }\n        },\n        remove(name: string, options: Record<string, unknown>) {\n          try {\n            cookieStore.set({ name, value: \"\", ...options, maxAge: 0 });\n          } catch {\n            /* ignore */\n          }\n        },\n      },\n    }\n  );\n\n  return supabase;\n}\n\n\nexport async function getCurrentUser() {\n  const supabase = await createSupabaseServer();\n\n  try {\n    const { data, error } = await supabase.auth.getUser();\n\n    if (error || !data?.user) {\n      return { user: null, error };\n    }\n\n    return { user: data.user, error: null };\n  } catch (err) {\n    return { user: null, error: err };\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;AAEA,SAAS,mBAAmB,GAAW;IACrC,MAAM,gBAAgB;IACtB,IAAI,CAAC,IAAI,UAAU,CAAC,gBAAgB,OAAO;IAE3C,MAAM,OAAO,IAAI,KAAK,CAAC,cAAc,MAAM;IAC3C,MAAM,YAA8B;QAAC;QAAa;KAAS;IAE3D,KAAK,MAAM,OAAO,UAAW;QAC3B,IAAI;YACF,OAAO,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,CAAC;QACzC,EAAE,OAAM;QACN,YAAY,GACd;IACF;IAEA,4GAA4G;IAC5G,OAAO;AACT;AASO,eAAe;IACpB,MAAM,cAAe,MAAM,IAAA,4IAAO;IAElC,MAAM,WAAW,IAAA,iMAAkB,EACjC,mHAAG,CAAC,WAAW,EACf,mHAAG,CAAC,eAAe,EACnB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,IAAI;oBACF,+DAA+D;oBAC/D,IAAI,CAAC,KAAK,UAAU,CAAC,QAAQ,OAAO;oBACpC,MAAM,MAAM,YAAY,GAAG,CAAC,OAAO;oBACnC,IAAI,CAAC,KAAK,OAAO;oBAEjB,+FAA+F;oBAC/F,MAAM,UAAU,SAAS,IAAI,CAAC;oBAC9B,OAAO,UAAU,MAAM,mBAAmB;gBAC5C,EAAE,OAAM;oBACN,OAAO;gBACT;YACF;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAgC;gBAC/D,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAM;gBACN,yBAAyB,GAC3B;YACF;YACA,QAAO,IAAY,EAAE,OAAgC;gBACnD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;wBAAE,QAAQ;oBAAE;gBAC3D,EAAE,OAAM;gBACN,UAAU,GACZ;YACF;QACF;IACF;IAGF,OAAO;AACT;AAGO,eAAe;IACpB,MAAM,WAAW,MAAM;IAEvB,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAEnD,IAAI,SAAS,CAAC,MAAM,MAAM;YACxB,OAAO;gBAAE,MAAM;gBAAM;YAAM;QAC7B;QAEA,OAAO;YAAE,MAAM,KAAK,IAAI;YAAE,OAAO;QAAK;IACxC,EAAE,OAAO,KAAK;QACZ,OAAO;YAAE,MAAM;YAAM,OAAO;QAAI;IAClC;AACF"}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\nimport { Prisma, PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\nimport { env } from \"@/lib/env\";\n\n// Toggle de logs verbose (queries) via env: PRISMA_LOG_QUERIES=true\nconst enableQueryLog = process.env.PRISMA_LOG_QUERIES === \"true\";\nconst logLevels: (Prisma.LogLevel | Prisma.LogDefinition)[] =\n  process.env.NODE_ENV === \"development\"\n    ? enableQueryLog\n      ? [\"query\", \"error\", \"warn\"]\n      : [\"error\", \"warn\"]\n    : [\"error\"];\n\n// Evitar múltiplas instâncias em dev (hot reload)\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n};\n\n// Pool e adapter para usar o client engine (\"library\") com Postgres\nconst pool = new Pool({\n  connectionString: env.dbUrl,\n  ssl:\n    process.env.NODE_ENV === \"production\"\n      ? undefined\n      : { rejectUnauthorized: false },\n});\n\nconst adapter = new PrismaPg(pool);\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: logLevels,\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AACA;AACA;AACA;;;;;;;;;;AAEA,oEAAoE;AACpE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,kBAAkB,KAAK;AAC1D,MAAM,YACJ,uCACI,iBACE;IAAC;IAAS;IAAS;CAAO,GAC1B;IAAC;IAAS;CAAO,GACnB;AAEN,kDAAkD;AAClD,MAAM,kBAAkB;AAIxB,oEAAoE;AACpE,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,mHAAG,CAAC,KAAK;IAC3B,KACE,sCACI,0BACA;QAAE,oBAAoB;IAAM;AACpC;AAEA,MAAM,UAAU,IAAI,8JAAQ,CAAC;AAEtB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf;IACA,KAAK;AACP;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 305, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizationCategories.ts"],"sourcesContent":["export const ORGANIZATION_CATEGORIES = [\"EVENTOS\", \"PADEL\", \"VOLUNTARIADO\"] as const;\nexport type OrganizationCategory = (typeof ORGANIZATION_CATEGORIES)[number];\n\nexport const ORGANIZATION_MODULES = [\"INSCRICOES\", \"LOJA\", \"GALERIA\"] as const;\nexport type OrganizationModule = (typeof ORGANIZATION_MODULES)[number];\n\nexport const DEFAULT_ORGANIZATION_CATEGORY: OrganizationCategory = \"EVENTOS\";\nexport const DEFAULT_ORGANIZATION_MODULES: OrganizationModule[] = [\"INSCRICOES\"];\n\nconst organizationCategorySet = new Set<OrganizationCategory>(ORGANIZATION_CATEGORIES);\nconst organizationModuleSet = new Set<OrganizationModule>(ORGANIZATION_MODULES);\n\nexport function parseOrganizationCategory(value: unknown): OrganizationCategory | null {\n  if (typeof value !== \"string\") return null;\n  const normalized = value.trim().toUpperCase();\n  if (!normalized) return null;\n  return organizationCategorySet.has(normalized as OrganizationCategory)\n    ? (normalized as OrganizationCategory)\n    : null;\n}\n\nexport function parseOrganizationModules(value: unknown): OrganizationModule[] | null {\n  if (!Array.isArray(value)) return null;\n  const normalized: OrganizationModule[] = [];\n  for (const entry of value) {\n    if (typeof entry !== \"string\") return null;\n    const candidate = entry.trim().toUpperCase();\n    if (!candidate) return null;\n    if (!organizationModuleSet.has(candidate as OrganizationModule)) return null;\n    if (!normalized.includes(candidate as OrganizationModule)) {\n      normalized.push(candidate as OrganizationModule);\n    }\n  }\n  return normalized;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAO,MAAM,0BAA0B;IAAC;IAAW;IAAS;CAAe;AAGpE,MAAM,uBAAuB;IAAC;IAAc;IAAQ;CAAU;AAG9D,MAAM,gCAAsD;AAC5D,MAAM,+BAAqD;IAAC;CAAa;AAEhF,MAAM,0BAA0B,IAAI,IAA0B;AAC9D,MAAM,wBAAwB,IAAI,IAAwB;AAEnD,SAAS,0BAA0B,KAAc;IACtD,IAAI,OAAO,UAAU,UAAU,OAAO;IACtC,MAAM,aAAa,MAAM,IAAI,GAAG,WAAW;IAC3C,IAAI,CAAC,YAAY,OAAO;IACxB,OAAO,wBAAwB,GAAG,CAAC,cAC9B,aACD;AACN;AAEO,SAAS,yBAAyB,KAAc;IACrD,IAAI,CAAC,MAAM,OAAO,CAAC,QAAQ,OAAO;IAClC,MAAM,aAAmC,EAAE;IAC3C,KAAK,MAAM,SAAS,MAAO;QACzB,IAAI,OAAO,UAAU,UAAU,OAAO;QACtC,MAAM,YAAY,MAAM,IAAI,GAAG,WAAW;QAC1C,IAAI,CAAC,WAAW,OAAO;QACvB,IAAI,CAAC,sBAAsB,GAAG,CAAC,YAAkC,OAAO;QACxE,IAAI,CAAC,WAAW,QAAQ,CAAC,YAAkC;YACzD,WAAW,IAAI,CAAC;QAClB;IACF;IACA,OAAO;AACT"}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/liveHubConfig.ts"],"sourcesContent":["import { OrganizationCategory } from \"@prisma/client\";\n\nexport type LiveHubModule =\n  | \"HERO\"\n  | \"VIDEO\"\n  | \"NOW_PLAYING\"\n  | \"BRACKET\"\n  | \"RESULTS\"\n  | \"NEXT_MATCHES\"\n  | \"CHAMPION\"\n  | \"SUMMARY\"\n  | \"UPDATES\"\n  | \"CTA\"\n  | \"SPONSORS\";\n\nexport type LiveHubViewerRole = \"PUBLIC\" | \"PARTICIPANT\" | \"ORGANIZER\";\nexport type LiveHubMode = \"DEFAULT\" | \"PREMIUM\";\n\nconst DEFAULT_MODULES: Record<OrganizationCategory, LiveHubModule[]> = {\n  PADEL: [\"HERO\", \"VIDEO\", \"NEXT_MATCHES\", \"RESULTS\", \"BRACKET\"],\n  EVENTOS: [\"HERO\", \"VIDEO\", \"NOW_PLAYING\", \"NEXT_MATCHES\", \"RESULTS\", \"BRACKET\", \"SPONSORS\"],\n  VOLUNTARIADO: [\"HERO\", \"SUMMARY\", \"CTA\"],\n};\n\nconst PREMIUM_MODULES: Partial<Record<OrganizationCategory, LiveHubModule[]>> = {};\n\nexport function resolveLiveHubModules(params: {\n  category: OrganizationCategory;\n  mode: LiveHubMode;\n  premiumActive: boolean;\n}) {\n  const { category, mode, premiumActive } = params;\n  const usePremium = mode === \"PREMIUM\" && premiumActive;\n  if (usePremium) {\n    return PREMIUM_MODULES[category] ?? DEFAULT_MODULES[category];\n  }\n  return DEFAULT_MODULES[category];\n}\n"],"names":[],"mappings":";;;;AAkBA,MAAM,kBAAiE;IACrE,OAAO;QAAC;QAAQ;QAAS;QAAgB;QAAW;KAAU;IAC9D,SAAS;QAAC;QAAQ;QAAS;QAAe;QAAgB;QAAW;QAAW;KAAW;IAC3F,cAAc;QAAC;QAAQ;QAAW;KAAM;AAC1C;AAEA,MAAM,kBAA0E,CAAC;AAE1E,SAAS,sBAAsB,MAIrC;IACC,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG;IAC1C,MAAM,aAAa,SAAS,aAAa;IACzC,IAAI,YAAY;QACd,OAAO,eAAe,CAAC,SAAS,IAAI,eAAe,CAAC,SAAS;IAC/D;IACA,OAAO,eAAe,CAAC,SAAS;AAClC"}},
    {"offset": {"line": 405, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/standings.ts"],"sourcesContent":["import seedrandom from \"seedrandom\";\nimport { TournamentMatchStatus } from \"@prisma/client\";\n\nexport type TieBreakRule = \"WINS\" | \"SET_DIFF\" | \"GAME_DIFF\" | \"HEAD_TO_HEAD\" | \"RANDOM\";\n\nexport type MatchResult = {\n  pairing1Id: number;\n  pairing2Id: number;\n  status: TournamentMatchStatus;\n  score?: { sets?: Array<{ a: number; b: number }>; games?: Array<{ a: number; b: number }> };\n};\n\nexport type Standing = {\n  pairingId: number;\n  wins: number;\n  losses: number;\n  setDiff: number;\n  gameDiff: number;\n  headToHead: Record<number, number>; // pairingId -> wins against\n};\n\nexport function computeGroupStandings(\n  pairings: number[],\n  matches: MatchResult[],\n  rules: TieBreakRule[],\n  seed?: string,\n): Standing[] {\n  const rng = seedrandom(seed || `${Date.now()}`);\n  const map = new Map<number, Standing>();\n  pairings.forEach((p) =>\n    map.set(p, { pairingId: p, wins: 0, losses: 0, setDiff: 0, gameDiff: 0, headToHead: {} }),\n  );\n\n  const finished = matches.filter((m) => m.status === \"DONE\");\n  for (const m of finished) {\n    const s1 = map.get(m.pairing1Id);\n    const s2 = map.get(m.pairing2Id);\n    if (!s1 || !s2) continue;\n    const sets = m.score?.sets ?? [];\n    let aSets = 0;\n    let bSets = 0;\n    let aGames = 0;\n    let bGames = 0;\n    for (const set of sets) {\n      aSets += set.a;\n      bSets += set.b;\n      aGames += set.a;\n      bGames += set.b;\n    }\n    if (aSets > bSets) {\n      s1.wins += 1;\n      s2.losses += 1;\n      s1.headToHead[m.pairing2Id] = (s1.headToHead[m.pairing2Id] ?? 0) + 1;\n    } else if (bSets > aSets) {\n      s2.wins += 1;\n      s1.losses += 1;\n      s2.headToHead[m.pairing1Id] = (s2.headToHead[m.pairing1Id] ?? 0) + 1;\n    }\n    s1.setDiff += aSets - bSets;\n    s2.setDiff += bSets - aSets;\n    s1.gameDiff += aGames - bGames;\n    s2.gameDiff += bGames - aGames;\n  }\n\n  const standings = Array.from(map.values());\n\n  const comparator = (a: Standing, b: Standing) => {\n    for (const rule of rules) {\n      if (rule === \"WINS\") {\n        if (a.wins !== b.wins) return b.wins - a.wins;\n      } else if (rule === \"SET_DIFF\") {\n        if (a.setDiff !== b.setDiff) return b.setDiff - a.setDiff;\n      } else if (rule === \"GAME_DIFF\") {\n        if (a.gameDiff !== b.gameDiff) return b.gameDiff - a.gameDiff;\n      } else if (rule === \"HEAD_TO_HEAD\") {\n        const aHH = a.headToHead[b.pairingId] ?? 0;\n        const bHH = b.headToHead[a.pairingId] ?? 0;\n        if (aHH !== bHH) return bHH - aHH;\n      } else if (rule === \"RANDOM\") {\n        const r = rng() - 0.5;\n        if (r !== 0) return r > 0 ? 1 : -1;\n      }\n    }\n    return 0;\n  };\n\n  return standings.sort(comparator);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAqBO,SAAS,sBACd,QAAkB,EAClB,OAAsB,EACtB,KAAqB,EACrB,IAAa;IAEb,MAAM,MAAM,IAAA,gJAAU,EAAC,QAAQ,GAAG,KAAK,GAAG,IAAI;IAC9C,MAAM,MAAM,IAAI;IAChB,SAAS,OAAO,CAAC,CAAC,IAChB,IAAI,GAAG,CAAC,GAAG;YAAE,WAAW;YAAG,MAAM;YAAG,QAAQ;YAAG,SAAS;YAAG,UAAU;YAAG,YAAY,CAAC;QAAE;IAGzF,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;IACpD,KAAK,MAAM,KAAK,SAAU;QACxB,MAAM,KAAK,IAAI,GAAG,CAAC,EAAE,UAAU;QAC/B,MAAM,KAAK,IAAI,GAAG,CAAC,EAAE,UAAU;QAC/B,IAAI,CAAC,MAAM,CAAC,IAAI;QAChB,MAAM,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE;QAChC,IAAI,QAAQ;QACZ,IAAI,QAAQ;QACZ,IAAI,SAAS;QACb,IAAI,SAAS;QACb,KAAK,MAAM,OAAO,KAAM;YACtB,SAAS,IAAI,CAAC;YACd,SAAS,IAAI,CAAC;YACd,UAAU,IAAI,CAAC;YACf,UAAU,IAAI,CAAC;QACjB;QACA,IAAI,QAAQ,OAAO;YACjB,GAAG,IAAI,IAAI;YACX,GAAG,MAAM,IAAI;YACb,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI;QACrE,OAAO,IAAI,QAAQ,OAAO;YACxB,GAAG,IAAI,IAAI;YACX,GAAG,MAAM,IAAI;YACb,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI;QACrE;QACA,GAAG,OAAO,IAAI,QAAQ;QACtB,GAAG,OAAO,IAAI,QAAQ;QACtB,GAAG,QAAQ,IAAI,SAAS;QACxB,GAAG,QAAQ,IAAI,SAAS;IAC1B;IAEA,MAAM,YAAY,MAAM,IAAI,CAAC,IAAI,MAAM;IAEvC,MAAM,aAAa,CAAC,GAAa;QAC/B,KAAK,MAAM,QAAQ,MAAO;YACxB,IAAI,SAAS,QAAQ;gBACnB,IAAI,EAAE,IAAI,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,IAAI;YAC/C,OAAO,IAAI,SAAS,YAAY;gBAC9B,IAAI,EAAE,OAAO,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,OAAO;YAC3D,OAAO,IAAI,SAAS,aAAa;gBAC/B,IAAI,EAAE,QAAQ,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,GAAG,EAAE,QAAQ;YAC/D,OAAO,IAAI,SAAS,gBAAgB;gBAClC,MAAM,MAAM,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC,IAAI;gBACzC,MAAM,MAAM,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC,IAAI;gBACzC,IAAI,QAAQ,KAAK,OAAO,MAAM;YAChC,OAAO,IAAI,SAAS,UAAU;gBAC5B,MAAM,IAAI,QAAQ;gBAClB,IAAI,MAAM,GAAG,OAAO,IAAI,IAAI,IAAI,CAAC;YACnC;QACF;QACA,OAAO;IACT;IAEA,OAAO,UAAU,IAAI,CAAC;AACxB"}},
    {"offset": {"line": 478, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/structure.ts"],"sourcesContent":["import { TournamentMatchStatus } from \"@prisma/client\";\nimport { computeGroupStandings, TieBreakRule } from \"@/domain/tournaments/standings\";\n\nexport function summarizeMatchStatus(status: TournamentMatchStatus) {\n  if (status === \"IN_PROGRESS\") return \"Em jogo\";\n  if (status === \"DONE\") return \"Terminado\";\n  if (status === \"DISPUTED\") return \"Em disputa\";\n  if (status === \"SCHEDULED\") return \"Agendado\";\n  if (status === \"CANCELLED\") return \"Cancelado\";\n  return \"Pendente\";\n}\n\nexport function computeStandingsForGroup(\n  matches: { pairing1Id: number | null; pairing2Id: number | null; status: TournamentMatchStatus; score: unknown }[],\n  rules: TieBreakRule[],\n  seed?: string,\n) {\n  const pairings = Array.from(\n    new Set(\n      matches\n        .flatMap((m) => [m.pairing1Id, m.pairing2Id])\n        .filter((v): v is number => typeof v === \"number\"),\n    ),\n  );\n  if (pairings.length === 0) return [];\n  return computeGroupStandings(\n    pairings,\n    matches\n      .filter((m) => m.pairing1Id && m.pairing2Id)\n      .map((m) => ({\n        pairing1Id: m.pairing1Id as number,\n        pairing2Id: m.pairing2Id as number,\n        status: m.status,\n        score: m.score as unknown,\n      })),\n    rules,\n    seed,\n  );\n}\n"],"names":[],"mappings":";;;;;;AACA;;AAEO,SAAS,qBAAqB,MAA6B;IAChE,IAAI,WAAW,eAAe,OAAO;IACrC,IAAI,WAAW,QAAQ,OAAO;IAC9B,IAAI,WAAW,YAAY,OAAO;IAClC,IAAI,WAAW,aAAa,OAAO;IACnC,IAAI,WAAW,aAAa,OAAO;IACnC,OAAO;AACT;AAEO,SAAS,yBACd,OAAkH,EAClH,KAAqB,EACrB,IAAa;IAEb,MAAM,WAAW,MAAM,IAAI,CACzB,IAAI,IACF,QACG,OAAO,CAAC,CAAC,IAAM;YAAC,EAAE,UAAU;YAAE,EAAE,UAAU;SAAC,EAC3C,MAAM,CAAC,CAAC,IAAmB,OAAO,MAAM;IAG/C,IAAI,SAAS,MAAM,KAAK,GAAG,OAAO,EAAE;IACpC,OAAO,IAAA,6JAAqB,EAC1B,UACA,QACG,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,IAAI,EAAE,UAAU,EAC1C,GAAG,CAAC,CAAC,IAAM,CAAC;YACX,YAAY,EAAE,UAAU;YACxB,YAAY,EAAE,UAAU;YACxB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,KAAK;QAChB,CAAC,IACH,OACA;AAEJ"}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/structureData.ts"],"sourcesContent":["import \"server-only\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function getTournamentStructure(tournamentId: number) {\n  return prisma.tournament.findUnique({\n    where: { id: tournamentId },\n    include: {\n      stages: {\n        orderBy: { order: \"asc\" },\n        include: {\n          groups: { orderBy: { order: \"asc\" }, include: { matches: true } },\n          matches: true,\n        },\n      },\n      event: { select: { id: true, title: true, slug: true, startsAt: true, isFree: true } },\n    },\n  });\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAEO,eAAe,uBAAuB,YAAoB;IAC/D,OAAO,yHAAM,CAAC,UAAU,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE,IAAI;QAAa;QAC1B,SAAS;YACP,QAAQ;gBACN,SAAS;oBAAE,OAAO;gBAAM;gBACxB,SAAS;oBACP,QAAQ;wBAAE,SAAS;4BAAE,OAAO;wBAAM;wBAAG,SAAS;4BAAE,SAAS;wBAAK;oBAAE;oBAChE,SAAS;gBACX;YACF;YACA,OAAO;gBAAE,QAAQ;oBAAE,IAAI;oBAAM,OAAO;oBAAM,MAAM;oBAAM,UAAU;oBAAM,QAAQ;gBAAK;YAAE;QACvF;IACF;AACF"}},
    {"offset": {"line": 564, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/matchRules.ts"],"sourcesContent":["import { TournamentMatchStatus } from \"@prisma/client\";\n\nexport type SetScore = { a: number; b: number };\nexport type ScorePayload = { sets: SetScore[] };\nexport type GoalScorePayload = { a: number; b: number; limit?: number };\nexport type MatchScorePayload = { sets?: SetScore[]; goals?: GoalScorePayload };\n\nexport type ValidationResult =\n  | { ok: true; winner: \"A\" | \"B\"; normalized: ScorePayload }\n  | { ok: false; code: string; message: string };\n\nexport type GoalValidationResult =\n  | { ok: true; winner: \"A\" | \"B\" | null; status: TournamentMatchStatus; normalized: GoalScorePayload }\n  | { ok: false; code: string; message: string };\n\nconst WIN_BY = 2;\nconst MAX_SETS = 3; // BO3\nconst MIN_GAMES_TO_WIN = 6;\nconst TIEBREAK_GAMES = 7;\n\nfunction isValidSet(set: SetScore) {\n  const a = Number(set.a);\n  const b = Number(set.b);\n  if (!Number.isFinite(a) || !Number.isFinite(b) || a < 0 || b < 0) return false;\n  const max = Math.max(a, b);\n  const diff = Math.abs(a - b);\n  // tiebreak 7-6 é aceite\n  if (max === TIEBREAK_GAMES && diff === 1) return true;\n  if (max >= MIN_GAMES_TO_WIN) return diff >= WIN_BY;\n  return false;\n}\n\nexport function validateScore(score: ScorePayload): ValidationResult {\n  if (!score || !Array.isArray(score.sets) || score.sets.length === 0) {\n    return { ok: false, code: \"INVALID_SCORE\", message: \"Score vazio ou inválido.\" };\n  }\n  if (score.sets.length > MAX_SETS) {\n    return { ok: false, code: \"TOO_MANY_SETS\", message: \"Máximo de 3 sets (BO3).\" };\n  }\n\n  let winsA = 0;\n  let winsB = 0;\n  for (const s of score.sets) {\n    if (!isValidSet(s)) return { ok: false, code: \"INVALID_SET\", message: \"Set inválido.\" };\n    if (s.a > s.b) winsA += 1;\n    else winsB += 1;\n  }\n\n  if (winsA === winsB) return { ok: false, code: \"NO_WINNER\", message: \"Empate não permitido no BO3.\" };\n  if (winsA > MAX_SETS || winsB > MAX_SETS) {\n    return { ok: false, code: \"TOO_MANY_WINS\", message: \"Vitórias a mais para BO3.\" };\n  }\n  if (winsA > winsB && winsA > MAX_SETS - 1) {\n    return { ok: true, winner: \"A\", normalized: score };\n  }\n  if (winsB > winsA && winsB > MAX_SETS - 1) {\n    return { ok: true, winner: \"B\", normalized: score };\n  }\n  return { ok: false, code: \"NO_WINNER\", message: \"Score não determina vencedor.\" };\n}\n\nexport function validateGoalScore(score: GoalScorePayload): GoalValidationResult {\n  const a = Number(score?.a);\n  const b = Number(score?.b);\n  const limit = Number(score?.limit);\n  if (!Number.isFinite(a) || !Number.isFinite(b) || a < 0 || b < 0) {\n    return { ok: false, code: \"INVALID_SCORE\", message: \"Score inválido.\" };\n  }\n  if (!Number.isFinite(limit) || limit <= 0) {\n    return { ok: false, code: \"INVALID_LIMIT\", message: \"Limite de golos inválido.\" };\n  }\n  if (a > limit || b > limit) {\n    return { ok: false, code: \"LIMIT_EXCEEDED\", message: \"Score ultrapassa o limite.\" };\n  }\n  if (a === limit && b === limit) {\n    return { ok: false, code: \"TIE_NOT_ALLOWED\", message: \"Empate não permitido.\" };\n  }\n  if (a === limit) {\n    return { ok: true, winner: \"A\", status: TournamentMatchStatus.DONE, normalized: { a, b, limit } };\n  }\n  if (b === limit) {\n    return { ok: true, winner: \"B\", status: TournamentMatchStatus.DONE, normalized: { a, b, limit } };\n  }\n  if (a > 0 || b > 0) {\n    return { ok: true, winner: null, status: TournamentMatchStatus.IN_PROGRESS, normalized: { a, b, limit } };\n  }\n  return { ok: true, winner: null, status: TournamentMatchStatus.PENDING, normalized: { a, b, limit } };\n}\n\nexport function getWinnerSideFromScore(score?: MatchScorePayload | null) {\n  if (!score) return null;\n  if (score.goals) {\n    const res = validateGoalScore(score.goals);\n    return res.ok ? res.winner : null;\n  }\n  if (Array.isArray(score.sets) && score.sets.length > 0) {\n    const res = validateScore({ sets: score.sets });\n    return res.ok ? res.winner : null;\n  }\n  return null;\n}\n\nexport function canEditMatch(status: TournamentMatchStatus, force?: boolean) {\n  if (force) return true;\n  // não permite editar DONE se não for force\n  return status !== \"DONE\" && status !== \"DISPUTED\";\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 753, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerAccess.ts"],"sourcesContent":["import { OrganizerMemberRole, StaffRole, StaffScope, StaffStatus } from \"@prisma/client\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function getOrganizerRole(userId: string, organizerId: number) {\n  if (!userId || !organizerId) return null;\n  const membership = await prisma.organizerMember.findUnique({\n    where: { organizerId_userId: { organizerId, userId } },\n    select: { role: true },\n  });\n  return membership?.role ?? null;\n}\n\nexport async function canManageMembersDb(userId: string, organizerId: number) {\n  const role = await getOrganizerRole(userId, organizerId);\n  return role === OrganizerMemberRole.OWNER || role === OrganizerMemberRole.CO_OWNER || role === OrganizerMemberRole.ADMIN;\n}\n\nexport async function canManageEventsDb(userId: string, organizerId: number) {\n  const role = await getOrganizerRole(userId, organizerId);\n  return role === OrganizerMemberRole.OWNER || role === OrganizerMemberRole.CO_OWNER || role === OrganizerMemberRole.ADMIN;\n}\n\nexport async function canScanTickets(userId: string, eventId: number) {\n  const event = await prisma.event.findUnique({\n    where: { id: eventId },\n    select: { organizerId: true },\n  });\n  if (!event || !event.organizerId) {\n    return { allowed: false, reason: \"EVENT_NOT_FOUND\", membershipRole: null as OrganizerMemberRole | null };\n  }\n\n  const membership = await prisma.organizerMember.findUnique({\n    where: { organizerId_userId: { organizerId: event.organizerId, userId } },\n    select: { role: true },\n  });\n\n  const managerRoles: OrganizerMemberRole[] = [\n    OrganizerMemberRole.OWNER,\n    OrganizerMemberRole.CO_OWNER,\n    OrganizerMemberRole.ADMIN,\n  ];\n  if (membership && managerRoles.includes(membership.role)) {\n    return { allowed: true, membershipRole: membership.role, staffAssignmentId: null as number | null };\n  }\n\n  const staffAssignment = await prisma.staffAssignment.findFirst({\n    where: {\n      userId,\n      status: StaffStatus.ACCEPTED,\n      revokedAt: null,\n      role: { in: [StaffRole.OWNER, StaffRole.ADMIN, StaffRole.CHECKIN] },\n      OR: [\n        { scope: StaffScope.EVENT, eventId },\n        { scope: StaffScope.GLOBAL, organizerId: event.organizerId },\n      ],\n    },\n    select: { id: true, role: true },\n  });\n\n  if (staffAssignment) {\n    return { allowed: true, membershipRole: membership?.role ?? null, staffAssignmentId: staffAssignment.id };\n  }\n\n  return { allowed: false, membershipRole: membership?.role ?? null, staffAssignmentId: null as number | null, reason: \"NO_PERMISSION\" };\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;;;;;AAEO,eAAe,iBAAiB,MAAc,EAAE,WAAmB;IACxE,IAAI,CAAC,UAAU,CAAC,aAAa,OAAO;IACpC,MAAM,aAAa,MAAM,yHAAM,CAAC,eAAe,CAAC,UAAU,CAAC;QACzD,OAAO;YAAE,oBAAoB;gBAAE;gBAAa;YAAO;QAAE;QACrD,QAAQ;YAAE,MAAM;QAAK;IACvB;IACA,OAAO,YAAY,QAAQ;AAC7B;AAEO,eAAe,mBAAmB,MAAc,EAAE,WAAmB;IAC1E,MAAM,OAAO,MAAM,iBAAiB,QAAQ;IAC5C,OAAO,SAAS,oJAAmB,CAAC,KAAK,IAAI,SAAS,oJAAmB,CAAC,QAAQ,IAAI,SAAS,oJAAmB,CAAC,KAAK;AAC1H;AAEO,eAAe,kBAAkB,MAAc,EAAE,WAAmB;IACzE,MAAM,OAAO,MAAM,iBAAiB,QAAQ;IAC5C,OAAO,SAAS,oJAAmB,CAAC,KAAK,IAAI,SAAS,oJAAmB,CAAC,QAAQ,IAAI,SAAS,oJAAmB,CAAC,KAAK;AAC1H;AAEO,eAAe,eAAe,MAAc,EAAE,OAAe;IAClE,MAAM,QAAQ,MAAM,yHAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAQ;QACrB,QAAQ;YAAE,aAAa;QAAK;IAC9B;IACA,IAAI,CAAC,SAAS,CAAC,MAAM,WAAW,EAAE;QAChC,OAAO;YAAE,SAAS;YAAO,QAAQ;YAAmB,gBAAgB;QAAmC;IACzG;IAEA,MAAM,aAAa,MAAM,yHAAM,CAAC,eAAe,CAAC,UAAU,CAAC;QACzD,OAAO;YAAE,oBAAoB;gBAAE,aAAa,MAAM,WAAW;gBAAE;YAAO;QAAE;QACxE,QAAQ;YAAE,MAAM;QAAK;IACvB;IAEA,MAAM,eAAsC;QAC1C,oJAAmB,CAAC,KAAK;QACzB,oJAAmB,CAAC,QAAQ;QAC5B,oJAAmB,CAAC,KAAK;KAC1B;IACD,IAAI,cAAc,aAAa,QAAQ,CAAC,WAAW,IAAI,GAAG;QACxD,OAAO;YAAE,SAAS;YAAM,gBAAgB,WAAW,IAAI;YAAE,mBAAmB;QAAsB;IACpG;IAEA,MAAM,kBAAkB,MAAM,yHAAM,CAAC,eAAe,CAAC,SAAS,CAAC;QAC7D,OAAO;YACL;YACA,QAAQ,4IAAW,CAAC,QAAQ;YAC5B,WAAW;YACX,MAAM;gBAAE,IAAI;oBAAC,0IAAS,CAAC,KAAK;oBAAE,0IAAS,CAAC,KAAK;oBAAE,0IAAS,CAAC,OAAO;iBAAC;YAAC;YAClE,IAAI;gBACF;oBAAE,OAAO,2IAAU,CAAC,KAAK;oBAAE;gBAAQ;gBACnC;oBAAE,OAAO,2IAAU,CAAC,MAAM;oBAAE,aAAa,MAAM,WAAW;gBAAC;aAC5D;QACH;QACA,QAAQ;YAAE,IAAI;YAAM,MAAM;QAAK;IACjC;IAEA,IAAI,iBAAiB;QACnB,OAAO;YAAE,SAAS;YAAM,gBAAgB,YAAY,QAAQ;YAAM,mBAAmB,gBAAgB,EAAE;QAAC;IAC1G;IAEA,OAAO;QAAE,SAAS;QAAO,gBAAgB,YAAY,QAAQ;QAAM,mBAAmB;QAAuB,QAAQ;IAAgB;AACvI"}},
    {"offset": {"line": 880, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/utils/email.ts"],"sourcesContent":["export function normalizeEmail(email?: string | null) {\n  if (!email) return null;\n  const trimmed = email.trim().toLowerCase();\n  return trimmed || null;\n}\n"],"names":[],"mappings":";;;;AAAO,SAAS,eAAe,KAAqB;IAClD,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,UAAU,MAAM,IAAI,GAAG,WAAW;IACxC,OAAO,WAAW;AACpB"}},
    {"offset": {"line": 893, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/username.ts"],"sourcesContent":["const USERNAME_REGEX = /^[a-z0-9](?:[a-z0-9._]*[a-z0-9])?$/;\n\nexport type UsernameValidation =\n  | { valid: true; normalized: string }\n  | { valid: false; error: string };\n\n/**\n * Remove acentos, espaços e caracteres inválidos, deixando apenas letras, números, _ e . (lowercase).\n * Limita a 30 chars e evita que termine/comece em '.'.\n */\nexport function sanitizeUsername(input: string): string {\n  const base = (input ?? \"\")\n    .normalize(\"NFKD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\"); // remove diacríticos\n  const cleaned = base.replace(/[^A-Za-z0-9._]/g, \"\");\n  const trimmed = cleaned.replace(/^\\.+/, \"\").replace(/\\.+$/, \"\");\n  const collapsedDots = trimmed.replace(/\\.{2,}/g, \".\");\n  return collapsedDots.toLowerCase().slice(0, 30);\n}\n\nexport function validateUsername(raw: string): UsernameValidation {\n  const normalized = sanitizeUsername(raw);\n  if (!normalized || normalized.length < 3 || normalized.length > 30) {\n    return {\n      valid: false,\n      error: \"Escolhe um username entre 3 e 30 caracteres (letras, números, _ ou .).\",\n    };\n  }\n  if (!USERNAME_REGEX.test(normalized)) {\n    return {\n      valid: false,\n      error: \"O username só pode ter letras, números, _ e . (sem espaços ou acentos).\",\n    };\n  }\n  if (normalized.includes(\"..\")) {\n    return {\n      valid: false,\n      error: \"O username não pode ter '..' seguido.\",\n    };\n  }\n  return { valid: true, normalized };\n}\n\nexport const USERNAME_RULES_HINT =\n  \"3-30 caracteres, letras ou números, opcionalmente _ ou ., sem espaços ou acentos.\";\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,iBAAiB;AAUhB,SAAS,iBAAiB,KAAa;IAC5C,MAAM,OAAO,CAAC,SAAS,EAAE,EACtB,SAAS,CAAC,QACV,OAAO,CAAC,oBAAoB,KAAK,qBAAqB;IACzD,MAAM,UAAU,KAAK,OAAO,CAAC,mBAAmB;IAChD,MAAM,UAAU,QAAQ,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ;IAC5D,MAAM,gBAAgB,QAAQ,OAAO,CAAC,WAAW;IACjD,OAAO,cAAc,WAAW,GAAG,KAAK,CAAC,GAAG;AAC9C;AAEO,SAAS,iBAAiB,GAAW;IAC1C,MAAM,aAAa,iBAAiB;IACpC,IAAI,CAAC,cAAc,WAAW,MAAM,GAAG,KAAK,WAAW,MAAM,GAAG,IAAI;QAClE,OAAO;YACL,OAAO;YACP,OAAO;QACT;IACF;IACA,IAAI,CAAC,eAAe,IAAI,CAAC,aAAa;QACpC,OAAO;YACL,OAAO;YACP,OAAO;QACT;IACF;IACA,IAAI,WAAW,QAAQ,CAAC,OAAO;QAC7B,OAAO;YACL,OAAO;YACP,OAAO;QACT;IACF;IACA,OAAO;QAAE,OAAO;QAAM;IAAW;AACnC;AAEO,MAAM,sBACX"}},
    {"offset": {"line": 939, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerPremium.ts"],"sourcesContent":["import type { LiveHubModule } from \"@/lib/liveHubConfig\";\n\ntype OrganizerRef = {\n  id?: number | null;\n  username?: string | null;\n  // Gerido por subscrição (SaaS), não editar manualmente na UI.\n  liveHubPremiumEnabled?: boolean | null;\n};\n\ntype OrganizerPremiumModules = {\n  inscricoes?: boolean;\n  loja?: boolean;\n  galeria?: boolean;\n};\n\ntype LiveHubMatchOrder = \"ONEVONE\";\n\ntype OrganizerPremiumConfig = {\n  key: \"ONEVONE\";\n  organizerId: number;\n  username: string;\n  liveHubModules?: LiveHubModule[];\n  profileModules?: OrganizerPremiumModules;\n  liveHubMatchOrder?: LiveHubMatchOrder;\n};\n\nconst CUSTOM_PREMIUM_CONFIGS: OrganizerPremiumConfig[] = [\n  {\n    key: \"ONEVONE\",\n    organizerId: 23,\n    username: \"onevone\",\n    liveHubModules: [\"HERO\", \"VIDEO\", \"NOW_PLAYING\", \"NEXT_MATCHES\", \"RESULTS\", \"BRACKET\", \"SPONSORS\"],\n    profileModules: { inscricoes: true, loja: true, galeria: true },\n    liveHubMatchOrder: \"ONEVONE\",\n  },\n];\n\nconst normalizeUsername = (value?: string | null) => (typeof value === \"string\" ? value.trim().toLowerCase() : \"\");\n\nexport function getCustomPremiumConfig(organizer?: OrganizerRef | null) {\n  if (!organizer) return null;\n  const normalizedUsername = normalizeUsername(organizer.username);\n  return (\n    CUSTOM_PREMIUM_CONFIGS.find(\n      (config) =>\n        (config.organizerId && organizer.id === config.organizerId) ||\n        (normalizedUsername && config.username === normalizedUsername),\n    ) ?? null\n  );\n}\n\nexport function isCustomPremiumOrganizer(organizer?: OrganizerRef | null) {\n  return Boolean(getCustomPremiumConfig(organizer));\n}\n\nexport function isCustomPremiumActive(organizer?: OrganizerRef | null, premiumEnabled?: boolean | null) {\n  const config = getCustomPremiumConfig(organizer);\n  if (!config) return false;\n  const enabled = premiumEnabled ?? organizer?.liveHubPremiumEnabled ?? false;\n  return Boolean(enabled);\n}\n\nexport function getCustomPremiumKey(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.key ?? null;\n}\n\nexport function getCustomLiveHubModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubModules ?? null;\n}\n\nexport function getCustomPremiumProfileModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.profileModules ?? null;\n}\n\nexport function getCustomLiveHubMatchOrder(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubMatchOrder ?? null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AA0BA,MAAM,yBAAmD;IACvD;QACE,KAAK;QACL,aAAa;QACb,UAAU;QACV,gBAAgB;YAAC;YAAQ;YAAS;YAAe;YAAgB;YAAW;YAAW;SAAW;QAClG,gBAAgB;YAAE,YAAY;YAAM,MAAM;YAAM,SAAS;QAAK;QAC9D,mBAAmB;IACrB;CACD;AAED,MAAM,oBAAoB,CAAC,QAA2B,OAAO,UAAU,WAAW,MAAM,IAAI,GAAG,WAAW,KAAK;AAExG,SAAS,uBAAuB,SAA+B;IACpE,IAAI,CAAC,WAAW,OAAO;IACvB,MAAM,qBAAqB,kBAAkB,UAAU,QAAQ;IAC/D,OACE,uBAAuB,IAAI,CACzB,CAAC,SACC,AAAC,OAAO,WAAW,IAAI,UAAU,EAAE,KAAK,OAAO,WAAW,IACzD,sBAAsB,OAAO,QAAQ,KAAK,uBAC1C;AAET;AAEO,SAAS,yBAAyB,SAA+B;IACtE,OAAO,QAAQ,uBAAuB;AACxC;AAEO,SAAS,sBAAsB,SAA+B,EAAE,cAA+B;IACpG,MAAM,SAAS,uBAAuB;IACtC,IAAI,CAAC,QAAQ,OAAO;IACpB,MAAM,UAAU,kBAAkB,WAAW,yBAAyB;IACtE,OAAO,QAAQ;AACjB;AAEO,SAAS,oBAAoB,SAA+B;IACjE,OAAO,uBAAuB,YAAY,OAAO;AACnD;AAEO,SAAS,wBAAwB,SAA+B;IACrE,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,+BAA+B,SAA+B;IAC5E,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,2BAA2B,SAA+B;IACxE,OAAO,uBAAuB,YAAY,qBAAqB;AACjE"}},
    {"offset": {"line": 1010, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/api/livehub/%5Bslug%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { createSupabaseServer } from \"@/lib/supabaseServer\";\nimport { prisma } from \"@/lib/prisma\";\nimport { OrganizerMemberRole } from \"@prisma/client\";\nimport { DEFAULT_ORGANIZATION_CATEGORY } from \"@/lib/organizationCategories\";\nimport { resolveLiveHubModules } from \"@/lib/liveHubConfig\";\nimport { summarizeMatchStatus, computeStandingsForGroup } from \"@/domain/tournaments/structure\";\nimport { getTournamentStructure } from \"@/domain/tournaments/structureData\";\nimport { getWinnerSideFromScore, type MatchScorePayload } from \"@/domain/tournaments/matchRules\";\nimport { canScanTickets } from \"@/lib/organizerAccess\";\nimport { normalizeEmail } from \"@/lib/utils/email\";\nimport { sanitizeUsername } from \"@/lib/username\";\nimport { getCustomLiveHubModules, isCustomPremiumActive } from \"@/lib/organizerPremium\";\n\nfunction slugify(input: string): string {\n  return input\n    .toLowerCase()\n    .normalize(\"NFD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/^-+|-+$/g, \"\");\n}\n\nfunction pickDisplayName(profile: { fullName: string | null; username: string | null } | null) {\n  return profile?.fullName || (profile?.username ? `@${profile.username}` : null);\n}\n\nexport async function GET(_req: NextRequest, { params }: { params: Promise<{ slug: string }> }) {\n  const resolved = await params;\n  const slug = resolved?.slug;\n  if (!slug) return NextResponse.json({ ok: false, error: \"INVALID_SLUG\" }, { status: 400 });\n\n  try {\n    let event = await prisma.event.findUnique({\n      where: { slug },\n      select: {\n        id: true,\n        slug: true,\n        title: true,\n        description: true,\n        templateType: true,\n        startsAt: true,\n        endsAt: true,\n        status: true,\n        locationName: true,\n        locationCity: true,\n        coverImageUrl: true,\n        organizerId: true,\n        liveHubVisibility: true,\n        liveStreamUrl: true,\n        timezone: true,\n        inviteOnly: true,\n        publicAccessMode: true,\n        participantAccessMode: true,\n        publicTicketTypeIds: true,\n        participantTicketTypeIds: true,\n        organizer: {\n          select: {\n            id: true,\n            publicName: true,\n            username: true,\n            organizationCategory: true,\n            brandingAvatarUrl: true,\n            liveHubPremiumEnabled: true,\n          },\n        },\n        tournament: {\n          select: {\n            id: true,\n            format: true,\n            generationSeed: true,\n            tieBreakRules: true,\n          },\n        },\n      },\n    });\n\n    if (!event) {\n      const normalized = slugify(slug);\n      if (normalized && normalized !== slug) {\n        event = await prisma.event.findUnique({\n          where: { slug: normalized },\n          select: {\n            id: true,\n            slug: true,\n            title: true,\n            description: true,\n            templateType: true,\n            startsAt: true,\n            endsAt: true,\n            status: true,\n            locationName: true,\n            locationCity: true,\n            coverImageUrl: true,\n            organizerId: true,\n            liveHubVisibility: true,\n            liveStreamUrl: true,\n            timezone: true,\n            inviteOnly: true,\n            publicAccessMode: true,\n            participantAccessMode: true,\n            publicTicketTypeIds: true,\n            participantTicketTypeIds: true,\n            organizer: {\n              select: {\n                id: true,\n                publicName: true,\n                username: true,\n                organizationCategory: true,\n                brandingAvatarUrl: true,\n                liveHubPremiumEnabled: true,\n              },\n            },\n            tournament: {\n              select: {\n                id: true,\n                format: true,\n                generationSeed: true,\n                tieBreakRules: true,\n              },\n            },\n          },\n        });\n      }\n    }\n    if (!event) return NextResponse.json({ ok: false, error: \"NOT_FOUND\" }, { status: 404 });\n\n  const supabase = await createSupabaseServer();\n  const { data: authData } = await supabase.auth.getUser();\n  const userId = authData?.user?.id ?? null;\n\n  const tickets = userId\n    ? await prisma.ticket.findMany({\n        where: {\n          eventId: event.id,\n          status: \"ACTIVE\",\n          OR: [{ userId }, { ownerUserId: userId }],\n        },\n        select: { id: true, ticketTypeId: true, tournamentEntryId: true },\n      })\n    : [];\n\n  let isOrganizer = false;\n  let organizerRole: OrganizerMemberRole | null = null;\n  let canEditMatches = false;\n  if (userId && event.organizerId) {\n    const access = await canScanTickets(userId, event.id);\n    organizerRole = access.membershipRole ?? null;\n    const hasMembership = Boolean(organizerRole);\n    isOrganizer = access.allowed || hasMembership;\n    canEditMatches = organizerRole ? organizerRole !== OrganizerMemberRole.VIEWER : false;\n  }\n\n  const profile = userId\n    ? await prisma.profile.findUnique({\n        where: { id: userId },\n        select: { username: true },\n      })\n    : null;\n  const userEmailNormalized = authData?.user?.email ? normalizeEmail(authData.user.email) : null;\n  const usernameNormalized = profile?.username ? sanitizeUsername(profile.username) : null;\n  const inviteIdentifiers = [userEmailNormalized, usernameNormalized].filter(Boolean) as string[];\n  const inviteWhere = {\n    eventId: event.id,\n    OR: [\n      userId ? { targetUserId: userId } : undefined,\n      inviteIdentifiers.length > 0 ? { targetIdentifier: { in: inviteIdentifiers } } : undefined,\n    ].filter(Boolean) as Array<Record<string, unknown>>,\n  };\n  const [publicInviteMatch, participantInviteMatch] =\n    userId || inviteIdentifiers.length > 0\n      ? await Promise.all([\n          prisma.eventInvite.findFirst({\n            where: { ...inviteWhere, scope: \"PUBLIC\" },\n            select: { id: true },\n          }),\n          prisma.eventInvite.findFirst({\n            where: { ...inviteWhere, scope: \"PARTICIPANT\" },\n            select: { id: true },\n          }),\n        ])\n      : [null, null];\n  const isParticipantInvited = Boolean(participantInviteMatch);\n\n  const publicAccessMode = event.publicAccessMode ?? (event.inviteOnly ? \"INVITE\" : \"OPEN\");\n  const participantAccessMode = event.participantAccessMode ?? \"NONE\";\n  const publicTicketTypeIds = event.publicTicketTypeIds ?? [];\n  const participantTicketTypeIds = event.participantTicketTypeIds ?? [];\n  const hasAnyTicket = tickets.length > 0;\n  const ticketMatches = (ids: number[]) =>\n    ids.length === 0 ? hasAnyTicket : tickets.some((t) => ids.includes(t.ticketTypeId));\n\n  const hasInscription =\n    Boolean(\n      userId &&\n        (await prisma.tournamentEntry.findFirst({ where: { eventId: event.id, userId }, select: { id: true } })),\n    ) || tickets.some((t) => Boolean(t.tournamentEntryId));\n\n  const isParticipant =\n    participantAccessMode === \"NONE\"\n      ? false\n      : participantAccessMode === \"TICKET\"\n        ? ticketMatches(participantTicketTypeIds)\n        : participantAccessMode === \"INSCRIPTION\"\n          ? hasInscription\n          : participantAccessMode === \"INVITE\"\n            ? isParticipantInvited\n            : false;\n\n  const viewerRole = isOrganizer ? \"ORGANIZER\" : isParticipant ? \"PARTICIPANT\" : \"PUBLIC\";\n  const liveHubVisibility = event.liveHubVisibility ?? \"PUBLIC\";\n  const liveHubAllowed =\n    liveHubVisibility === \"PUBLIC\"\n      ? true\n      : liveHubVisibility === \"PRIVATE\"\n        ? isOrganizer || isParticipant\n        : false;\n\n  const category = event.organizer?.organizationCategory ?? DEFAULT_ORGANIZATION_CATEGORY;\n  const premiumActive = isCustomPremiumActive(event.organizer);\n  const liveHubMode = premiumActive ? \"PREMIUM\" : \"DEFAULT\";\n  const modules = resolveLiveHubModules({ category, mode: liveHubMode, premiumActive });\n  const customModules = getCustomLiveHubModules(event.organizer);\n  const liveHubModules = premiumActive && customModules?.length ? customModules : modules;\n\n  let tournamentPayload: any = null;\n  let pairings: Record<\n    number,\n    {\n      id: number;\n      label: string;\n      subLabel?: string | null;\n      avatarUrl?: string | null;\n      profileUsername?: string | null;\n      href?: string | null;\n    }\n  > = {};\n\n  if (event.tournament) {\n    const structure = await getTournamentStructure(event.tournament.id);\n    const configRes = await prisma.tournament.findUnique({\n      where: { id: event.tournament.id },\n      select: { config: true },\n    });\n    const config = (configRes?.config as Record<string, unknown> | null) ?? {};\n    const manualParticipants = Array.isArray(config.manualParticipants)\n      ? (config.manualParticipants as Array<Record<string, unknown>>)\n      : [];\n    const liveSponsors = (config.liveSponsors as Record<string, unknown> | null) ?? null;\n    const featuredMatchId =\n      typeof (config as Record<string, unknown>).featuredMatchId === \"number\"\n        ? (config as Record<string, unknown>).featuredMatchId\n        : null;\n    if (structure) {\n      const tieBreakRules = Array.isArray(structure.tieBreakRules)\n        ? (structure.tieBreakRules as string[])\n        : [\"WINS\", \"SET_DIFF\", \"GAME_DIFF\", \"HEAD_TO_HEAD\", \"RANDOM\"];\n\n      const buildMatch = (m: any) => ({\n        id: m.id,\n        stageId: m.stageId,\n        groupId: m.groupId,\n        pairing1Id: m.pairing1Id,\n        pairing2Id: m.pairing2Id,\n        courtId: m.courtId,\n        round: m.round,\n        roundLabel: m.roundLabel,\n        startAt: m.startAt,\n        status: m.status,\n        statusLabel: summarizeMatchStatus(m.status),\n        score: m.score,\n        updatedAt: m.updatedAt,\n      });\n\n      const stages = structure.stages.map((s) => ({\n        id: s.id,\n        name: s.name,\n        stageType: s.stageType,\n        order: s.order,\n        groups: s.groups.map((g) => ({\n          id: g.id,\n          name: g.name,\n          standings: computeStandingsForGroup(g.matches, tieBreakRules, structure.generationSeed || undefined),\n          matches: g.matches.map(buildMatch),\n        })),\n        matches: s.matches.filter((m) => !m.groupId).map(buildMatch),\n      }));\n\n      const flatMatches = stages.flatMap((s) => [...s.matches, ...s.groups.flatMap((g) => g.matches)]);\n\n      let userPairingId: number | null = null;\n      if (userId) {\n        const pairing = await prisma.padelPairing.findFirst({\n          where: { eventId: event.id, OR: [{ player1UserId: userId }, { player2UserId: userId }] },\n          select: { id: true },\n        });\n        if (pairing?.id) {\n          userPairingId = pairing.id;\n        } else {\n          const ticketEntryId = tickets.find((t) => Boolean(t.tournamentEntryId))?.tournamentEntryId ?? null;\n          if (ticketEntryId) {\n            userPairingId = ticketEntryId;\n          } else {\n            const entry = await prisma.tournamentEntry.findFirst({\n              where: { eventId: event.id, userId },\n              select: { id: true },\n            });\n            userPairingId = entry?.id ?? null;\n          }\n        }\n      }\n\n      const nextMatch =\n        userPairingId !== null\n          ? flatMatches\n              .filter((m) => (m.pairing1Id === userPairingId || m.pairing2Id === userPairingId) && m.status !== \"DONE\")\n              .sort((a, b) =>\n                a.startAt && b.startAt ? new Date(a.startAt).getTime() - new Date(b.startAt).getTime() : 0,\n              )[0] ?? null\n          : null;\n\n      const lastMatch =\n        userPairingId !== null\n          ? flatMatches\n              .filter((m) => (m.pairing1Id === userPairingId || m.pairing2Id === userPairingId) && m.status === \"DONE\")\n              .sort((a, b) =>\n                a.startAt && b.startAt ? new Date(b.startAt).getTime() - new Date(a.startAt).getTime() : 0,\n              )[0] ?? null\n          : null;\n\n      const pairingIds = new Set<number>();\n      for (const match of flatMatches) {\n        if (typeof match.pairing1Id === \"number\") pairingIds.add(match.pairing1Id);\n        if (typeof match.pairing2Id === \"number\") pairingIds.add(match.pairing2Id);\n      }\n\n      const pairingIdsList = Array.from(pairingIds);\n      if (pairingIdsList.length > 0) {\n        const padelPairings = await prisma.padelPairing.findMany({\n          where: { id: { in: pairingIdsList } },\n          select: {\n            id: true,\n            player1: { select: { fullName: true, username: true, avatarUrl: true } },\n            player2: { select: { fullName: true, username: true, avatarUrl: true } },\n          },\n        });\n\n        for (const pairing of padelPairings) {\n          const p1 = pickDisplayName(pairing.player1);\n          const p2 = pickDisplayName(pairing.player2);\n          const label = p1 && p2 ? `${p1} & ${p2}` : `Dupla #${pairing.id}`;\n          const subLabel = p1 && p2 ? \"Dupla\" : null;\n          pairings[pairing.id] = {\n            id: pairing.id,\n            label,\n            subLabel,\n            avatarUrl: pairing.player1?.avatarUrl || pairing.player2?.avatarUrl || null,\n          };\n        }\n\n        const tournamentEntries = await prisma.tournamentEntry.findMany({\n          where: { id: { in: pairingIdsList } },\n          select: {\n            id: true,\n            user: { select: { fullName: true, username: true, avatarUrl: true } },\n          },\n        });\n\n        for (const entry of tournamentEntries) {\n          if (pairings[entry.id]) continue;\n          const label = pickDisplayName(entry.user) || `Jogador #${entry.id}`;\n          const normalizedUsername = entry.user?.username ? sanitizeUsername(entry.user.username) : null;\n          const subLabel = normalizedUsername ? `@${normalizedUsername}` : null;\n          pairings[entry.id] = {\n            id: entry.id,\n            label,\n            subLabel,\n            avatarUrl: entry.user?.avatarUrl || null,\n            profileUsername: normalizedUsername,\n            href: normalizedUsername ? `/${normalizedUsername}` : null,\n          };\n        }\n\n        for (const raw of manualParticipants) {\n          const id = Number.isFinite(raw.id) ? Number(raw.id) : null;\n          if (!id || pairings[id] || !pairingIdsList.includes(id)) continue;\n          const name = typeof raw.name === \"string\" ? raw.name.trim() : \"\";\n          if (!name) continue;\n          const username = typeof raw.username === \"string\" ? sanitizeUsername(raw.username) : null;\n          const subLabel = username ? `@${username}` : null;\n          const avatarUrl = typeof raw.avatarUrl === \"string\" ? raw.avatarUrl : null;\n          pairings[id] = {\n            id,\n            label: name,\n            subLabel,\n            avatarUrl,\n            profileUsername: username,\n            href: username ? `/${username}` : null,\n          };\n        }\n      }\n\n      let championPairingId: number | null = null;\n      const playoffStages = stages.filter((s) => s.stageType === \"PLAYOFF\");\n      const playoffMatches = playoffStages.flatMap((s) => s.matches);\n      if (playoffMatches.length > 0) {\n        const maxRound = Math.max(...playoffMatches.map((m) => m.round ?? 0));\n        const finalMatch = playoffMatches\n          .filter((m) => (m.round ?? 0) === maxRound)\n          .sort((a, b) => b.id - a.id)[0];\n\n        if (finalMatch?.status === \"DONE\") {\n          const winner = getWinnerSideFromScore(finalMatch.score as MatchScorePayload);\n          if (winner) {\n            championPairingId = winner === \"A\" ? finalMatch.pairing1Id ?? null : finalMatch.pairing2Id ?? null;\n          }\n        }\n      }\n\n      tournamentPayload = {\n        id: structure.id,\n        format: structure.format,\n        stages,\n        userPairingId,\n        nextMatch,\n        lastMatch,\n        championPairingId,\n        featuredMatchId,\n        sponsors: liveSponsors,\n        goalLimits: (config as Record<string, unknown>).goalLimits ?? null,\n      };\n    }\n  }\n\n  let organizerFollowed = false;\n  if (userId && event.organizer?.id) {\n    const follow = await prisma.organizer_follows.findUnique({\n      where: {\n        follower_id_organizer_id: {\n          follower_id: userId,\n          organizer_id: event.organizer.id,\n        },\n      },\n      select: { organizer_id: true },\n    });\n    organizerFollowed = Boolean(follow);\n  }\n\n    const res = NextResponse.json(\n      {\n        ok: true,\n        event: {\n          id: event.id,\n          slug: event.slug,\n          title: event.title,\n          description: event.description,\n          templateType: event.templateType,\n          startsAt: event.startsAt,\n          endsAt: event.endsAt,\n          status: event.status,\n          locationName: event.locationName,\n          locationCity: event.locationCity,\n          coverImageUrl: event.coverImageUrl,\n          liveStreamUrl: event.liveStreamUrl,\n          timezone: event.timezone,\n          liveHubVisibility,\n          publicAccessMode,\n          participantAccessMode,\n          publicTicketTypeIds,\n          participantTicketTypeIds,\n        },\n        organizer: event.organizer\n          ? {\n              id: event.organizer.id,\n              publicName: event.organizer.publicName,\n              username: event.organizer.username,\n              organizationCategory: event.organizer.organizationCategory,\n              brandingAvatarUrl: event.organizer.brandingAvatarUrl,\n              liveHubPremiumEnabled: event.organizer.liveHubPremiumEnabled,\n              isFollowed: organizerFollowed,\n            }\n          : null,\n        viewerRole,\n        organizerRole,\n        canEditMatches,\n        access: {\n          publicAccessMode,\n          participantAccessMode,\n          liveHubVisibility,\n          liveHubAllowed,\n          isParticipant,\n        },\n      liveHub: {\n        mode: liveHubMode,\n        category,\n        modules: liveHubModules,\n      },\n        tournament: tournamentPayload,\n        pairings,\n      },\n      { status: 200 },\n    );\n\n    res.headers.set(\"Cache-Control\", \"public, max-age=8\");\n    return res;\n  } catch (err) {\n    console.error(\"[livehub] error\", err);\n    return NextResponse.json({ ok: false, error: \"INTERNAL_ERROR\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}}]
}