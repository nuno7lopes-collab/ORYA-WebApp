{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/DashboardClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/organizador/DashboardClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/DashboardClient.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuS,GACpU,qEACA","ignoreList":[0]}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/DashboardClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/organizador/DashboardClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/DashboardClient.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAmR,GAChT,iDACA","ignoreList":[0]}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/page.tsx"],"sourcesContent":["import { redirect } from \"next/navigation\";\nimport { prisma } from \"@/lib/prisma\";\nimport { createSupabaseServer } from \"@/lib/supabaseServer\";\nimport { ensureLegacyOrganizerMemberships, getActiveOrganizerForUser } from \"@/lib/organizerContext\";\nimport DashboardClient from \"../DashboardClient\";\nimport { cookies } from \"next/headers\";\nimport { AuthModalProvider } from \"@/app/components/autenticação/AuthModalContext\";\n\nexport const runtime = \"nodejs\";\n\n/**\n * Router inteligente do /organizador.\n * Decide o destino com base no estado do utilizador e organizações.\n * Quando há organização ativa, renderiza o dashboard (Gerir como objetivo default no client).\n */\nexport default async function OrganizerRouterPage() {\n  const supabase = await createSupabaseServer();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    redirect(\"/login?next=/organizador\");\n  }\n\n  // 1) Contar memberships; se tabela não existir em dev, assume 0\n  let membershipCount = 0;\n  try {\n    membershipCount = await prisma.organizerMember.count({ where: { userId: user.id } });\n    if (membershipCount === 0) {\n      const legacyCount = await ensureLegacyOrganizerMemberships(user.id);\n      if (legacyCount > 0) {\n        membershipCount = await prisma.organizerMember.count({ where: { userId: user.id } });\n      }\n    }\n  } catch (err: unknown) {\n    const msg =\n      typeof err === \"object\" && err && \"message\" in err ? String((err as { message?: unknown }).message) : \"\";\n    if (!(msg.includes(\"does not exist\") || msg.includes(\"organizer_members\"))) {\n      throw err;\n    }\n  }\n\n  // Sem organizações → onboarding\n  if (membershipCount === 0) {\n    redirect(\"/organizador/become\");\n  }\n\n  // 2) Existe organização ativa?\n  let activeOrganizerId: number | null = null;\n  try {\n    const cookieStore = await cookies();\n    const cookieOrgId = cookieStore.get(\"orya_org\")?.value;\n    const forcedOrgId = cookieOrgId ? Number(cookieOrgId) : undefined;\n    const { organizer } = await getActiveOrganizerForUser(user.id, {\n      organizerId: Number.isFinite(forcedOrgId) ? forcedOrgId : undefined,\n    });\n    activeOrganizerId = organizer?.id ?? null;\n  } catch (err: unknown) {\n    const msg =\n      typeof err === \"object\" && err && \"message\" in err ? String((err as { message?: unknown }).message) : \"\";\n    if (!(msg.includes(\"does not exist\") || msg.includes(\"organizer_members\"))) {\n      throw err;\n    }\n  }\n\n  // Tem orgs mas nenhuma ativa → hub\n  if (!activeOrganizerId) {\n    redirect(\"/organizador/organizations\");\n  }\n\n  // Tem org ativa → dashboard\n  return (\n    <AuthModalProvider>\n      <DashboardClient hasOrganizer />\n    </AuthModalProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AAEO,MAAM,UAAU;AAOR,eAAe;IAC5B,MAAM,WAAW,MAAM,IAAA,6IAAoB;IAC3C,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,IAAI,CAAC,MAAM;QACT,IAAA,iMAAQ,EAAC;IACX;IAEA,gEAAgE;IAChE,IAAI,kBAAkB;IACtB,IAAI;QACF,kBAAkB,MAAM,uHAAM,CAAC,eAAe,CAAC,KAAK,CAAC;YAAE,OAAO;gBAAE,QAAQ,KAAK,EAAE;YAAC;QAAE;QAClF,IAAI,oBAAoB,GAAG;YACzB,MAAM,cAAc,MAAM,IAAA,2JAAgC,EAAC,KAAK,EAAE;YAClE,IAAI,cAAc,GAAG;gBACnB,kBAAkB,MAAM,uHAAM,CAAC,eAAe,CAAC,KAAK,CAAC;oBAAE,OAAO;wBAAE,QAAQ,KAAK,EAAE;oBAAC;gBAAE;YACpF;QACF;IACF,EAAE,OAAO,KAAc;QACrB,MAAM,MACJ,OAAO,QAAQ,YAAY,OAAO,aAAa,MAAM,OAAO,AAAC,IAA8B,OAAO,IAAI;QACxG,IAAI,CAAC,CAAC,IAAI,QAAQ,CAAC,qBAAqB,IAAI,QAAQ,CAAC,oBAAoB,GAAG;YAC1E,MAAM;QACR;IACF;IAEA,gCAAgC;IAChC,IAAI,oBAAoB,GAAG;QACzB,IAAA,iMAAQ,EAAC;IACX;IAEA,+BAA+B;IAC/B,IAAI,oBAAmC;IACvC,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,MAAM,cAAc,YAAY,GAAG,CAAC,aAAa;QACjD,MAAM,cAAc,cAAc,OAAO,eAAe;QACxD,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,IAAA,oJAAyB,EAAC,KAAK,EAAE,EAAE;YAC7D,aAAa,OAAO,QAAQ,CAAC,eAAe,cAAc;QAC5D;QACA,oBAAoB,WAAW,MAAM;IACvC,EAAE,OAAO,KAAc;QACrB,MAAM,MACJ,OAAO,QAAQ,YAAY,OAAO,aAAa,MAAM,OAAO,AAAC,IAA8B,OAAO,IAAI;QACxG,IAAI,CAAC,CAAC,IAAI,QAAQ,CAAC,qBAAqB,IAAI,QAAQ,CAAC,oBAAoB,GAAG;YAC1E,MAAM;QACR;IACF;IAEA,mCAAmC;IACnC,IAAI,CAAC,mBAAmB;QACtB,IAAA,iMAAQ,EAAC;IACX;IAEA,4BAA4B;IAC5B,qBACE,8OAAC,+KAAiB;kBAChB,cAAA,8OAAC,iJAAe;YAAC,YAAY;;;;;;;;;;;AAGnC"}}]
}