{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/components/event-sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const EventSidebar = registerClientReference(\n    function() { throw new Error(\"Attempted to call EventSidebar() from the server but EventSidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/event-sidebar.tsx <module evaluation>\",\n    \"EventSidebar\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,8DACA","ignoreList":[0]}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/components/event-sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const EventSidebar = registerClientReference(\n    function() { throw new Error(\"Attempted to call EventSidebar() from the server but EventSidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/event-sidebar.tsx\",\n    \"EventSidebar\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,0CACA","ignoreList":[0]}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/components/ui/sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const SidebarInset = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarInset() from the server but SidebarInset is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx <module evaluation>\",\n    \"SidebarInset\",\n);\nexport const SidebarProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarProvider() from the server but SidebarProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx <module evaluation>\",\n    \"SidebarProvider\",\n);\nexport const SidebarRail = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarRail() from the server but SidebarRail is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx <module evaluation>\",\n    \"SidebarRail\",\n);\nexport const SidebarTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarTrigger() from the server but SidebarTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx <module evaluation>\",\n    \"SidebarTrigger\",\n);\nexport const useSidebar = registerClientReference(\n    function() { throw new Error(\"Attempted to call useSidebar() from the server but useSidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx <module evaluation>\",\n    \"useSidebar\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;;;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,2DACA;AAEG,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,2DACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,2DACA;AAEG,MAAM,iBAAiB,IAAA,wQAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,2DACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,2DACA","ignoreList":[0]}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/components/ui/sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const SidebarInset = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarInset() from the server but SidebarInset is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx\",\n    \"SidebarInset\",\n);\nexport const SidebarProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarProvider() from the server but SidebarProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx\",\n    \"SidebarProvider\",\n);\nexport const SidebarRail = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarRail() from the server but SidebarRail is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx\",\n    \"SidebarRail\",\n);\nexport const SidebarTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call SidebarTrigger() from the server but SidebarTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx\",\n    \"SidebarTrigger\",\n);\nexport const useSidebar = registerClientReference(\n    function() { throw new Error(\"Attempted to call useSidebar() from the server but useSidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sidebar.tsx\",\n    \"useSidebar\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;;;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,wQAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,uCACA;AAEG,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,uCACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,uCACA;AAEG,MAAM,iBAAiB,IAAA,wQAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,uCACA;AAEG,MAAM,aAAa,IAAA,wQAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,uCACA","ignoreList":[0]}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/OrganizerLangSetter.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const OrganizerLangSetter = registerClientReference(\n    function() { throw new Error(\"Attempted to call OrganizerLangSetter() from the server but OrganizerLangSetter is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/OrganizerLangSetter.tsx <module evaluation>\",\n    \"OrganizerLangSetter\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,wQAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,yEACA","ignoreList":[0]}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/OrganizerLangSetter.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const OrganizerLangSetter = registerClientReference(\n    function() { throw new Error(\"Attempted to call OrganizerLangSetter() from the server but OrganizerLangSetter is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/OrganizerLangSetter.tsx\",\n    \"OrganizerLangSetter\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,wQAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,qDACA","ignoreList":[0]}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/OrganizerBreadcrumb.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const OrganizerBreadcrumb = registerClientReference(\n    function() { throw new Error(\"Attempted to call OrganizerBreadcrumb() from the server but OrganizerBreadcrumb is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/OrganizerBreadcrumb.tsx <module evaluation>\",\n    \"OrganizerBreadcrumb\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,wQAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,yEACA","ignoreList":[0]}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/OrganizerBreadcrumb.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const OrganizerBreadcrumb = registerClientReference(\n    function() { throw new Error(\"Attempted to call OrganizerBreadcrumb() from the server but OrganizerBreadcrumb is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/OrganizerBreadcrumb.tsx\",\n    \"OrganizerBreadcrumb\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,wQAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,qDACA","ignoreList":[0]}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/OrganizerShell.tsx"],"sourcesContent":["import { ReactNode, CSSProperties } from \"react\";\nimport { SidebarInset, SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { OrganizerLangSetter } from \"./OrganizerLangSetter\";\nimport { OrganizerBreadcrumb } from \"./OrganizerBreadcrumb\";\n\ntype OrganizerShellProps = {\n  children: ReactNode;\n  sidebar: ReactNode;\n  organizerLanguage: string;\n  organizerUsername?: string | null;\n  brandPrimary?: string;\n  brandSecondary?: string;\n};\n\nexport function OrganizerShell({\n  children,\n  sidebar,\n  organizerLanguage,\n  organizerUsername,\n  brandPrimary,\n  brandSecondary,\n}: OrganizerShellProps) {\n  return (\n    <SidebarProvider defaultOpen>\n      <div\n        className=\"orya-body-bg text-white flex min-h-screen items-stretch\"\n        style={\n          {\n            \"--brand-primary\": brandPrimary,\n            \"--brand-secondary\": brandSecondary,\n          } as CSSProperties\n        }\n      >\n        <OrganizerLangSetter language={organizerLanguage} />\n        {organizerUsername ? (\n          <script\n            dangerouslySetInnerHTML={{\n              __html: `try{sessionStorage.setItem(\"orya_last_organizer_username\",\"${organizerUsername}\");}catch(e){}`,\n            }}\n          />\n        ) : null}\n\n        {sidebar}\n\n        <SidebarInset>\n          <div className=\"sticky top-0 z-40 flex items-center gap-3 bg-[rgba(5,9,21,0.85)] px-4 py-3 backdrop-blur md:hidden\">\n            <SidebarTrigger />\n            <OrganizerBreadcrumb />\n          </div>\n          <div className=\"hidden lg:block mb-4\">\n            <div className=\"rounded-3xl border border-white/5 bg-[rgba(6,10,20,0.75)] backdrop-blur-xl px-4 py-3 md:px-6 md:py-4\">\n              <OrganizerBreadcrumb />\n            </div>\n          </div>\n          <main className=\"relative min-h-0 flex-1 overflow-y-auto pb-0 pt-0\">\n            <div className=\"px-4 py-4 md:px-6 lg:px-8 lg:py-6\">\n              <div className=\"relative isolate overflow-hidden\">\n                <div className=\"pointer-events-none absolute inset-0 -z-10\">\n                  <div className=\"absolute left-0 top-10 h-80 w-80 rounded-full bg-[radial-gradient(circle_at_center,rgba(255,0,200,0.08),rgba(12,18,36,0))]\" />\n                  <div className=\"absolute right-0 bottom-16 h-96 w-96 rounded-full bg-[radial-gradient(circle_at_center,rgba(107,255,255,0.10),rgba(5,9,21,0))]\" />\n                </div>\n                {children}\n              </div>\n            </div>\n          </main>\n        </SidebarInset>\n      </div>\n    </SidebarProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AAWO,SAAS,eAAe,EAC7B,QAAQ,EACR,OAAO,EACP,iBAAiB,EACjB,iBAAiB,EACjB,YAAY,EACZ,cAAc,EACM;IACpB,qBACE,8OAAC,+IAAe;QAAC,WAAW;kBAC1B,cAAA,8OAAC;YACC,WAAU;YACV,OACE;gBACE,mBAAmB;gBACnB,qBAAqB;YACvB;;8BAGF,8OAAC,iKAAmB;oBAAC,UAAU;;;;;;gBAC9B,kCACC,8OAAC;oBACC,yBAAyB;wBACvB,QAAQ,CAAC,2DAA2D,EAAE,kBAAkB,cAAc,CAAC;oBACzG;;;;;2BAEA;gBAEH;8BAED,8OAAC,4IAAY;;sCACX,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,8IAAc;;;;;8CACf,8OAAC,iKAAmB;;;;;;;;;;;sCAEtB,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,iKAAmB;;;;;;;;;;;;;;;sCAGxB,8OAAC;4BAAK,WAAU;sCACd,cAAA,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAI,WAAU;;;;;;;;;;;;wCAEhB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjB"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\nimport { Prisma, PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\nimport { env } from \"@/lib/env\";\n\n// Toggle de logs verbose (queries) via env: PRISMA_LOG_QUERIES=true\nconst enableQueryLog = process.env.PRISMA_LOG_QUERIES === \"true\";\nconst logLevels: (Prisma.LogLevel | Prisma.LogDefinition)[] =\n  process.env.NODE_ENV === \"development\"\n    ? enableQueryLog\n      ? [\"query\", \"error\", \"warn\"]\n      : [\"error\", \"warn\"]\n    : [\"error\"];\n\n// Evitar múltiplas instâncias em dev (hot reload)\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n};\n\n// Pool e adapter para usar o client engine (\"library\") com Postgres\nconst pool = new Pool({\n  connectionString: env.dbUrl,\n  ssl:\n    process.env.NODE_ENV === \"production\"\n      ? undefined\n      : { rejectUnauthorized: false },\n});\n\nconst adapter = new PrismaPg(pool);\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: logLevels,\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AACA;AACA;AACA;;;;;;;;;;AAEA,oEAAoE;AACpE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,kBAAkB,KAAK;AAC1D,MAAM,YACJ,uCACI,iBACE;IAAC;IAAS;IAAS;CAAO,GAC1B;IAAC;IAAS;CAAO,GACnB;AAEN,kDAAkD;AAClD,MAAM,kBAAkB;AAIxB,oEAAoE;AACpE,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,iHAAG,CAAC,KAAK;IAC3B,KACE,sCACI,0BACA;QAAE,oBAAoB;IAAM;AACpC;AAEA,MAAM,UAAU,IAAI,8JAAQ,CAAC;AAEtB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf;IACA,KAAK;AACP;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 416, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerRoles.ts"],"sourcesContent":["import { OrganizerMemberRole, Prisma, PrismaClient } from \"@prisma/client\";\nimport { prisma } from \"@/lib/prisma\";\n\ntype TxLike = Prisma.TransactionClient | PrismaClient;\n\n/**\n * Garante unicidade de OWNER numa organização:\n * - promove/cria o utilizador como OWNER\n * - despromove todos os outros OWNER para CO_OWNER\n */\nexport async function setSoleOwner(\n  client: TxLike,\n  organizerId: number,\n  userId: string,\n  invitedByUserId?: string | null,\n) {\n  await client.organizerMember.upsert({\n    where: { organizerId_userId: { organizerId, userId } },\n    update: { role: OrganizerMemberRole.OWNER },\n    create: {\n      organizerId,\n      userId,\n      role: OrganizerMemberRole.OWNER,\n      invitedByUserId: invitedByUserId ?? undefined,\n    },\n  });\n\n  await client.organizerMember.updateMany({\n    where: { organizerId, role: OrganizerMemberRole.OWNER, userId: { not: userId } },\n    data: { role: OrganizerMemberRole.CO_OWNER },\n  });\n}\n\n/**\n * Marca o perfil como \"organizer\" no array de roles (idempotente).\n */\nexport async function ensureUserIsOrganizer(client: TxLike, userId: string) {\n  const targetProfile = await client.profile.findUnique({\n    where: { id: userId },\n    select: { roles: true },\n  });\n  if (!targetProfile) return;\n\n  const roles = Array.isArray(targetProfile.roles) ? targetProfile.roles : [];\n  if (!roles.includes(\"organizer\")) {\n    await client.profile.update({\n      where: { id: userId },\n      data: { roles: [...roles, \"organizer\"] },\n    });\n  }\n}\n\n/**\n * Wrapper que permite usar helper fora de transação quando necessário.\n */\nexport async function setSoleOwnerSafe(\n  organizerId: number,\n  userId: string,\n  invitedByUserId?: string | null,\n) {\n  return setSoleOwner(prisma, organizerId, userId, invitedByUserId);\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;;;;;AASO,eAAe,aACpB,MAAc,EACd,WAAmB,EACnB,MAAc,EACd,eAA+B;IAE/B,MAAM,OAAO,eAAe,CAAC,MAAM,CAAC;QAClC,OAAO;YAAE,oBAAoB;gBAAE;gBAAa;YAAO;QAAE;QACrD,QAAQ;YAAE,MAAM,oJAAmB,CAAC,KAAK;QAAC;QAC1C,QAAQ;YACN;YACA;YACA,MAAM,oJAAmB,CAAC,KAAK;YAC/B,iBAAiB,mBAAmB;QACtC;IACF;IAEA,MAAM,OAAO,eAAe,CAAC,UAAU,CAAC;QACtC,OAAO;YAAE;YAAa,MAAM,oJAAmB,CAAC,KAAK;YAAE,QAAQ;gBAAE,KAAK;YAAO;QAAE;QAC/E,MAAM;YAAE,MAAM,oJAAmB,CAAC,QAAQ;QAAC;IAC7C;AACF;AAKO,eAAe,sBAAsB,MAAc,EAAE,MAAc;IACxE,MAAM,gBAAgB,MAAM,OAAO,OAAO,CAAC,UAAU,CAAC;QACpD,OAAO;YAAE,IAAI;QAAO;QACpB,QAAQ;YAAE,OAAO;QAAK;IACxB;IACA,IAAI,CAAC,eAAe;IAEpB,MAAM,QAAQ,MAAM,OAAO,CAAC,cAAc,KAAK,IAAI,cAAc,KAAK,GAAG,EAAE;IAC3E,IAAI,CAAC,MAAM,QAAQ,CAAC,cAAc;QAChC,MAAM,OAAO,OAAO,CAAC,MAAM,CAAC;YAC1B,OAAO;gBAAE,IAAI;YAAO;YACpB,MAAM;gBAAE,OAAO;uBAAI;oBAAO;iBAAY;YAAC;QACzC;IACF;AACF;AAKO,eAAe,iBACpB,WAAmB,EACnB,MAAc,EACd,eAA+B;IAE/B,OAAO,aAAa,uHAAM,EAAE,aAAa,QAAQ;AACnD"}},
    {"offset": {"line": 496, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerId.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\nimport type { NextRequest } from \"next/server\";\n\nexport const ORGANIZER_COOKIE_NAME = \"orya_org\";\n\nexport function parseOrganizerId(value: unknown): number | null {\n  if (typeof value === \"number\") {\n    return Number.isFinite(value) && value > 0 ? value : null;\n  }\n  if (typeof value !== \"string\") return null;\n  const trimmed = value.trim();\n  if (!trimmed) return null;\n  const parsed = Number(trimmed);\n  return Number.isFinite(parsed) && parsed > 0 ? parsed : null;\n}\n\nexport async function resolveOrganizerIdFromCookies(): Promise<number | null> {\n  try {\n    const cookieStore = await cookies();\n    return parseOrganizerId(cookieStore.get(ORGANIZER_COOKIE_NAME)?.value);\n  } catch {\n    return null;\n  }\n}\n\nexport function resolveOrganizerIdFromRequest(req: NextRequest): number | null {\n  const params = req.nextUrl.searchParams;\n  const paramValue = params.get(\"organizerId\") ?? params.get(\"org\");\n  return parseOrganizerId(paramValue) ?? parseOrganizerId(req.cookies.get(ORGANIZER_COOKIE_NAME)?.value);\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAGO,MAAM,wBAAwB;AAE9B,SAAS,iBAAiB,KAAc;IAC7C,IAAI,OAAO,UAAU,UAAU;QAC7B,OAAO,OAAO,QAAQ,CAAC,UAAU,QAAQ,IAAI,QAAQ;IACvD;IACA,IAAI,OAAO,UAAU,UAAU,OAAO;IACtC,MAAM,UAAU,MAAM,IAAI;IAC1B,IAAI,CAAC,SAAS,OAAO;IACrB,MAAM,SAAS,OAAO;IACtB,OAAO,OAAO,QAAQ,CAAC,WAAW,SAAS,IAAI,SAAS;AAC1D;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,OAAO,iBAAiB,YAAY,GAAG,CAAC,wBAAwB;IAClE,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,8BAA8B,GAAgB;IAC5D,MAAM,SAAS,IAAI,OAAO,CAAC,YAAY;IACvC,MAAM,aAAa,OAAO,GAAG,CAAC,kBAAkB,OAAO,GAAG,CAAC;IAC3D,OAAO,iBAAiB,eAAe,iBAAiB,IAAI,OAAO,CAAC,GAAG,CAAC,wBAAwB;AAClG"}},
    {"offset": {"line": 538, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerContext.ts"],"sourcesContent":["import { OrganizerMemberRole } from \"@prisma/client\";\nimport { prisma } from \"@/lib/prisma\";\nimport { ensureUserIsOrganizer } from \"@/lib/organizerRoles\";\nimport { resolveOrganizerIdFromCookies } from \"@/lib/organizerId\";\n\ntype Options = {\n  organizerId?: number | null;\n  roles?: OrganizerMemberRole[];\n  // Se quisermos forçar leitura de cookie, basta passar organizerId externamente\n};\n\nexport async function ensureLegacyOrganizerMemberships(userId: string, organizerId?: number | null) {\n  if (!userId) return 0;\n\n  const legacyOrganizers = await prisma.organizer.findMany({\n    where: {\n      userId,\n      ...(Number.isFinite(organizerId) ? { id: organizerId! } : {}),\n    },\n    select: { id: true },\n  });\n\n  if (legacyOrganizers.length === 0) return 0;\n\n  try {\n    await prisma.$transaction(async (tx) => {\n      for (const organizer of legacyOrganizers) {\n        await tx.organizerMember.upsert({\n          where: {\n            organizerId_userId: {\n              organizerId: organizer.id,\n              userId,\n            },\n          },\n          update: { role: OrganizerMemberRole.OWNER },\n          create: {\n            organizerId: organizer.id,\n            userId,\n            role: OrganizerMemberRole.OWNER,\n          },\n        });\n      }\n\n      await ensureUserIsOrganizer(tx, userId);\n    });\n  } catch (err: unknown) {\n    const msg =\n      typeof err === \"object\" && err && \"message\" in err ? String((err as { message?: unknown }).message) : \"\";\n    if (msg.includes(\"does not exist\") || msg.includes(\"organizer_members\")) {\n      return 0;\n    }\n    throw err;\n  }\n\n  return legacyOrganizers.length;\n}\n\nexport async function getActiveOrganizerForUser(userId: string, opts: Options = {}) {\n  const { roles } = opts;\n  const directOrganizerId =\n    typeof opts.organizerId === \"number\" && Number.isFinite(opts.organizerId)\n      ? opts.organizerId\n      : null;\n  const cookieOrganizerId = directOrganizerId ? null : await resolveOrganizerIdFromCookies();\n  const organizerId = directOrganizerId ?? cookieOrganizerId;\n\n  // 1) Se organizerId foi especificado, tenta buscar diretamente essa membership primeiro\n  if (organizerId) {\n    const direct = await prisma.organizerMember.findFirst({\n      where: {\n        userId,\n        organizerId,\n        ...(roles ? { role: { in: roles } } : {}),\n        organizer: { status: \"ACTIVE\" },\n      },\n      include: { organizer: true },\n    });\n    if (direct?.organizer) {\n      return { organizer: direct.organizer, membership: direct };\n    }\n\n    const legacyFixed = await ensureLegacyOrganizerMemberships(userId, organizerId);\n    if (legacyFixed > 0) {\n      const retry = await prisma.organizerMember.findFirst({\n        where: {\n          userId,\n          organizerId,\n          ...(roles ? { role: { in: roles } } : {}),\n          organizer: { status: \"ACTIVE\" },\n        },\n        include: { organizer: true },\n      });\n      if (retry?.organizer) {\n        return { organizer: retry.organizer, membership: retry };\n      }\n    }\n    // Se o organizerId foi pedido explicitamente e não existe membership, não faz fallback.\n    return { organizer: null, membership: null };\n  }\n\n  let memberships = await prisma.organizerMember.findMany({\n    where: {\n      userId,\n      ...(roles ? { role: { in: roles } } : {}),\n      organizer: { status: \"ACTIVE\" },\n    },\n    include: { organizer: true },\n    orderBy: [{ lastUsedAt: \"desc\" }, { createdAt: \"asc\" }],\n  });\n\n  if (memberships.length === 0) {\n    const legacyFixed = await ensureLegacyOrganizerMemberships(userId);\n    if (legacyFixed > 0) {\n      memberships = await prisma.organizerMember.findMany({\n        where: {\n          userId,\n          ...(roles ? { role: { in: roles } } : {}),\n          organizer: { status: \"ACTIVE\" },\n        },\n        include: { organizer: true },\n        orderBy: [{ lastUsedAt: \"desc\" }, { createdAt: \"asc\" }],\n      });\n    }\n  }\n\n  if (memberships && memberships.length > 0) {\n    if (memberships.length > 1) {\n      return { organizer: null, membership: null };\n    }\n    const selected = memberships[0];\n    if (selected?.organizer) {\n      return { organizer: selected.organizer, membership: selected };\n    }\n  }\n\n  return { organizer: null, membership: null };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 744, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/eventos/%5Bid%5D/layout.tsx"],"sourcesContent":["export const runtime = \"nodejs\";\n\nimport { ReactNode } from \"react\";\nimport { notFound, redirect } from \"next/navigation\";\nimport { EventSidebar } from \"@/components/event-sidebar\";\nimport { OrganizerShell } from \"@/app/organizador/OrganizerShell\";\nimport { createSupabaseServer } from \"@/lib/supabaseServer\";\nimport { getActiveOrganizerForUser } from \"@/lib/organizerContext\";\nimport { prisma } from \"@/lib/prisma\";\n\ntype EventSidebarPayload = {\n  id: number;\n  slug: string;\n  title: string;\n  status: string;\n  startsAt: Date | null;\n  endsAt: Date | null;\n  locationName: string | null;\n  locationCity: string | null;\n  coverImageUrl: string | null;\n  tournamentId: number | null;\n};\n\nexport default async function OrganizerEventLayout({\n  children,\n  params,\n}: {\n  children: ReactNode;\n  params: { id: string } | Promise<{ id: string }>;\n}) {\n  const resolvedParams = await Promise.resolve(params);\n\n  const supabase = await createSupabaseServer();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    redirect(\"/login?next=/organizador\");\n  }\n\n  const eventId = Number(resolvedParams.id);\n  if (!Number.isFinite(eventId)) {\n    notFound();\n  }\n\n  const event = await prisma.event.findUnique({\n    where: { id: eventId },\n    select: {\n      id: true,\n      slug: true,\n      title: true,\n      status: true,\n      startsAt: true,\n      endsAt: true,\n      locationName: true,\n      locationCity: true,\n      coverImageUrl: true,\n      organizerId: true,\n      tournament: { select: { id: true } },\n    },\n  });\n\n  if (!event || !event.organizerId) {\n    notFound();\n  }\n\n  const { organizer, membership } = await getActiveOrganizerForUser(user.id, {\n    organizerId: event.organizerId,\n  });\n\n  if (!organizer || !membership) {\n    redirect(\"/organizador\");\n  }\n\n  let profile: { fullName: string | null; username: string | null; avatarUrl: string | null } | null = null;\n  try {\n    profile = await prisma.profile.findUnique({\n      where: { id: user.id },\n      select: { fullName: true, username: true, avatarUrl: true },\n    });\n  } catch {\n    profile = null;\n  }\n\n  const organizerUsername = (organizer as { username?: string | null }).username ?? null;\n  const organizerAvatarUrl = (organizer as { brandingAvatarUrl?: string | null }).brandingAvatarUrl ?? null;\n  const brandPrimary = (organizer as { brandingPrimaryColor?: string | null }).brandingPrimaryColor ?? undefined;\n  const brandSecondary = (organizer as { brandingSecondaryColor?: string | null }).brandingSecondaryColor ?? undefined;\n  const organizerLanguage = (organizer as { language?: string | null }).language ?? \"pt\";\n\n  const userInfo = {\n    id: user.id,\n    name: profile?.fullName || profile?.username || user.email || null,\n    email: user.email ?? null,\n    avatarUrl: profile?.avatarUrl ?? null,\n  };\n\n  const eventSidebar: EventSidebarPayload = {\n    id: event.id,\n    slug: event.slug,\n    title: event.title,\n    status: event.status,\n    startsAt: event.startsAt,\n    endsAt: event.endsAt,\n    locationName: event.locationName,\n    locationCity: event.locationCity,\n    coverImageUrl: event.coverImageUrl ?? organizerAvatarUrl ?? null,\n    tournamentId: event.tournament?.id ?? null,\n  };\n\n  return (\n    <OrganizerShell\n      organizerLanguage={organizerLanguage}\n      organizerUsername={organizerUsername ?? null}\n      brandPrimary={brandPrimary}\n      brandSecondary={brandSecondary}\n      sidebar={<EventSidebar event={eventSidebar} user={userInfo} />}\n    >\n      {children}\n    </OrganizerShell>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAGA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AARO,MAAM,UAAU;;;;;;;AAuBR,eAAe,qBAAqB,EACjD,QAAQ,EACR,MAAM,EAIP;IACC,MAAM,iBAAiB,MAAM,QAAQ,OAAO,CAAC;IAE7C,MAAM,WAAW,MAAM,IAAA,6IAAoB;IAC3C,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,IAAI,CAAC,MAAM;QACT,IAAA,iMAAQ,EAAC;IACX;IAEA,MAAM,UAAU,OAAO,eAAe,EAAE;IACxC,IAAI,CAAC,OAAO,QAAQ,CAAC,UAAU;QAC7B,IAAA,iMAAQ;IACV;IAEA,MAAM,QAAQ,MAAM,uHAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAQ;QACrB,QAAQ;YACN,IAAI;YACJ,MAAM;YACN,OAAO;YACP,QAAQ;YACR,UAAU;YACV,QAAQ;YACR,cAAc;YACd,cAAc;YACd,eAAe;YACf,aAAa;YACb,YAAY;gBAAE,QAAQ;oBAAE,IAAI;gBAAK;YAAE;QACrC;IACF;IAEA,IAAI,CAAC,SAAS,CAAC,MAAM,WAAW,EAAE;QAChC,IAAA,iMAAQ;IACV;IAEA,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,MAAM,IAAA,oJAAyB,EAAC,KAAK,EAAE,EAAE;QACzE,aAAa,MAAM,WAAW;IAChC;IAEA,IAAI,CAAC,aAAa,CAAC,YAAY;QAC7B,IAAA,iMAAQ,EAAC;IACX;IAEA,IAAI,UAAiG;IACrG,IAAI;QACF,UAAU,MAAM,uHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE,IAAI,KAAK,EAAE;YAAC;YACrB,QAAQ;gBAAE,UAAU;gBAAM,UAAU;gBAAM,WAAW;YAAK;QAC5D;IACF,EAAE,OAAM;QACN,UAAU;IACZ;IAEA,MAAM,oBAAoB,AAAC,UAA2C,QAAQ,IAAI;IAClF,MAAM,qBAAqB,AAAC,UAAoD,iBAAiB,IAAI;IACrG,MAAM,eAAe,AAAC,UAAuD,oBAAoB,IAAI;IACrG,MAAM,iBAAiB,AAAC,UAAyD,sBAAsB,IAAI;IAC3G,MAAM,oBAAoB,AAAC,UAA2C,QAAQ,IAAI;IAElF,MAAM,WAAW;QACf,IAAI,KAAK,EAAE;QACX,MAAM,SAAS,YAAY,SAAS,YAAY,KAAK,KAAK,IAAI;QAC9D,OAAO,KAAK,KAAK,IAAI;QACrB,WAAW,SAAS,aAAa;IACnC;IAEA,MAAM,eAAoC;QACxC,IAAI,MAAM,EAAE;QACZ,MAAM,MAAM,IAAI;QAChB,OAAO,MAAM,KAAK;QAClB,QAAQ,MAAM,MAAM;QACpB,UAAU,MAAM,QAAQ;QACxB,QAAQ,MAAM,MAAM;QACpB,cAAc,MAAM,YAAY;QAChC,cAAc,MAAM,YAAY;QAChC,eAAe,MAAM,aAAa,IAAI,sBAAsB;QAC5D,cAAc,MAAM,UAAU,EAAE,MAAM;IACxC;IAEA,qBACE,8OAAC,uJAAc;QACb,mBAAmB;QACnB,mBAAmB,qBAAqB;QACxC,cAAc;QACd,gBAAgB;QAChB,uBAAS,8OAAC,+IAAY;YAAC,OAAO;YAAc,MAAM;;;;;;kBAEjD;;;;;;AAGP"}}]
}