{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/components/autentica%C3%A7%C3%A3o/AuthModalContext.tsx"],"sourcesContent":["\"use client\";\n\nimport { createContext, useContext, useState, ReactNode, useCallback } from \"react\";\n\ntype Mode = \"login\" | \"signup\" | \"verify\" | \"onboarding\" | null;\ntype OnboardingStep = \"perfil\" | \"foto\" | \"interesses\" | \"local\" | \"final\" | null;\n\ntype AuthModalContextType = {\n  isOpen: boolean;\n  mode: Mode;\n  email: string;\n  redirectTo: string | null;\n  onboardingStep: OnboardingStep;\n  showGoogle: boolean;\n  openModal: (options?: {\n    mode?: Mode;\n    email?: string;\n    redirectTo?: string;\n    onboardingStep?: OnboardingStep;\n    showGoogle?: boolean;\n  }) => void;\n  closeModal: () => void;\n  setEmail: (email: string) => void;\n  setMode: (mode: Mode) => void;\n  setRedirectTo: (redirectTo: string | null) => void;\n  setOnboardingStep: (step: OnboardingStep) => void;\n};\n\nconst AuthModalContext = createContext<AuthModalContextType | undefined>(undefined);\n\nexport const AuthModalProvider = ({ children }: { children: ReactNode }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [mode, setModeState] = useState<Mode>(null);\n  const [email, setEmailState] = useState<string>(\"\");\n\n  const [redirectTo, setRedirectToState] = useState<string | null>(null);\n  const [onboardingStep, setOnboardingStepState] = useState<OnboardingStep>(null);\n  const [showGoogle, setShowGoogle] = useState<boolean>(false);\n\n  const openModal = useCallback(\n    (options?: {\n      mode?: Mode;\n      email?: string;\n      redirectTo?: string;\n      onboardingStep?: OnboardingStep;\n      showGoogle?: boolean;\n    }) => {\n      if (options?.mode !== undefined) setModeState(options.mode);\n      if (options?.email !== undefined) setEmailState(options.email);\n      if (options?.redirectTo !== undefined) setRedirectToState(options.redirectTo);\n      if (options?.onboardingStep !== undefined) setOnboardingStepState(options.onboardingStep);\n      setShowGoogle(options?.showGoogle ?? true);\n      setIsOpen(true);\n    },\n    []\n  );\n\n  const closeModal = useCallback(() => {\n    setIsOpen(false);\n    setModeState(null);\n    setEmailState(\"\");\n    setRedirectToState(null);\n    setOnboardingStepState(null);\n    setShowGoogle(false);\n  }, []);\n\n  const setEmail = useCallback((email: string) => {\n    setEmailState(email);\n  }, []);\n\n  const setRedirectTo = useCallback((value: string | null) => {\n    setRedirectToState(value);\n  }, []);\n\n  const setOnboardingStep = useCallback((step: OnboardingStep) => {\n    setOnboardingStepState(step);\n  }, []);\n\n  const setMode = useCallback((mode: Mode) => {\n    setModeState(mode);\n  }, []);\n\n  return (\n    <AuthModalContext.Provider\n      value={{\n        isOpen,\n        mode,\n        email,\n        redirectTo,\n        onboardingStep,\n        showGoogle,\n        openModal,\n        closeModal,\n        setEmail,\n        setMode,\n        setRedirectTo,\n        setOnboardingStep,\n      }}\n    >\n      {children}\n    </AuthModalContext.Provider>\n  );\n};\n\nexport const useAuthModal = () => {\n  const ctx = useContext(AuthModalContext);\n  if (!ctx) {\n    throw new Error(\"useAuthModal must be used within an AuthModalProvider\");\n  }\n  return ctx;\n};\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AA4BA,MAAM,iCAAmB,IAAA,8KAAa,EAAmC;AAElE,MAAM,oBAAoB,CAAC,EAAE,QAAQ,EAA2B;;IACrE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,MAAM,aAAa,GAAG,IAAA,yKAAQ,EAAO;IAC5C,MAAM,CAAC,OAAO,cAAc,GAAG,IAAA,yKAAQ,EAAS;IAEhD,MAAM,CAAC,YAAY,mBAAmB,GAAG,IAAA,yKAAQ,EAAgB;IACjE,MAAM,CAAC,gBAAgB,uBAAuB,GAAG,IAAA,yKAAQ,EAAiB;IAC1E,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAU;IAEtD,MAAM,YAAY,IAAA,4KAAW;oDAC3B,CAAC;YAOC,IAAI,SAAS,SAAS,WAAW,aAAa,QAAQ,IAAI;YAC1D,IAAI,SAAS,UAAU,WAAW,cAAc,QAAQ,KAAK;YAC7D,IAAI,SAAS,eAAe,WAAW,mBAAmB,QAAQ,UAAU;YAC5E,IAAI,SAAS,mBAAmB,WAAW,uBAAuB,QAAQ,cAAc;YACxF,cAAc,SAAS,cAAc;YACrC,UAAU;QACZ;mDACA,EAAE;IAGJ,MAAM,aAAa,IAAA,4KAAW;qDAAC;YAC7B,UAAU;YACV,aAAa;YACb,cAAc;YACd,mBAAmB;YACnB,uBAAuB;YACvB,cAAc;QAChB;oDAAG,EAAE;IAEL,MAAM,WAAW,IAAA,4KAAW;mDAAC,CAAC;YAC5B,cAAc;QAChB;kDAAG,EAAE;IAEL,MAAM,gBAAgB,IAAA,4KAAW;wDAAC,CAAC;YACjC,mBAAmB;QACrB;uDAAG,EAAE;IAEL,MAAM,oBAAoB,IAAA,4KAAW;4DAAC,CAAC;YACrC,uBAAuB;QACzB;2DAAG,EAAE;IAEL,MAAM,UAAU,IAAA,4KAAW;kDAAC,CAAC;YAC3B,aAAa;QACf;iDAAG,EAAE;IAEL,qBACE,6LAAC,iBAAiB,QAAQ;QACxB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;GAxEa;KAAA;AA0EN,MAAM,eAAe;;IAC1B,MAAM,MAAM,IAAA,2KAAU,EAAC;IACvB,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANa"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/supabaseBrowser.ts"],"sourcesContent":["\"use client\";\n\nimport { createBrowserClient } from \"@supabase/ssr\";\n\n/**\n * Cliente Supabase para uso no browser.\n * Usa as vari√°veis NEXT_PUBLIC_*, que s√£o expostas ao front-end.\n * ‚ö†Ô∏è N√£o importar '@/lib/env' aqui, porque isso √© s√≥ para c√≥digo server-side.\n */\n\nfunction cleanupAuthStorage() {\n  if (typeof window === \"undefined\") return;\n  const storages = [window.localStorage, window.sessionStorage];\n  for (const store of storages) {\n    try {\n      for (let i = store.length - 1; i >= 0; i--) {\n        const key = store.key(i);\n        if (!key || !key.startsWith(\"sb-\")) continue;\n        // n√£o removemos mais base64, para n√£o apagar sess√µes v√°lidas\n      }\n    } catch {\n      // ignore\n    }\n  }\n\n  // Mantemos cookies sb- intactas; n√£o apagamos base64 para n√£o destruir sess√µes v√°lidas\n}\n\nfunction getBrowserSupabaseClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error(\n      \"Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY\"\n    );\n  }\n\n  cleanupAuthStorage();\n  return createBrowserClient(supabaseUrl, supabaseAnonKey);\n}\n\nexport const supabaseBrowser = getBrowserSupabaseClient();\n"],"names":[],"mappings":";;;;AA6BsB;AA3BtB;AAAA;AAFA;;AAIA;;;;CAIC,GAED,SAAS;IACP;;IACA,MAAM,WAAW;QAAC,OAAO,YAAY;QAAE,OAAO,cAAc;KAAC;IAC7D,KAAK,MAAM,SAAS,SAAU;QAC5B,IAAI;YACF,IAAK,IAAI,IAAI,MAAM,MAAM,GAAG,GAAG,KAAK,GAAG,IAAK;gBAC1C,MAAM,MAAM,MAAM,GAAG,CAAC;gBACtB,IAAI,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,QAAQ;YACpC,6DAA6D;YAC/D;QACF,EAAE,OAAM;QACN,SAAS;QACX;IACF;AAEA,uFAAuF;AACzF;AAEA,SAAS;IACP,MAAM;IACN,MAAM;IAEN;;IAMA;IACA,OAAO,IAAA,oMAAmB,EAAC,aAAa;AAC1C;AAEO,MAAM,kBAAkB"}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/hooks/useUser.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport useSWR from \"swr\";\nimport { supabaseBrowser } from \"@/lib/supabaseBrowser\";\n\ntype Role = \"user\" | \"organizer\" | \"admin\" | string;\n\ntype ApiMeResponse = {\n  user: {\n    id: string;\n    email: string | null;\n    emailConfirmed?: boolean;\n    emailConfirmedAt?: string | null;\n  } | null;\n  profile: {\n    id: string;\n    username: string | null;\n    fullName: string | null;\n    avatarUrl: string | null;\n    coverUrl: string | null;\n    bio: string | null;\n    city: string | null;\n    favouriteCategories: string[];\n    onboardingDone: boolean;\n    roles: Role[];\n    visibility: string;\n    allowEmailNotifications: boolean;\n    allowEventReminders: boolean;\n    allowFriendRequests: boolean;\n    profileVisibility: \"PUBLIC\" | \"PRIVATE\";\n  } | null;\n};\n\nconst fetcher = async (url: string) => {\n  const res = await fetch(url, { credentials: \"include\", cache: \"no-store\" });\n  if (res.status === 401) {\n    // Sem sess√£o v√°lida ‚Üí devolve user/profile null sem erro\n    return { user: null, profile: null };\n  }\n  if (!res.ok) {\n    throw new Error(\"Falha ao carregar user\");\n  }\n  return (await res.json()) as ApiMeResponse;\n};\n\nexport function useUser() {\n  const { data, error, isLoading, mutate } = useSWR<ApiMeResponse>(\n    \"/api/auth/me\",\n    fetcher\n  );\n  const [migrated, setMigrated] = useState(false);\n  const migratedRef = useRef(false);\n\n  // For√ßar refresh quando o estado de auth muda (sign in/out) para evitar estado preso\n  useEffect(() => {\n    const {\n      data: { subscription },\n    } = supabaseBrowser.auth.onAuthStateChange(() => {\n      mutate();\n    });\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [mutate]);\n\n  // Claim guest purchases ap√≥s email verificado (best-effort)\n  useEffect(() => {\n    const claim = async () => {\n      try {\n        await fetch(\"/api/me/claim-guest\", { method: \"POST\" });\n      } catch (err) {\n        console.warn(\"[useUser] claim-guest falhou\", err);\n      }\n    };\n    const emailVerified =\n      Boolean((data?.user as any)?.emailConfirmedAt) ||\n      Boolean((data?.user as any)?.emailConfirmed) ||\n      Boolean(data?.user?.email);\n\n    if (data?.user && emailVerified && !migratedRef.current) {\n      migratedRef.current = true;\n      claim();\n    }\n  }, [data?.user]);\n\n  return {\n    user: data?.user ?? null,\n    profile: data?.profile ?? null,\n    roles: data?.profile?.roles ?? [],\n    isLoading,\n    isLoggedIn: !!data?.user,\n    error,\n    mutate,\n    refetch: mutate,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAkCA,MAAM,UAAU,OAAO;IACrB,MAAM,MAAM,MAAM,MAAM,KAAK;QAAE,aAAa;QAAW,OAAO;IAAW;IACzE,IAAI,IAAI,MAAM,KAAK,KAAK;QACtB,yDAAyD;QACzD,OAAO;YAAE,MAAM;YAAM,SAAS;QAAK;IACrC;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,IAAI,MAAM;IAClB;IACA,OAAQ,MAAM,IAAI,IAAI;AACxB;AAEO,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAA,4KAAM,EAC/C,gBACA;IAEF,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,cAAc,IAAA,uKAAM,EAAC;IAE3B,qFAAqF;IACrF,IAAA,0KAAS;6BAAC;YACR,MAAM,EACJ,MAAM,EAAE,YAAY,EAAE,EACvB,GAAG,4IAAe,CAAC,IAAI,CAAC,iBAAiB;qCAAC;oBACzC;gBACF;;YACA;qCAAO;oBACL,aAAa,WAAW;gBAC1B;;QACF;4BAAG;QAAC;KAAO;IAEX,4DAA4D;IAC5D,IAAA,0KAAS;6BAAC;YACR,MAAM;2CAAQ;oBACZ,IAAI;wBACF,MAAM,MAAM,uBAAuB;4BAAE,QAAQ;wBAAO;oBACtD,EAAE,OAAO,KAAK;wBACZ,QAAQ,IAAI,CAAC,gCAAgC;oBAC/C;gBACF;;YACA,MAAM,gBACJ,QAAS,MAAM,MAAc,qBAC7B,QAAS,MAAM,MAAc,mBAC7B,QAAQ,MAAM,MAAM;YAEtB,IAAI,MAAM,QAAQ,iBAAiB,CAAC,YAAY,OAAO,EAAE;gBACvD,YAAY,OAAO,GAAG;gBACtB;YACF;QACF;4BAAG;QAAC,MAAM;KAAK;IAEf,OAAO;QACL,MAAM,MAAM,QAAQ;QACpB,SAAS,MAAM,WAAW;QAC1B,OAAO,MAAM,SAAS,SAAS,EAAE;QACjC;QACA,YAAY,CAAC,CAAC,MAAM;QACpB;QACA;QACA,SAAS;IACX;AACF;GAlDgB;;QAC6B,4KAAM"}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/components/notifications/NotificationBell.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport useSWR from \"swr\";\nimport { useUser } from \"@/app/hooks/useUser\";\nimport Link from \"next/link\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { pt } from \"date-fns/locale\";\n\ntype NotificationDto = {\n  id: string;\n  type: string;\n  title: string;\n  body: string;\n  ctaUrl?: string | null;\n  ctaLabel?: string | null;\n  priority?: \"LOW\" | \"NORMAL\" | \"HIGH\";\n  readAt?: string | null;\n  isRead?: boolean;\n  createdAt: string;\n};\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json());\n\nconst TYPE_LABEL: Record<string, string> = {\n  ORGANIZER_INVITE: \"Convite de organiza√ß√£o\",\n  STAFF_INVITE: \"Convite de staff\",\n  EVENT_SALE: \"Venda\",\n  STRIPE_STATUS: \"Stripe\",\n  EVENT_REMINDER: \"Lembrete\",\n  FRIEND_REQUEST: \"Pedido de amizade\",\n  FRIEND_ACCEPT: \"Amigo aceitou\",\n  MARKETING_PROMO_ALERT: \"Marketing\",\n  SYSTEM_ANNOUNCE: \"Sistema\",\n};\n\nexport function NotificationBell() {\n  const { user } = useUser();\n  const [open, setOpen] = useState(false);\n  const [filter, setFilter] = useState<\"all\" | \"sales\" | \"invites\" | \"system\" | \"social\">(\"all\");\n  const panelRef = useRef<HTMLDivElement | null>(null);\n  const queryTypes =\n    filter === \"sales\"\n      ? \"EVENT_SALE\"\n      : filter === \"invites\"\n        ? \"ORGANIZER_INVITE,STAFF_INVITE\"\n        : filter === \"system\"\n          ? \"STRIPE_STATUS,MARKETING_PROMO_ALERT,SYSTEM_ANNOUNCE\"\n          : filter === \"social\"\n            ? \"FRIEND_REQUEST,FRIEND_ACCEPT\"\n            : undefined;\n  const query = user\n    ? `/api/notifications?status=all${queryTypes ? `&types=${encodeURIComponent(queryTypes)}` : \"\"}`\n    : null;\n\n  const { data, mutate } = useSWR(\n    query,\n    fetcher,\n    { refreshInterval: 30000, revalidateOnFocus: true },\n  );\n\n  const items: NotificationDto[] = useMemo(() => data?.items ?? [], [data]);\n  const unreadCount = useMemo(\n    () => items.filter((n) => n.isRead === false || (!n.isRead && !n.readAt)).length,\n    [items],\n  );\n\n  useEffect(() => {\n    const onClick = (e: MouseEvent) => {\n      if (panelRef.current && !panelRef.current.contains(e.target as Node)) {\n        setOpen(false);\n      }\n    };\n    if (open) document.addEventListener(\"mousedown\", onClick);\n    return () => document.removeEventListener(\"mousedown\", onClick);\n  }, [open]);\n\n  const markAll = async () => {\n    await fetch(\"/api/notifications/mark-read\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ markAll: true }),\n    });\n    mutate();\n  };\n\n  const grouped = useMemo(() => {\n    const groups: Record<string, NotificationDto[]> = {};\n    for (const n of items) {\n      const date = new Date(n.createdAt);\n      const key = date.toLocaleDateString(\"pt-PT\");\n      groups[key] = groups[key] ? [...groups[key], n] : [n];\n    }\n    return groups;\n  }, [items]);\n\n  return (\n    <div className=\"relative\">\n      <button\n        type=\"button\"\n        onClick={() => setOpen((v) => !v)}\n        className=\"relative rounded-full border border-white/15 bg-white/5 p-2 text-white/80 hover:bg-white/10 transition\"\n        aria-label=\"Notifica√ß√µes\"\n      >\n        <span>üîî</span>\n        {unreadCount > 0 && (\n          <span className=\"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-emerald-500 px-1 text-[11px] font-semibold text-black text-center\">\n            {unreadCount}\n          </span>\n        )}\n      </button>\n\n      {open && (\n        <div\n          ref={panelRef}\n          className=\"absolute right-0 mt-2 w-80 rounded-2xl border border-white/10 bg-[#0b0f18]/95 shadow-[0_20px_80px_rgba(0,0,0,0.6)] backdrop-blur-xl p-3 text-white/80 z-50\"\n        >\n          <div className=\"mb-2 flex items-center justify-between text-xs\">\n            <span className=\"font-semibold text-white\">Notifica√ß√µes</span>\n            <button\n              type=\"button\"\n              className=\"text-[11px] text-white/60 hover:text-white\"\n              onClick={markAll}\n            >\n              Marcar todas como lidas\n            </button>\n          </div>\n\n          <div className=\"mb-3 flex flex-wrap gap-2 text-[11px]\">\n            {[\n              { key: \"all\", label: \"Todas\" },\n              { key: \"sales\", label: \"Vendas\" },\n              { key: \"invites\", label: \"Convites\" },\n              { key: \"system\", label: \"Sistema\" },\n              { key: \"social\", label: \"Social\" },\n            ].map((item) => (\n              <button\n                key={item.key}\n                type=\"button\"\n                onClick={() => setFilter(item.key as typeof filter)}\n                className={`rounded-full border px-2.5 py-1 ${\n                  filter === item.key\n                    ? \"border-emerald-400/50 bg-emerald-500/15 text-emerald-100\"\n                    : \"border-white/15 bg-white/5 text-white/70 hover:border-white/30\"\n                }`}\n              >\n                {item.label}\n              </button>\n            ))}\n          </div>\n\n          {items.length === 0 && (\n            <div className=\"rounded-xl border border-dashed border-white/15 bg-white/5 p-3 text-xs text-white/60\">\n              Sem notifica√ß√µes ainda.\n            </div>\n          )}\n\n          {Object.entries(grouped).map(([day, list]) => (\n            <div key={day} className=\"mb-3\">\n              <p className=\"text-[11px] uppercase tracking-[0.18em] text-white/50 mb-1\">{day}</p>\n              <div className=\"space-y-1.5\">\n                {list.map((n) => (\n                  <div\n                    key={n.id}\n                    className={`rounded-xl border px-3 py-2 text-xs ${\n                      n.readAt\n                        ? \"border-white/10 bg-white/3\"\n                        : \"border-emerald-400/30 bg-emerald-500/8\"\n                    }`}\n                  >\n                    <div className=\"flex items-center justify-between gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-[11px] text-white/60\">\n                          {TYPE_LABEL[n.type] ?? \"Atualiza√ß√£o\"}\n                        </span>\n                        {(n.isRead === false || (!n.isRead && !n.readAt)) && (\n                          <span className=\"h-2 w-2 rounded-full bg-emerald-400\" />\n                        )}\n                      </div>\n                      <span className=\"text-[11px] text-white/45\">\n                        {formatDistanceToNow(new Date(n.createdAt), { locale: pt, addSuffix: true })}\n                      </span>\n                    </div>\n                    <p className=\"mt-1 text-[13px] font-semibold text-white\">{n.title}</p>\n                    <p className=\"text-white/70\">{n.body}</p>\n                    {n.ctaUrl && n.ctaLabel && (\n                      <Link\n                        href={n.ctaUrl}\n                        className=\"mt-2 inline-flex text-[11px] text-[#6BFFFF] hover:underline\"\n                      >\n                        {n.ctaLabel}\n                      </Link>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 594, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/components/Navbar.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { useAuthModal } from \"@/app/components/autentica√ß√£o/AuthModalContext\";\nimport { useUser } from \"@/app/hooks/useUser\";\nimport Link from \"next/link\";\nimport { NotificationBell } from \"./notifications/NotificationBell\";\nimport { supabaseBrowser } from \"@/lib/supabaseBrowser\";\n\ntype SearchEvent = {\n  id: number;\n  slug: string;\n  title: string;\n  startsAt: string | null;\n  locationName: string | null;\n  locationCity: string | null;\n  coverImageUrl: string | null;\n  priceFrom: number | null;\n  isFree: boolean;\n};\n\ntype SearchOrganizer = {\n  id: number;\n  username: string | null;\n  publicName: string | null;\n  businessName: string | null;\n  brandingAvatarUrl: string | null;\n  organizationCategory: string | null;\n  city: string | null;\n  isFollowing?: boolean;\n};\n\ntype SearchUser = {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  avatarUrl: string | null;\n  isFollowing?: boolean;\n};\n\ntype SearchTab = \"all\" | \"events\" | \"organizers\" | \"users\";\n\nexport function Navbar() {\n  const router = useRouter();\n  const rawPathname = usePathname();\n\n  const { openModal: openAuthModal, isOpen: isAuthOpen } = useAuthModal();\n  const { user, profile, roles, isLoading } = useUser();\n\n  const [isVisible, setIsVisible] = useState(true);\n  const [isAtTop, setIsAtTop] = useState(true);\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [eventResults, setEventResults] = useState<SearchEvent[]>([]);\n  const [organizerResults, setOrganizerResults] = useState<SearchOrganizer[]>([]);\n  const [userResults, setUserResults] = useState<SearchUser[]>([]);\n  const [isSuggestLoading, setIsSuggestLoading] = useState(false);\n  const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false);\n  const [activeSearchTab, setActiveSearchTab] = useState<SearchTab>(\"all\");\n  const [followPending, setFollowPending] = useState<Record<string, boolean>>({});\n  const [hydratedPathname, setHydratedPathname] = useState<string | null>(null);\n  const [lastOrganizerUsername, setLastOrganizerUsername] = useState<string | null>(null);\n  const profileMenuRef = useRef<HTMLDivElement | null>(null);\n  const searchPanelRef = useRef<HTMLDivElement | null>(null);\n  const lastScrollYRef = useRef(0);\n  const pathname = hydratedPathname ?? \"\";\n  const shouldHide = rawPathname?.startsWith(\"/organizador\");\n\n  const Logo = () => (\n    <button\n      type=\"button\"\n      onClick={() => router.push(\"/\")}\n      className=\"flex items-center gap-2 transition hover:opacity-90\"\n      aria-label=\"Voltar √† homepage ORYA\"\n    >\n      <img\n        src=\"/brand/orya-logo.png\"\n        alt=\"Logo ORYA\"\n        className=\"h-14 w-14 rounded-full object-cover shadow-[0_0_24px_rgba(155,114,255,0.55)]\"\n      />\n      <span className=\"text-lg font-semibold tracking-[0.2em] text-white\">ORYA</span>\n    </button>\n  );\n\n  useEffect(() => {\n    // Garantir pathname est√°vel s√≥ depois de montar para evitar mismatch\n    if (typeof window !== \"undefined\") {\n      setHydratedPathname(rawPathname ?? window.location.pathname);\n    }\n  }, [rawPathname]);\n\n  useEffect(() => {\n    if (typeof document === \"undefined\") return;\n    if (shouldHide) {\n      document.body.dataset.navHidden = \"true\";\n    } else {\n      delete document.body.dataset.navHidden;\n    }\n  }, [shouldHide]);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n\n    const handleScroll = () => {\n      const currentY = window.scrollY || 0;\n      const atTop = currentY < 12;\n      setIsAtTop((prev) => (prev === atTop ? prev : atTop));\n\n      const prevY = lastScrollYRef.current;\n\n      if (atTop) {\n        // No topo: navbar sempre vis√≠vel\n        setIsVisible(true);\n      } else {\n        // A descer esconde, a subir mostra\n        if (currentY > prevY + 12) {\n          setIsVisible(false);\n        } else if (currentY < prevY - 12) {\n          setIsVisible(true);\n        }\n      }\n\n      lastScrollYRef.current = currentY;\n    };\n\n    // Inicializa logo o estado correto com a posi√ß√£o atual do scroll\n    handleScroll();\n\n    window.addEventListener(\"scroll\", handleScroll, { passive: true });\n\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (typeof document === \"undefined\") return;\n\n    const originalOverflow = document.body.style.overflow;\n\n    if (isSearchOpen) {\n      document.body.style.overflow = \"hidden\";\n    } else {\n      document.body.style.overflow = originalOverflow;\n    }\n\n    return () => {\n      document.body.style.overflow = originalOverflow;\n    };\n  }, [isSearchOpen]);\n\n  useEffect(() => {\n    if (isSearchOpen) {\n      setActiveSearchTab(\"all\");\n    }\n  }, [isSearchOpen]);\n\n  useEffect(() => {\n    if (typeof document === \"undefined\") return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        profileMenuRef.current &&\n        !profileMenuRef.current.contains(event.target as Node)\n      ) {\n        setIsProfileMenuOpen(false);\n      }\n    };\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        setIsSearchOpen(false);\n        setIsProfileMenuOpen(false);\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    document.addEventListener(\"keydown\", handleKeyDown);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!isSearchOpen) return;\n    const handleGlobalClick = (event: MouseEvent) => {\n      const target = event.target as Node | null;\n      if (searchPanelRef.current && target && !searchPanelRef.current.contains(target)) {\n        setIsSearchOpen(false);\n      }\n    };\n    document.addEventListener(\"mousedown\", handleGlobalClick, true);\n    return () => document.removeEventListener(\"mousedown\", handleGlobalClick, true);\n  }, [isSearchOpen]);\n\n  const inAuthPage =\n    pathname === \"/login\" || pathname === \"/signup\" || pathname === \"/auth/callback\";\n\n  const handleSubmitSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    const query = searchQuery.trim();\n    if (!query) return;\n\n    setIsSearchOpen(false);\n    router.push(`/explorar?query=${encodeURIComponent(query)}`);\n  };\n\n  const handleQuickSearch = (value: string) => {\n    setIsSearchOpen(false);\n    router.push(`/explorar?query=${encodeURIComponent(value)}`);\n  };\n\n  const handleLogout = async () => {\n    try {\n      await supabaseBrowser.auth.signOut();\n    } catch (err) {\n      console.warn(\"[navbar] signOut falhou\", err);\n    } finally {\n      setIsProfileMenuOpen(false);\n      router.push(\"/\");\n      router.refresh();\n    }\n  };\n\n  const buildEventHref = (slug: string) => `/eventos/${slug}`;\n  const buildProfileHref = (username?: string | null) => (username ? `/${username}` : \"/me\");\n\n  // Sugest√µes ao digitar (tipo DICE)\n  useEffect(() => {\n    let active = true;\n    const controller = new AbortController();\n\n    async function load() {\n      const q = searchQuery.trim();\n      if (q.length < 1) {\n        setEventResults([]);\n        setOrganizerResults([]);\n        setUserResults([]);\n        setIsSuggestLoading(false);\n        return;\n      }\n      try {\n        setIsSuggestLoading(true);\n        const query = encodeURIComponent(q);\n        const [eventsData, usersData, organizersData] = await Promise.all([\n          fetch(`/api/explorar/list?q=${query}&limit=6`, {\n            cache: \"no-store\",\n            signal: controller.signal,\n          })\n            .then((res) => (res.ok ? res.json() : null))\n            .catch(() => null),\n          fetch(`/api/users/search?q=${query}&limit=6`, {\n            cache: \"no-store\",\n            signal: controller.signal,\n          })\n            .then((res) => (res.ok ? res.json() : null))\n            .catch(() => null),\n          fetch(`/api/organizers/search?q=${query}&limit=6`, {\n            cache: \"no-store\",\n            signal: controller.signal,\n          })\n            .then((res) => (res.ok ? res.json() : null))\n            .catch(() => null),\n        ]);\n\n        if (!active) return;\n\n        const eventItems = Array.isArray(eventsData?.items)\n          ? (eventsData.items as Array<{\n              id: number;\n              slug: string;\n              title: string;\n              startsAt?: string | null;\n              location?: { name?: string | null; city?: string | null };\n              coverImageUrl?: string | null;\n              priceFrom?: number | null;\n              isFree?: boolean;\n            }>)\n          : [];\n\n        const userItems = Array.isArray(usersData?.results)\n          ? (usersData.results as SearchUser[])\n          : [];\n\n        const organizerItems = Array.isArray(organizersData?.results)\n          ? (organizersData.results as SearchOrganizer[])\n          : [];\n\n        setEventResults(\n          eventItems.map((it) => ({\n            id: it.id,\n            slug: it.slug,\n            title: it.title,\n            startsAt: it.startsAt ?? null,\n            locationName: it.location?.name ?? null,\n            locationCity: it.location?.city ?? null,\n            coverImageUrl: it.coverImageUrl ?? null,\n            priceFrom: typeof it.priceFrom === \"number\" ? it.priceFrom : null,\n            isFree: Boolean(it.isFree),\n          })),\n        );\n        setUserResults(userItems);\n        setOrganizerResults(organizerItems);\n      } catch (err) {\n        if (err instanceof DOMException && err.name === \"AbortError\") return;\n        if (active) {\n          setEventResults([]);\n          setOrganizerResults([]);\n          setUserResults([]);\n        }\n      } finally {\n        if (active) setIsSuggestLoading(false);\n      }\n    }\n\n    const handle = setTimeout(load, 220);\n    return () => {\n      active = false;\n      controller.abort();\n      clearTimeout(handle);\n    };\n  }, [searchQuery]);\n\n  // For√ßar onboarding: se autenticado e perfil incompleto, abre modal e impede fechar\n  useEffect(() => {\n    if (user && profile && !profile.onboardingDone && !isAuthOpen && !inAuthPage) {\n      openAuthModal({\n        mode: \"onboarding\",\n        redirectTo: pathname || \"/\",\n      });\n    }\n  }, [user, profile, pathname, openAuthModal, isAuthOpen, inAuthPage]);\n\n  const isAuthenticated = !!user;\n  const userLabel =\n    profile?.username ||\n    profile?.fullName ||\n    (typeof user?.email === \"string\" ? user.email : \"\");\n  const userInitial =\n    (userLabel || \"O\").trim().charAt(0).toUpperCase() || \"O\";\n\n  const formatEventDate = (startsAt: string | null) =>\n    startsAt\n      ? new Date(startsAt).toLocaleString(\"pt-PT\", {\n          weekday: \"short\",\n          day: \"2-digit\",\n          month: \"short\",\n          hour: \"2-digit\",\n          minute: \"2-digit\",\n        })\n      : \"Data a anunciar\";\n\n  const hasResults =\n    eventResults.length > 0 || organizerResults.length > 0 || userResults.length > 0;\n  const normalizedQuery = searchQuery.trim();\n  const hasActiveQuery = normalizedQuery.length >= 1;\n\n  const setFollowPendingFlag = (key: string, value: boolean) => {\n    setFollowPending((prev) => ({ ...prev, [key]: value }));\n  };\n\n  const updateUserFollowState = (targetId: string, next: boolean) => {\n    setUserResults((prev) =>\n      prev.map((item) =>\n        item.id === targetId ? { ...item, isFollowing: next } : item,\n      ),\n    );\n  };\n\n  const updateOrganizerFollowState = (targetId: number, next: boolean) => {\n    setOrganizerResults((prev) =>\n      prev.map((item) =>\n        item.id === targetId ? { ...item, isFollowing: next } : item,\n      ),\n    );\n  };\n\n  const ensureAuthForFollow = () => {\n    if (isAuthenticated) return true;\n    const redirect = pathname && pathname !== \"/\" ? pathname : \"/\";\n    openAuthModal({ mode: \"login\", redirectTo: redirect });\n    return false;\n  };\n\n  const toggleUserFollow = async (targetId: string, next: boolean) => {\n    if (!ensureAuthForFollow()) return;\n    const key = `user_${targetId}`;\n    setFollowPendingFlag(key, true);\n    updateUserFollowState(targetId, next);\n    try {\n      const res = await fetch(next ? \"/api/social/follow\" : \"/api/social/unfollow\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ targetUserId: targetId }),\n      });\n      if (!res.ok) {\n        updateUserFollowState(targetId, !next);\n      }\n    } catch {\n      updateUserFollowState(targetId, !next);\n    } finally {\n      setFollowPendingFlag(key, false);\n    }\n  };\n\n  const toggleOrganizerFollow = async (targetId: number, next: boolean) => {\n    if (!ensureAuthForFollow()) return;\n    const key = `org_${targetId}`;\n    setFollowPendingFlag(key, true);\n    updateOrganizerFollowState(targetId, next);\n    try {\n      const res = await fetch(\n        next ? \"/api/social/follow-organizer\" : \"/api/social/unfollow-organizer\",\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ organizerId: targetId }),\n        },\n      );\n      if (!res.ok) {\n        updateOrganizerFollowState(targetId, !next);\n      }\n    } catch {\n      updateOrganizerFollowState(targetId, !next);\n    } finally {\n      setFollowPendingFlag(key, false);\n    }\n  };\n\n  const goTo = (href: string) => {\n    setIsSearchOpen(false);\n    router.push(href);\n  };\n\n  const searchTabs: Array<{ key: SearchTab; label: string }> = [\n    { key: \"all\", label: \"Global\" },\n    { key: \"events\", label: \"Eventos\" },\n    { key: \"organizers\", label: \"Organizadores\" },\n    { key: \"users\", label: \"Utilizadores\" },\n  ];\n\n  useEffect(() => {\n    try {\n      const stored = sessionStorage.getItem(\"orya_last_organizer_username\");\n      if (stored) setLastOrganizerUsername(stored);\n    } catch {\n      // ignore storage issues\n    }\n  }, []);\n\n  return (\n    <>\n      <header\n        className={`fixed inset-x-0 top-0 z-50 transition-transform duration-300 ease-out ${\n          isVisible ? \"translate-y-0\" : \"-translate-y-full\"\n        } ${shouldHide ? \"hidden\" : \"\"}`}\n      >\n        <div\n          className={`relative flex w-full items-center gap-4 rounded-b-[28px] border-b px-4 py-4 transition-all duration-300 md:px-6 md:py-5 lg:px-8 ${\n            isAtTop\n              ? \"border-transparent bg-transparent shadow-none backdrop-blur-[6px]\"\n              : \"border-white/10 bg-[linear-gradient(120deg,rgba(8,10,20,0.38),rgba(8,10,20,0.52))] shadow-[0_16px_40px_rgba(0,0,0,0.45)] backdrop-blur-[18px]\"\n          }`}\n        >\n          {/* Logo + link explorar */}\n          <div className=\"flex flex-1 items-center gap-3\">\n            <Logo />\n\n            <nav className=\"hidden items-center gap-3 text-xs text-zinc-300 md:flex\">\n              <button\n                type=\"button\"\n                onClick={() => router.push(\"/explorar\")}\n                className={`rounded-full px-4 py-2 text-sm font-semibold transition-colors ${\n                  pathname?.startsWith(\"/explorar\")\n                    ? \"bg-[linear-gradient(120deg,rgba(255,0,200,0.22),rgba(107,255,255,0.18))] text-white border border-white/30 shadow-[0_0_18px_rgba(107,255,255,0.35)]\"\n                    : \"text-white/85 hover:text-white bg-white/5 border border-white/16 hover:border-white/26\"\n                }`}\n              >\n                Explorar\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => router.push(\"/organizador\")}\n                className={`rounded-full px-4 py-2 text-sm font-semibold transition-colors ${\n                  pathname?.startsWith(\"/organizador\")\n                    ? \"bg-[linear-gradient(120deg,rgba(107,255,255,0.18),rgba(22,70,245,0.22))] text-white border border-white/28 shadow-[0_0_18px_rgba(22,70,245,0.28)]\"\n                    : \"text-white/85 hover:text-white bg-white/5 border border-white/16 hover:border-white/26\"\n                }`}\n              >\n                Organizar\n              </button>\n            </nav>\n          </div>\n\n          {/* Barra de pesquisa central */}\n          <div className=\"hidden md:flex flex-[1.2] justify-center\">\n            <button\n              type=\"button\"\n              onClick={() => setIsSearchOpen(true)}\n              className=\"group relative flex w-full max-w-xl items-center gap-3 rounded-full border border-white/16 bg-[linear-gradient(120deg,rgba(255,0,200,0.1),rgba(107,255,255,0.1)),rgba(5,6,12,0.82)] px-4 py-2 text-left text-[13px] text-white hover:border-white/35 hover:shadow-[0_0_35px_rgba(107,255,255,0.28)] transition shadow-[0_26px_60px_rgba(0,0,0,0.7)] backdrop-blur-2xl\"\n            >\n              <span className=\"flex h-5 w-5 items-center justify-center rounded-full border border-white/30 text-[10px] text-white/70\">\n                ‚åï\n              </span>\n              <span className=\"flex-1 truncate text-[12px]\">\n                Procurar por evento, local ou cidade\n              </span>\n              <span className=\"hidden rounded-full border border-white/20 px-2.5 py-1 text-[10px] text-white/50 md:inline\">\n                Pesquisar\n              </span>\n            </button>\n          </div>\n\n          {/* Lado direito: auth/profile */}\n          <div className=\"flex flex-1 items-center justify-end gap-2 md:gap-3\">\n            {/* Acesso r√°pido a Organizar no mobile */}\n            <button\n              type=\"button\"\n              onClick={() => router.push(\"/organizador\")}\n              className=\"inline-flex md:hidden items-center rounded-full border border-white/16 bg-white/10 px-3 py-1.5 text-[11px] font-semibold text-white/90 hover:border-white/28 hover:bg-white/16 transition\"\n            >\n              Organizar\n            </button>\n            {isLoading ? (\n              <div className=\"flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5 text-[11px] text-white/60 animate-pulse\">\n                <div className=\"h-7 w-7 rounded-full bg-white/20\" />\n                <div className=\"h-3 w-20 rounded-full bg-white/15\" />\n              </div>\n            ) : !isAuthenticated || inAuthPage ? (\n              <button\n                type=\"button\"\n                onClick={() => {\n                  const redirect = pathname && pathname !== \"/\" ? pathname : \"/\";\n                  openAuthModal({ mode: \"login\", redirectTo: redirect });\n                }}\n                className=\"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] px-3.5 py-1.5 text-[11px] font-semibold text-black shadow-[0_0_26px_rgba(107,255,255,0.65)] hover:brightness-110\"\n              >\n                Entrar / Registar\n              </button>\n            ) : (\n              <div className=\"relative flex items-center gap-2\" ref={profileMenuRef}>\n                <NotificationBell />\n                <button\n                  type=\"button\"\n                  onClick={() => setIsProfileMenuOpen((open) => !open)}\n                  className=\"flex items-center gap-2 rounded-full border border-white/18 bg-white/8 px-2.5 py-1 text-[11px] text-white/90 hover:border-white/28 hover:bg-white/12 shadow-[0_0_22px_rgba(255,0,200,0.22)] transition\"\n                  aria-haspopup=\"menu\"\n                  aria-expanded={isProfileMenuOpen}\n                  aria-label=\"Abrir menu de conta\"\n                >\n                  <div className=\"relative h-9 w-9\">\n                    <div className=\"absolute inset-[-3px] rounded-full bg-[conic-gradient(from_180deg,#ff00c8_0deg,#ff5afc_120deg,#6b7bff_240deg,#ff00c8_360deg)] opacity-85 blur-[8px]\" />\n                    <div className=\"relative h-full w-full overflow-hidden rounded-full border border-white/20 bg-gradient-to-br from-[#0b0f1b] via-[#0f1222] to-[#0a0d18] text-[11px] font-bold text-white shadow-[0_0_22px_rgba(255,0,200,0.32)]\">\n                      <span className=\"pointer-events-none absolute inset-0 rounded-full border border-white/10\" />\n                      <span className=\"pointer-events-none absolute inset-0 rounded-full bg-gradient-to-tr from-[#FF00C8]/35 via-[#6BFFFF]/22 to-transparent animate-[spin_16s_linear_infinite]\" />\n                      <span className=\"relative z-10 flex h-full w-full items-center justify-center bg-gradient-to-r from-[#FF9CF2] to-[#6BFFFF] bg-clip-text text-transparent\">\n                        {userInitial}\n                      </span>\n                    </div>\n                  </div>\n                  <span className=\"hidden max-w-[120px] truncate text-[11px] sm:inline\">\n                    {userLabel || \"Conta ORYA\"}\n                  </span>\n                </button>\n\n                {isProfileMenuOpen && (\n                  <div\n                    className=\"absolute right-0 top-full mt-3 w-60 origin-top-right rounded-2xl border border-white/16 bg-[linear-gradient(135deg,rgba(3,4,10,0.97),rgba(8,10,18,0.98))] p-2 text-[11px] text-white/90 shadow-[0_28px_80px_rgba(0,0,0,0.88)] backdrop-blur-3xl\"\n                    role=\"menu\"\n                    aria-label=\"Menu de conta ORYA\"\n                  >\n                    <Link\n                      href=\"/me\"\n                      onClick={() => setIsProfileMenuOpen(false)}\n                      className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                    >\n                      <span className=\"font-semibold text-white\">Minha conta</span>\n                    </Link>\n                    <Link\n                      href=\"/me/carteira\"\n                      onClick={() => setIsProfileMenuOpen(false)}\n                      className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                    >\n                      <span>Carteira</span>\n                    </Link>\n                    <Link\n                      href=\"/me/compras\"\n                      onClick={() => setIsProfileMenuOpen(false)}\n                      className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                    >\n                      <span>Compras</span>\n                    </Link>\n                    <Link\n                      href=\"/me/settings\"\n                      onClick={() => setIsProfileMenuOpen(false)}\n                      className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                    >\n                      <span>Defini√ß√µes</span>\n                    </Link>\n                    {lastOrganizerUsername && (\n                      <Link\n                        href={`/${lastOrganizerUsername}`}\n                        onClick={() => setIsProfileMenuOpen(false)}\n                        className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                      >\n                        <span>Ver p√°gina p√∫blica</span>\n                      </Link>\n                    )}\n                    {pathname?.startsWith(\"/organizador\") && (\n                      <Link\n                        href=\"/me\"\n                        onClick={() => setIsProfileMenuOpen(false)}\n                        className=\"flex w-full items-center justify-between rounded-xl px-2.5 py-2 text-left hover:bg-white/8\"\n                      >\n                        <span>Voltar a utilizador</span>\n                      </Link>\n                    )}\n                    {/* Dashboard de organizador removido do dropdown: j√° est√° acess√≠vel na nav */}\n                    <div className=\"my-1 h-px w-full bg-white/10\" />\n                    <button\n                      type=\"button\"\n                      onClick={handleLogout}\n                      className=\"mt-1 w-full rounded-xl bg-white/10 px-3 py-2 text-left font-semibold text-red-100 hover:bg-white/15\"\n                    >\n                      Terminar sess√£o\n                    </button>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </header>\n      {/* Overlay de pesquisa estilo full-screen, com sugest√µes */}\n      {isSearchOpen && (\n        <div\n              className=\"fixed inset-0 z-40 bg-black/25 backdrop-blur-[28px] backdrop-saturate-150\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          onClick={(e) => {\n            if (e.target === e.currentTarget) {\n              setIsSearchOpen(false);\n            }\n          }}\n        >\n          <div ref={searchPanelRef} className=\"mx-auto mt-24 md:mt-28 max-w-3xl px-4\">\n            <div\n              className=\"rounded-3xl border border-white/14 bg-[radial-gradient(circle_at_12%_0%,rgba(255,0,200,0.14),transparent_40%),radial-gradient(circle_at_88%_0%,rgba(107,255,255,0.16),transparent_36%),linear-gradient(120deg,rgba(8,10,20,0.75),rgba(8,10,20,0.58),rgba(8,10,20,0.7))] p-4 shadow-[0_28px_80px_rgba(0,0,0,0.75)] backdrop-blur-2xl\"\n              aria-label=\"Pesquisa de eventos ORYA\"\n            >\n              <form\n                onSubmit={handleSubmitSearch}\n                className=\"flex items-center gap-3 rounded-2xl border border-white/16 bg-[linear-gradient(120deg,rgba(255,0,200,0.08),rgba(107,255,255,0.08)),rgba(8,10,20,0.22)] px-4 py-2.5 shadow-[0_12px_32px_rgba(0,0,0,0.45)] backdrop-blur-2xl\"\n              >\n                <span className=\"flex h-6 w-6 items-center justify-center rounded-full border border-white/30 text-[12px] text-white/80\">\n                  ‚åï\n                </span>\n                <input\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"O que queres fazer hoje?\"\n                  className=\"flex-1 bg-transparent text-base text-white placeholder:text-white/65 focus:outline-none\"\n                  autoFocus\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setIsSearchOpen(false)}\n                  className=\"text-[11px] text-white/60 hover:text-white\"\n                >\n                  Fechar\n                </button>\n              </form>\n\n              <div className=\"mt-4\">\n                <div\n                  className=\"flex flex-wrap items-center gap-2 rounded-full border border-white/12 bg-white/5 p-1 text-[11px] text-white/70\"\n                  role=\"tablist\"\n                  aria-label=\"Resultados da pesquisa\"\n                >\n                  {searchTabs.map((tab) => (\n                    <button\n                      key={tab.key}\n                      type=\"button\"\n                      onClick={() => setActiveSearchTab(tab.key)}\n                      role=\"tab\"\n                      aria-selected={activeSearchTab === tab.key}\n                      className={`rounded-full px-3 py-1.5 font-semibold transition ${\n                        activeSearchTab === tab.key\n                          ? \"bg-white/15 text-white shadow-[0_0_18px_rgba(255,255,255,0.15)]\"\n                          : \"text-white/70 hover:text-white hover:bg-white/10\"\n                      }`}\n                    >\n                      {tab.label}\n                    </button>\n                  ))}\n                </div>\n\n                <div className=\"mt-4 rounded-2xl border border-white/12 bg-[linear-gradient(140deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02))] p-3 shadow-[0_18px_60px_rgba(0,0,0,0.45)]\">\n                  <div className=\"flex items-center justify-between text-[11px] text-white/75\">\n                    <span>Resultados</span>\n                    {isSuggestLoading && (\n                      <span className=\"animate-pulse text-white/65\">a carregar‚Ä¶</span>\n                    )}\n                  </div>\n\n                  <div className=\"mt-3 max-h-[60vh] space-y-4 overflow-y-auto pr-1\">\n                    {!hasActiveQuery && (\n                      <p className=\"text-[11px] text-white/70\">\n                        Come√ßa a escrever para veres eventos, organizadores e utilizadores.\n                      </p>\n                    )}\n\n                    {hasActiveQuery && !isSuggestLoading && !hasResults && (\n                      <p className=\"text-[11px] text-white/70\">\n                        Sem resultados para ‚Äú{normalizedQuery}‚Äù.\n                      </p>\n                    )}\n\n                    {hasActiveQuery && activeSearchTab === \"all\" && (\n                      <div className=\"space-y-4\">\n                        <div className=\"rounded-2xl border border-white/10 bg-white/5 p-3\">\n                          <div className=\"flex items-center justify-between text-[11px] text-white/75\">\n                            <span>Eventos</span>\n                            {eventResults.length > 0 && (\n                              <button\n                                type=\"button\"\n                                onClick={() => setActiveSearchTab(\"events\")}\n                                className=\"rounded-full border border-white/12 bg-white/5 px-2 py-0.5 text-[10px] text-white/70 hover:bg-white/10\"\n                              >\n                                Ver tudo\n                              </button>\n                            )}\n                          </div>\n                          <div className=\"mt-2 space-y-2\">\n                            {eventResults.slice(0, 3).map((item) => (\n                              <button\n                                key={`event-${item.id}`}\n                                type=\"button\"\n                                onClick={() => goTo(buildEventHref(item.slug))}\n                                className=\"w-full rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5 text-left hover:border-white/20 hover:bg-white/8 transition flex gap-3\"\n                              >\n                                <div className=\"h-12 w-12 overflow-hidden rounded-lg border border-white/10 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                                  {item.coverImageUrl ? (\n                                    // eslint-disable-next-line @next/next/no-img-element\n                                    <img\n                                      src={item.coverImageUrl}\n                                      alt={item.title}\n                                      className=\"h-full w-full object-cover\"\n                                    />\n                                  ) : (\n                                    <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                      ORYA\n                                    </div>\n                                  )}\n                                </div>\n                                <div className=\"flex-1 min-w-0\">\n                                  <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                    {item.title}\n                                  </p>\n                                  <p className=\"text-[10px] text-white/80 line-clamp-1\">\n                                    {item.locationName || item.locationCity || \"Local a anunciar\"}\n                                  </p>\n                                  <p className=\"text-[10px] text-white/70\">\n                                    {formatEventDate(item.startsAt)}\n                                  </p>\n                                </div>\n                                <div className=\"flex flex-col items-end gap-1 text-[10px] text-white/70\">\n                                  <span>\n                                    {item.isFree\n                                      ? \"Gr√°tis\"\n                                      : item.priceFrom !== null\n                                        ? `Desde ${item.priceFrom.toFixed(2)} ‚Ç¨`\n                                        : \"Pre√ßo a anunciar\"}\n                                  </span>\n                                  <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-[10px] text-white/85\">\n                                    Ver\n                                  </span>\n                                </div>\n                              </button>\n                            ))}\n                            {eventResults.length === 0 && (\n                              <p className=\"text-[11px] text-white/60\">Nenhum evento encontrado.</p>\n                            )}\n                          </div>\n                        </div>\n\n                        <div className=\"rounded-2xl border border-white/10 bg-white/5 p-3\">\n                          <div className=\"flex items-center justify-between text-[11px] text-white/75\">\n                            <span>Organizadores</span>\n                            {organizerResults.length > 0 && (\n                              <button\n                                type=\"button\"\n                                onClick={() => setActiveSearchTab(\"organizers\")}\n                                className=\"rounded-full border border-white/12 bg-white/5 px-2 py-0.5 text-[10px] text-white/70 hover:bg-white/10\"\n                              >\n                                Ver tudo\n                              </button>\n                            )}\n                          </div>\n                          <div className=\"mt-2 space-y-2\">\n                            {organizerResults.slice(0, 3).map((item) => {\n                              const isFollowing = Boolean(item.isFollowing);\n                              const pending = followPending[`org_${item.id}`];\n                              const displayName =\n                                item.publicName?.trim() ||\n                                item.businessName?.trim() ||\n                                item.username ||\n                                \"Organizador ORYA\";\n                              return (\n                                <div\n                                  key={`org-${item.id}`}\n                                  className=\"flex items-center gap-3 rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5\"\n                                >\n                                  <button\n                                    type=\"button\"\n                                    onClick={() => goTo(buildProfileHref(item.username))}\n                                    className=\"flex flex-1 items-center gap-3 text-left\"\n                                  >\n                                    <div className=\"h-12 w-12 overflow-hidden rounded-full border border-white/12 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                                      {item.brandingAvatarUrl ? (\n                                        // eslint-disable-next-line @next/next/no-img-element\n                                        <img\n                                          src={item.brandingAvatarUrl}\n                                          alt={displayName}\n                                          className=\"h-full w-full object-cover\"\n                                        />\n                                      ) : (\n                                        <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                          ORYA\n                                        </div>\n                                      )}\n                                    </div>\n                                    <div className=\"min-w-0\">\n                                      <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                        {displayName}\n                                      </p>\n                                      <p className=\"text-[10px] text-white/70 line-clamp-1\">\n                                        {item.username ? `@${item.username}` : item.city || \"Organizador\"}\n                                      </p>\n                                    </div>\n                                  </button>\n                                  <button\n                                    type=\"button\"\n                                    disabled={pending}\n                                    onClick={() => toggleOrganizerFollow(item.id, !isFollowing)}\n                                    className={`rounded-full px-3 py-1 text-[10px] font-semibold transition ${\n                                      isFollowing\n                                        ? \"border border-emerald-300/40 bg-emerald-400/15 text-emerald-100\"\n                                        : \"border border-white/20 bg-white/10 text-white/80 hover:bg-white/15\"\n                                    } ${pending ? \"opacity-60\" : \"\"}`}\n                                  >\n                                    {pending ? \"‚Ä¶\" : isFollowing ? \"A seguir\" : \"Seguir\"}\n                                  </button>\n                                </div>\n                              );\n                            })}\n                            {organizerResults.length === 0 && (\n                              <p className=\"text-[11px] text-white/60\">Nenhum organizador encontrado.</p>\n                            )}\n                          </div>\n                        </div>\n\n                        <div className=\"rounded-2xl border border-white/10 bg-white/5 p-3\">\n                          <div className=\"flex items-center justify-between text-[11px] text-white/75\">\n                            <span>Utilizadores</span>\n                            {userResults.length > 0 && (\n                              <button\n                                type=\"button\"\n                                onClick={() => setActiveSearchTab(\"users\")}\n                                className=\"rounded-full border border-white/12 bg-white/5 px-2 py-0.5 text-[10px] text-white/70 hover:bg-white/10\"\n                              >\n                                Ver tudo\n                              </button>\n                            )}\n                          </div>\n                          <div className=\"mt-2 space-y-2\">\n                            {userResults.slice(0, 3).map((item) => {\n                              const isFollowing = Boolean(item.isFollowing);\n                              const pending = followPending[`user_${item.id}`];\n                              const displayName =\n                                item.fullName?.trim() || item.username || \"Utilizador ORYA\";\n                              return (\n                                <div\n                                  key={`user-${item.id}`}\n                                  className=\"flex items-center gap-3 rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5\"\n                                >\n                                  <button\n                                    type=\"button\"\n                                    onClick={() => goTo(buildProfileHref(item.username))}\n                                    className=\"flex flex-1 items-center gap-3 text-left\"\n                                  >\n                                    <div className=\"h-12 w-12 overflow-hidden rounded-full border border-white/12 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                                      {item.avatarUrl ? (\n                                        // eslint-disable-next-line @next/next/no-img-element\n                                        <img\n                                          src={item.avatarUrl}\n                                          alt={displayName}\n                                          className=\"h-full w-full object-cover\"\n                                        />\n                                      ) : (\n                                        <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                          ORYA\n                                        </div>\n                                      )}\n                                    </div>\n                                    <div className=\"min-w-0\">\n                                      <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                        {displayName}\n                                      </p>\n                                      <p className=\"text-[10px] text-white/70 line-clamp-1\">\n                                        {item.username ? `@${item.username}` : \"Utilizador\"}\n                                      </p>\n                                    </div>\n                                  </button>\n                                  <button\n                                    type=\"button\"\n                                    disabled={pending}\n                                    onClick={() => toggleUserFollow(item.id, !isFollowing)}\n                                    className={`rounded-full px-3 py-1 text-[10px] font-semibold transition ${\n                                      isFollowing\n                                        ? \"border border-emerald-300/40 bg-emerald-400/15 text-emerald-100\"\n                                        : \"border border-white/20 bg-white/10 text-white/80 hover:bg-white/15\"\n                                    } ${pending ? \"opacity-60\" : \"\"}`}\n                                  >\n                                    {pending ? \"‚Ä¶\" : isFollowing ? \"A seguir\" : \"Seguir\"}\n                                  </button>\n                                </div>\n                              );\n                            })}\n                            {userResults.length === 0 && (\n                              <p className=\"text-[11px] text-white/60\">Nenhum utilizador encontrado.</p>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    )}\n\n                    {hasActiveQuery && activeSearchTab === \"events\" && (\n                      <div className=\"space-y-2\">\n                        {eventResults.map((item) => (\n                          <button\n                            key={`event-tab-${item.id}`}\n                            type=\"button\"\n                            onClick={() => goTo(buildEventHref(item.slug))}\n                            className=\"w-full rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5 text-left hover:border-white/20 hover:bg-white/8 transition flex gap-3\"\n                          >\n                            <div className=\"h-12 w-12 overflow-hidden rounded-lg border border-white/10 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                              {item.coverImageUrl ? (\n                                // eslint-disable-next-line @next/next/no-img-element\n                                <img\n                                  src={item.coverImageUrl}\n                                  alt={item.title}\n                                  className=\"h-full w-full object-cover\"\n                                />\n                              ) : (\n                                <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                  ORYA\n                                </div>\n                              )}\n                            </div>\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                {item.title}\n                              </p>\n                              <p className=\"text-[10px] text-white/80 line-clamp-1\">\n                                {item.locationName || item.locationCity || \"Local a anunciar\"}\n                              </p>\n                              <p className=\"text-[10px] text-white/70\">\n                                {formatEventDate(item.startsAt)}\n                              </p>\n                            </div>\n                            <div className=\"flex flex-col items-end gap-1 text-[10px] text-white/70\">\n                              <span>\n                                {item.isFree\n                                  ? \"Gr√°tis\"\n                                  : item.priceFrom !== null\n                                    ? `Desde ${item.priceFrom.toFixed(2)} ‚Ç¨`\n                                    : \"Pre√ßo a anunciar\"}\n                              </span>\n                              <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-[10px] text-white/85\">\n                                Ver\n                              </span>\n                            </div>\n                          </button>\n                        ))}\n                        {eventResults.length === 0 && (\n                          <p className=\"text-[11px] text-white/60\">Nenhum evento encontrado.</p>\n                        )}\n                      </div>\n                    )}\n\n                    {hasActiveQuery && activeSearchTab === \"organizers\" && (\n                      <div className=\"space-y-2\">\n                        {organizerResults.map((item) => {\n                          const isFollowing = Boolean(item.isFollowing);\n                          const pending = followPending[`org_${item.id}`];\n                          const displayName =\n                            item.publicName?.trim() ||\n                            item.businessName?.trim() ||\n                            item.username ||\n                            \"Organizador ORYA\";\n                          return (\n                            <div\n                              key={`org-tab-${item.id}`}\n                              className=\"flex items-center gap-3 rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5\"\n                            >\n                              <button\n                                type=\"button\"\n                                onClick={() => goTo(buildProfileHref(item.username))}\n                                className=\"flex flex-1 items-center gap-3 text-left\"\n                              >\n                                <div className=\"h-12 w-12 overflow-hidden rounded-full border border-white/12 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                                  {item.brandingAvatarUrl ? (\n                                    // eslint-disable-next-line @next/next/no-img-element\n                                    <img\n                                      src={item.brandingAvatarUrl}\n                                      alt={displayName}\n                                      className=\"h-full w-full object-cover\"\n                                    />\n                                  ) : (\n                                    <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                      ORYA\n                                    </div>\n                                  )}\n                                </div>\n                                <div className=\"min-w-0\">\n                                  <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                    {displayName}\n                                  </p>\n                                  <p className=\"text-[10px] text-white/70 line-clamp-1\">\n                                    {item.username ? `@${item.username}` : item.city || \"Organizador\"}\n                                  </p>\n                                </div>\n                              </button>\n                              <button\n                                type=\"button\"\n                                disabled={pending}\n                                onClick={() => toggleOrganizerFollow(item.id, !isFollowing)}\n                                className={`rounded-full px-3 py-1 text-[10px] font-semibold transition ${\n                                  isFollowing\n                                    ? \"border border-emerald-300/40 bg-emerald-400/15 text-emerald-100\"\n                                    : \"border border-white/20 bg-white/10 text-white/80 hover:bg-white/15\"\n                                } ${pending ? \"opacity-60\" : \"\"}`}\n                              >\n                                {pending ? \"‚Ä¶\" : isFollowing ? \"A seguir\" : \"Seguir\"}\n                              </button>\n                            </div>\n                          );\n                        })}\n                        {organizerResults.length === 0 && (\n                          <p className=\"text-[11px] text-white/60\">Nenhum organizador encontrado.</p>\n                        )}\n                      </div>\n                    )}\n\n                    {hasActiveQuery && activeSearchTab === \"users\" && (\n                      <div className=\"space-y-2\">\n                        {userResults.map((item) => {\n                          const isFollowing = Boolean(item.isFollowing);\n                          const pending = followPending[`user_${item.id}`];\n                          const displayName =\n                            item.fullName?.trim() || item.username || \"Utilizador ORYA\";\n                          return (\n                            <div\n                              key={`user-tab-${item.id}`}\n                              className=\"flex items-center gap-3 rounded-xl border border-white/12 bg-[linear-gradient(120deg,rgba(255,255,255,0.04),rgba(8,10,22,0.7))] p-2.5\"\n                            >\n                              <button\n                                type=\"button\"\n                                onClick={() => goTo(buildProfileHref(item.username))}\n                                className=\"flex flex-1 items-center gap-3 text-left\"\n                              >\n                                <div className=\"h-12 w-12 overflow-hidden rounded-full border border-white/12 bg-[radial-gradient(circle_at_30%_30%,rgba(255,0,200,0.14),transparent_45%),radial-gradient(circle_at_70%_70%,rgba(107,255,255,0.14),transparent_50%),#0b0f1b]\">\n                                  {item.avatarUrl ? (\n                                    // eslint-disable-next-line @next/next/no-img-element\n                                    <img\n                                      src={item.avatarUrl}\n                                      alt={displayName}\n                                      className=\"h-full w-full object-cover\"\n                                    />\n                                  ) : (\n                                    <div className=\"flex h-full w-full items-center justify-center text-[10px] font-semibold uppercase tracking-wide text-white/55\">\n                                      ORYA\n                                    </div>\n                                  )}\n                                </div>\n                                <div className=\"min-w-0\">\n                                  <p className=\"text-[12px] font-semibold text-white line-clamp-1\">\n                                    {displayName}\n                                  </p>\n                                  <p className=\"text-[10px] text-white/70 line-clamp-1\">\n                                    {item.username ? `@${item.username}` : \"Utilizador\"}\n                                  </p>\n                                </div>\n                              </button>\n                              <button\n                                type=\"button\"\n                                disabled={pending}\n                                onClick={() => toggleUserFollow(item.id, !isFollowing)}\n                                className={`rounded-full px-3 py-1 text-[10px] font-semibold transition ${\n                                  isFollowing\n                                    ? \"border border-emerald-300/40 bg-emerald-400/15 text-emerald-100\"\n                                    : \"border border-white/20 bg-white/10 text-white/80 hover:bg-white/15\"\n                                } ${pending ? \"opacity-60\" : \"\"}`}\n                              >\n                                {pending ? \"‚Ä¶\" : isFollowing ? \"A seguir\" : \"Seguir\"}\n                              </button>\n                            </div>\n                          );\n                        })}\n                        {userResults.length === 0 && (\n                          <p className=\"text-[11px] text-white/60\">Nenhum utilizador encontrado.</p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2343, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/components/autentica%C3%A7%C3%A3o/AuthModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuthModal } from \"./AuthModalContext\";\nimport { supabaseBrowser } from \"@/lib/supabaseBrowser\";\nimport { mutate as swrMutate } from \"swr\";\nimport type { User } from \"@supabase/supabase-js\";\n\nexport default function AuthModal() {\n  const modal = useAuthModal();\n\n  if (!modal.isOpen) return null;\n\n  const modalKey = `${modal.mode}-${modal.redirectTo ?? \"none\"}`;\n\n  return <AuthModalContent key={modalKey} {...modal} />;\n}\n\ntype AuthModalContentProps = ReturnType<typeof useAuthModal>;\n\nfunction AuthModalContent({\n  mode,\n  email,\n  setEmail,\n  closeModal,\n  setMode,\n  redirectTo,\n  showGoogle,\n}: AuthModalContentProps) {\n  const router = useRouter();\n\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [otp, setOtp] = useState(\"\");\n  const [loginOtpSending, setLoginOtpSending] = useState(false);\n  const [loginOtpSent, setLoginOtpSent] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [fullName, setFullName] = useState(\"\");\n  const [username, setUsername] = useState(\"\");\n  const [signupCooldown, setSignupCooldown] = useState(0);\n  const [otpCooldown, setOtpCooldown] = useState(0);\n  const [otpResending, setOtpResending] = useState(false);\n  const [usernameHint, setUsernameHint] = useState<string | null>(null);\n\n  const RESEND_COOLDOWN = 30;\n  const isSignupBlocked = signupCooldown > 0;\n  const isOnboarding = mode === \"onboarding\";\n\n  const modalRef = useRef<HTMLDivElement | null>(null);\n\n  function clearPendingVerification() {\n    setOtpCooldown(0);\n    setOtp(\"\");\n    setError(null);\n    if (typeof window !== \"undefined\") {\n      try {\n        window.localStorage.removeItem(\"orya_pending_email\");\n        window.localStorage.removeItem(\"orya_pending_step\");\n        window.localStorage.removeItem(\"orya_otp_last_sent_at\");\n      } catch {\n        /* ignore */\n      }\n    }\n  }\n  function hardResetAuthState() {\n    clearPendingVerification();\n    setEmail(\"\");\n    setPassword(\"\");\n    setConfirmPassword(\"\");\n    setOtp(\"\");\n    setLoginOtpSent(false);\n    setLoginOtpSending(false);\n    setOtpResending(false);\n    setError(null);\n    setMode(\"login\");\n  }\n\n  function isUnconfirmedError(err: unknown) {\n    if (!err) return false;\n    const anyErr = err as { message?: string; status?: number; error_description?: string };\n    const msg = (anyErr.message || anyErr.error_description || \"\").toLowerCase();\n    if (!msg) return false;\n    return (\n      msg.includes(\"not confirmed\") ||\n      msg.includes(\"confirm your email\") ||\n      msg.includes(\"email_not_confirmed\")\n    );\n  }\n\n  useEffect(() => {\n    function handleClickOutside(e: MouseEvent) {\n      if (\n        modalRef.current &&\n        !modalRef.current.contains(e.target as Node) &&\n        !isOnboarding\n      ) {\n        closeModal();\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [closeModal, isOnboarding]);\n\n  // Recupera email pendente ap√≥s reload\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    try {\n      const pendingEmail = window.localStorage.getItem(\"orya_pending_email\");\n      const pendingStep = window.localStorage.getItem(\"orya_pending_step\");\n      const lastOtp = Number(window.localStorage.getItem(\"orya_otp_last_sent_at\") || \"0\");\n      const elapsed = lastOtp ? Math.floor((Date.now() - lastOtp) / 1000) : RESEND_COOLDOWN;\n      const remaining = Math.max(0, RESEND_COOLDOWN - elapsed);\n      if (pendingEmail && !email) setEmail(pendingEmail);\n      if (pendingStep === \"verify\") {\n        setMode(\"verify\");\n        if (remaining > 0) setOtpCooldown(remaining);\n      }\n    } catch {\n      /* ignore */\n    }\n  }, [email, setEmail, setMode]);\n\n  // Se estivermos no modo verify mas o user j√° estiver confirmado (sess√£o existente),\n  // limpamos o estado pendente e fechamos o modal para n√£o bloquear o fluxo.\n  useEffect(() => {\n    if (mode !== \"verify\") return;\n    if (otpCooldown === 0) {\n      setOtpCooldown(RESEND_COOLDOWN);\n      if (typeof window !== \"undefined\") {\n        window.localStorage.setItem(\"orya_otp_last_sent_at\", String(Date.now()));\n      }\n    }\n    let cancelled = false;\n    (async () => {\n      try {\n        const { data } = await supabaseBrowser.auth.getUser();\n        const supaUser = (data?.user as User | null) ?? null;\n        const confirmed =\n          Boolean(supaUser?.email_confirmed_at) ||\n          Boolean((supaUser as { email_confirmed?: string | null } | null)?.email_confirmed) ||\n          false;\n        if (confirmed && !cancelled) {\n          clearPendingVerification();\n          setError(null);\n          closeModal();\n        }\n      } catch {\n        /* ignore */\n      }\n    })();\n    return () => {\n      cancelled = true;\n    };\n  }, [mode, closeModal]);\n\n  async function syncSessionWithServer() {\n    try {\n      const { data } = await supabaseBrowser.auth.getSession();\n      const access_token = data.session?.access_token;\n      const refresh_token = data.session?.refresh_token;\n      if (!access_token || !refresh_token) return;\n      await fetch(\"/api/auth/refresh\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ access_token, refresh_token }),\n        credentials: \"include\",\n      });\n    } catch (err) {\n      console.warn(\"syncSessionWithServer failed\", err);\n    }\n  }\n\n  async function handleLoginOtp() {\n    if (!email) {\n      setError(\"Indica o email para receber o link de entrada.\");\n      return;\n    }\n    setLoginOtpSending(true);\n    setError(null);\n    setLoginOtpSent(false);\n    try {\n      const redirect =\n        typeof window !== \"undefined\"\n          ? `${window.location.origin}/auth/callback`\n          : undefined;\n      const { error: otpErr } = await supabaseBrowser.auth.signInWithOtp({\n        email,\n        options: { emailRedirectTo: redirect },\n      });\n      if (otpErr) {\n        setError(otpErr.message ?? \"N√£o foi poss√≠vel enviar o link de login.\");\n        setLoginOtpSending(false);\n        return;\n      }\n      setLoginOtpSent(true);\n    } catch (err) {\n      console.error(\"[AuthModal] login OTP error:\", err);\n      setError(\"N√£o foi poss√≠vel enviar o link de login.\");\n    } finally {\n      setLoginOtpSending(false);\n    }\n  }\n\n  async function handleResetPassword() {\n    if (!email) {\n      setError(\"Indica o email para recuperar a password.\");\n      return;\n    }\n    setLoginOtpSending(true);\n    setError(null);\n    setLoginOtpSent(false);\n    try {\n      const res = await fetch(\"/api/auth/password/reset-request\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email }),\n      });\n      const data = await res.json().catch(() => null);\n      if (!res.ok || data?.ok === false) {\n        setError(data?.error ?? \"N√£o foi poss√≠vel enviar recupera√ß√£o de password.\");\n        setLoginOtpSending(false);\n        return;\n      }\n      setLoginOtpSent(true);\n    } catch (err) {\n      console.error(\"[AuthModal] reset password error:\", err);\n      setError(\"N√£o foi poss√≠vel enviar recupera√ß√£o de password.\");\n    } finally {\n      setLoginOtpSending(false);\n    }\n  }\n\n  async function triggerResendOtp(emailToUse: string) {\n    setError(null);\n    setOtpResending(true);\n\n    try {\n      const res = await fetch(\"/api/auth/resend-otp\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email: emailToUse }),\n      });\n      const data = await res.json().catch(() => null);\n      if (!res.ok) {\n        setError(data?.error ?? \"N√£o foi poss√≠vel reenviar o c√≥digo.\");\n        setOtpCooldown(0);\n      } else {\n        setLoginOtpSent(true);\n        setOtpCooldown(RESEND_COOLDOWN);\n        if (typeof window !== \"undefined\") {\n          window.localStorage.setItem(\"orya_otp_last_sent_at\", String(Date.now()));\n          window.localStorage.setItem(\"orya_pending_email\", emailToUse);\n          window.localStorage.setItem(\"orya_pending_step\", \"verify\");\n        }\n      }\n    } catch (err) {\n      console.error(\"triggerResendOtp error\", err);\n      setError(\"N√£o foi poss√≠vel reenviar o c√≥digo.\");\n      setOtpCooldown(0);\n    } finally {\n      setOtpResending(false);\n    }\n  }\n\n  async function finishAuthAndMaybeOnboard() {\n    try {\n      // Garantir que o servidor tem a sess√£o atualizada antes de pedir /api/auth/me\n      await syncSessionWithServer();\n\n      const res = await fetch(\"/api/auth/me\", {\n        method: \"GET\",\n        credentials: \"include\",\n      });\n\n      // Se a API exigir confirma√ß√£o de email, volta para o modo verify\n      if (!res.ok) {\n        const data = await res.json().catch(() => null);\n        const needsEmailConfirmation = data?.needsEmailConfirmation;\n        if (needsEmailConfirmation) {\n          if (typeof window !== \"undefined\" && email) {\n            window.localStorage.setItem(\"orya_pending_email\", email);\n            window.localStorage.setItem(\"orya_pending_step\", \"verify\");\n          }\n          setMode(\"verify\");\n          if (email) {\n            await triggerResendOtp(email);\n          }\n          setLoading(false);\n          return;\n        }\n        closeModal();\n        router.push(redirectTo ?? \"/me\");\n        return;\n      }\n\n      const data = await res.json();\n      const onboardingDone = data?.profile?.onboardingDone;\n      // Atualiza SWR para refletir o novo estado de auth/profile imediatamente\n      swrMutate(\"/api/auth/me\");\n\n      // Sess√£o OK: limpa qualquer estado de verifica√ß√£o pendente para n√£o reabrir o passo verify\n      clearPendingVerification();\n\n      if (onboardingDone) {\n        closeModal();\n        router.push(redirectTo ?? \"/me\");\n      } else {\n        setMode(\"onboarding\");\n      }\n    } catch (err) {\n      console.error(\"finishAuthAndMaybeOnboard error\", err);\n      closeModal();\n      router.push(redirectTo ?? \"/me\");\n    }\n  }\n\n  async function handleLogin() {\n    setError(null);\n    setLoading(true);\n\n    const identifier = (email || \"\").trim().toLowerCase();\n\n    if (!identifier || !password) {\n      setError(\"Preenche o email/username e a password.\");\n      setLoading(false);\n      return;\n    }\n\n    let emailToUse = identifier;\n    if (!identifier.includes(\"@\")) {\n      const res = await fetch(\"/api/auth/resolve-identifier\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ identifier }),\n      });\n      const data = await res.json().catch(() => null);\n      if (!res.ok || !data?.ok || !data?.email) {\n        setError(\"Credenciais inv√°lidas. Confirma username/email e password.\");\n        setLoading(false);\n        return;\n      }\n      emailToUse = data.email;\n    }\n\n    const { error: loginError } = await supabaseBrowser.auth.signInWithPassword({\n      email: emailToUse,\n      password,\n    });\n\n    if (loginError) {\n      const message = loginError.message || \"\";\n      if (isUnconfirmedError(loginError)) {\n        if (typeof window !== \"undefined\") {\n          window.localStorage.setItem(\"orya_pending_email\", emailToUse);\n          window.localStorage.setItem(\"orya_pending_step\", \"verify\");\n        }\n        setMode(\"verify\");\n        setEmail(emailToUse);\n        setError(\"Email ainda n√£o confirmado. Reenviei-te um novo c√≥digo.\");\n        await triggerResendOtp(emailToUse);\n      } else {\n        setError(message || \"N√£o foi poss√≠vel iniciar sess√£o.\");\n      }\n      setLoading(false);\n      return;\n    }\n\n    await syncSessionWithServer();\n    clearPendingVerification();\n    await finishAuthAndMaybeOnboard();\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    if (signupCooldown <= 0) return;\n    const t = setInterval(() => {\n      setSignupCooldown((prev) => (prev > 0 ? prev - 1 : 0));\n    }, 1000);\n    return () => clearInterval(t);\n  }, [signupCooldown]);\n\n  useEffect(() => {\n    if (otpCooldown <= 0) return;\n    const t = setInterval(() => {\n      setOtpCooldown((prev) => (prev > 0 ? prev - 1 : 0));\n    }, 1000);\n    return () => clearInterval(t);\n  }, [otpCooldown]);\n\n  async function handleSignup() {\n    setError(null);\n    setLoading(true);\n    setLoginOtpSent(false);\n\n    const emailToUse = (email || \"\").trim().toLowerCase();\n\n    if (!emailToUse || !password || !confirmPassword) {\n      setError(\"Preenche o email e ambas as passwords.\");\n      setLoading(false);\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      setError(\"As passwords n√£o coincidem.\");\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const res = await fetch(\"/api/auth/send-otp\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email: emailToUse, password }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error ?? \"N√£o foi poss√≠vel enviar o c√≥digo.\");\n        setLoading(false);\n        return;\n      }\n      if (typeof window !== \"undefined\") {\n        window.localStorage.setItem(\"orya_pending_email\", emailToUse);\n        window.localStorage.setItem(\"orya_pending_step\", \"verify\");\n        window.localStorage.setItem(\"orya_otp_last_sent_at\", String(Date.now()));\n      }\n      setOtpCooldown(RESEND_COOLDOWN);\n      setEmail(emailToUse);\n      setMode(\"verify\");\n    } catch (err) {\n      console.warn(\"[AuthModal] Falhou envio de OTP custom:\", err);\n      setError(\"N√£o foi poss√≠vel enviar o c√≥digo. Tenta novamente dentro de alguns minutos.\");\n      setMode(\"signup\");\n      setLoading(false);\n      return;\n    }\n\n    setLoading(false);\n  }\n\n  async function handleVerify() {\n    setError(null);\n    setLoading(true);\n\n    const emailToUse = (email || \"\").trim().toLowerCase();\n\n    if (!emailToUse) {\n      setError(\"Email em falta. Volta atr√°s e inicia sess√£o novamente.\");\n      setLoading(false);\n      return;\n    }\n\n    const cleanOtp = otp.trim();\n    if (!cleanOtp || cleanOtp.length < 6) {\n      setError(\"Introduce o c√≥digo completo (6-8 d√≠gitos).\");\n      setLoading(false);\n      return;\n    }\n\n    const { error: verifyError } = await supabaseBrowser.auth.verifyOtp({\n      type: \"signup\",\n      email: emailToUse,\n      token: cleanOtp,\n    });\n\n    if (verifyError) {\n      const message = verifyError.message || \"C√≥digo inv√°lido ou expirado. Verifica o email ou pede novo c√≥digo.\";\n      setError(message);\n      setOtpCooldown(0);\n      setLoading(false);\n      return;\n    }\n\n    await syncSessionWithServer();\n    swrMutate(\"/api/auth/me\");\n    if (typeof window !== \"undefined\") {\n      clearPendingVerification();\n    }\n    await finishAuthAndMaybeOnboard();\n    setLoading(false);\n  }\n\n  async function handleOnboardingSave() {\n    setError(null);\n    setLoading(true);\n\n    try {\n      const usernameClean = username.replace(/[^A-Za-z]/g, \"\").slice(0, 16).trim();\n      if (!usernameClean) {\n        setError(\"O username s√≥ pode ter letras (sem espa√ßos, n√∫meros ou s√≠mbolos).\");\n        setLoading(false);\n        return;\n      }\n      if (usernameClean.length > 16) {\n        setError(\"O username pode ter no m√°ximo 16 letras.\");\n        setLoading(false);\n        return;\n      }\n\n      const res = await fetch(\"/api/profiles/save-basic\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          fullName: fullName.trim() || null,\n          username: usernameClean,\n        }),\n      });\n\n      const data = await res.json().catch(() => null);\n\n      if (!res.ok || (data && data.ok === false)) {\n        const msg = data?.error || \"N√£o foi poss√≠vel guardar o perfil.\";\n        setError(msg);\n        setLoading(false);\n        return;\n      }\n\n      // Atualizar cache do utilizador para refletir onboardingDone=true (evita reabrir modal)\n      swrMutate(\"/api/auth/me\", (curr: unknown) => {\n        const prev = curr as\n          | { user?: unknown; profile?: { onboardingDone?: boolean } }\n          | undefined;\n        if (prev?.profile) {\n          return {\n            ...prev,\n            profile: { ...prev.profile, onboardingDone: true },\n          };\n        }\n        return prev;\n      }, false);\n      closeModal();\n      router.push(redirectTo ?? \"/me\");\n      setLoading(false);\n    } catch (err) {\n      console.error(\"handleOnboardingSave error\", err);\n      setError(\"Ocorreu um erro ao guardar o perfil.\");\n      setLoading(false);\n    }\n  }\n\n  const isLogin = mode === \"login\";\n  const isSignup = mode === \"signup\";\n\n  const title =\n    mode === \"login\"\n      ? \"Entrar na ORYA\"\n      : mode === \"signup\"\n      ? \"Criar conta na ORYA\"\n      : mode === \"verify\"\n      ? \"Confirmar email\"\n      : \"Completar perfil\";\n\n  const subtitle =\n    mode === \"login\"\n      ? \"Acede √† tua conta e continua onde ficaste.\"\n      : mode === \"signup\"\n      ? \"Demora segundos. Depois √© s√≥ viver eventos.\"\n      : mode === \"verify\"\n      ? \"Valida o c√≥digo que envi√°mos para o teu email.\"\n      : \"S√≥ falta isto para ficares pronto.\";\n\n\n  const isPrimaryDisabled =\n    loading ||\n    ((mode === \"login\" || mode === \"signup\") && (!email || !password)) ||\n    (mode === \"signup\" && (password !== confirmPassword || !confirmPassword)) ||\n    (mode === \"signup\" && isSignupBlocked) ||\n    (mode === \"verify\" && (!email || otp.trim().length < 6)) ||\n    (mode === \"onboarding\" &&\n      (!username.replace(/[^A-Za-z]/g, \"\").trim() ||\n        username.replace(/[^A-Za-z]/g, \"\").length > 16));\n\n  const handleClose = () => {\n    hardResetAuthState();\n    closeModal();\n    router.push(redirectTo ?? \"/\");\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-xl\">\n      <div\n        ref={modalRef}\n        className=\"w-full max-w-md rounded-3xl border border-white/15 bg-black/80 p-6 shadow-xl\"\n      >\n        <div className=\"mb-4 space-y-2\">\n          <div className=\"space-y-1\">\n            <h2 className=\"text-2xl font-semibold text-white leading-tight\">{title}</h2>\n            <p className=\"text-sm text-white/70\">{subtitle}</p>\n          </div>\n\n          {(isLogin || isSignup) && (\n            <div className=\"mt-3 grid grid-cols-2 gap-1 rounded-full bg-white/5 p-1 text-sm text-white/80\">\n              <button\n                type=\"button\"\n                onClick={() => setMode(\"login\")}\n                className={`rounded-full px-3 py-2 transition ${\n                  isLogin\n                    ? \"bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] text-black shadow-[0_0_16px_rgba(107,255,255,0.35)]\"\n                    : \"hover:bg-white/10\"\n                }`}\n              >\n                Entrar\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setMode(\"signup\")}\n                className={`rounded-full px-3 py-2 transition ${\n                  isSignup\n                    ? \"bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] text-black shadow-[0_0_16px_rgba(107,255,255,0.35)]\"\n                    : \"hover:bg-white/10\"\n                }`}\n              >\n                Criar conta\n              </button>\n            </div>\n          )}\n        </div>\n\n        {(mode === \"login\" || mode === \"signup\") && (\n          <>\n            <label className=\"block text-xs text-white/70 mb-1\">Email ou username</label>\n            <input\n              type=\"text\"\n              value={email ?? \"\"}\n              onChange={(e) => {\n                setEmail(e.target.value);\n                setError(null);\n              }}\n              className=\"w-full rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white outline-none focus:border-[#6BFFFF] focus:ring-1 focus:ring-[#6BFFFF]\"\n              placeholder=\"nome@exemplo.com ou @username\"\n            />\n\n            <label className=\"mt-3 block text-xs text-white/70 mb-1\">\n              Palavra-passe\n            </label>\n            <div className=\"flex items-center rounded-xl border border-white/15 bg-white/5 px-3 py-2\">\n              <input\n                type={showPassword ? \"text\" : \"password\"}\n                value={password}\n                onChange={(e) => {\n                  setPassword(e.target.value);\n                  setError(null);\n                }}\n                className=\"flex-1 bg-transparent text-sm text-white outline-none\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword((v) => !v)}\n                className=\"text-[11px] text-white/70 hover:text-white\"\n              >\n                {showPassword ? \"Ocultar\" : \"Mostrar\"}\n              </button>\n            </div>\n\n            {mode === \"login\" && (\n              <div className=\"mt-2 flex items-center justify-between text-[11px] text-white/65\">\n                <button\n                  type=\"button\"\n                  onClick={handleResetPassword}\n                  disabled={loginOtpSending}\n                  className=\"text-[11px] text-white/70 hover:text-white disabled:opacity-60\"\n                >\n                  {loginOtpSending ? \"A enviar recupera√ß√£o‚Ä¶\" : \"Esqueceste a password?\"}\n                </button>\n                {loginOtpSent && (\n                  <span className=\"text-emerald-300 text-[11px]\">Email enviado.</span>\n                )}\n              </div>\n            )}\n\n            {mode === \"signup\" && (\n              <>\n                <label className=\"mt-3 block text-xs text-white/70 mb-1\">\n                  Confirmar palavra-passe\n                </label>\n                <div className=\"flex items-center rounded-xl border border-white/15 bg-white/5 px-3 py-2\">\n                  <input\n                    type={showConfirmPassword ? \"text\" : \"password\"}\n                    value={confirmPassword}\n                    onChange={(e) => {\n                      setConfirmPassword(e.target.value);\n                      setError(null);\n                    }}\n                    className=\"flex-1 bg-transparent text-sm text-white outline-none\"\n                    placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowConfirmPassword((v) => !v)}\n                    className=\"text-[11px] text-white/70 hover:text-white\"\n                  >\n                    {showConfirmPassword ? \"Ocultar\" : \"Mostrar\"}\n                  </button>\n                </div>\n              </>\n            )}\n\n            {showGoogle && (\n              <button\n                type=\"button\"\n                disabled={loading}\n                onClick={async () => {\n                  setError(null);\n                  setLoading(true);\n                  try {\n                    const redirect =\n                      typeof window !== \"undefined\"\n                        ? `${window.location.origin}/auth/callback?redirect=${encodeURIComponent(\n                            redirectTo ?? window.location.href,\n                          )}`\n                        : undefined;\n                    if (typeof window !== \"undefined\") {\n                      try {\n                        window.localStorage.setItem(\n                          \"orya_post_auth_redirect\",\n                          redirectTo ?? window.location.href,\n                        );\n                      } catch {}\n                    }\n                    const { error: oauthError } =\n                      await supabaseBrowser.auth.signInWithOAuth({\n                        provider: \"google\",\n                        options: { redirectTo: redirect },\n                      });\n                    if (oauthError) {\n                      setError(\n                        oauthError.message ??\n                          \"N√£o foi poss√≠vel iniciar sess√£o com Google.\",\n                      );\n                    }\n                  } catch (err) {\n                    console.error(\"[AuthModal] Google OAuth error:\", err);\n                    setError(\n                      \"N√£o foi poss√≠vel iniciar sess√£o com Google. Tenta novamente.\",\n                    );\n                  } finally {\n                    setLoading(false);\n                  }\n                }}\n                className=\"mt-3 inline-flex w-full items-center justify-center gap-2 rounded-full border border-white/20 bg-white/5 px-4 py-2 text-sm font-semibold text-white shadow hover:border-white/40 hover:bg-white/10 transition-colors disabled:opacity-50\"\n              >\n                Continuar com Google\n              </button>\n            )}\n\n            <p className=\"mt-2 text-[10px] text-white/50 leading-snug\">\n              Ao continuar, aceitas os termos da ORYA.\n            </p>\n          </>\n        )}\n\n        {mode === \"verify\" && (\n          <>\n            <p className=\"text-sm text-white/80 mb-2\">\n              Envi√°mos um c√≥digo de confirma√ß√£o para <strong>{email}</strong>.\n            </p>\n            <label className=\"block text-xs text-white/70 mb-1\">C√≥digo</label>\n            <input\n              type=\"text\"\n              maxLength={8}\n              value={otp}\n              onChange={(e) => setOtp(e.target.value)}\n              className=\"w-full rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white outline-none focus:border-[#6BFFFF] focus:ring-1 focus:ring-[#6BFFFF]\"\n              placeholder=\"Insere o c√≥digo de 6 d√≠gitos\"\n            />\n            <div className=\"mt-2 flex items-center justify-between text-[12px] text-white/65\">\n              <span>\n                N√£o chegou?{\" \"}\n                {otpCooldown > 0 ? (\n                  <span className=\"text-white/75\">Podes reenviar em {otpCooldown}s.</span>\n                ) : (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      if (email) triggerResendOtp(email);\n                    }}\n                    disabled={!email || otpResending}\n                    className=\"text-[#6BFFFF] hover:text-white transition disabled:opacity-50\"\n                  >\n                    Reenviar c√≥digo\n                  </button>\n                )}\n              </span>\n              {otpResending && <span className=\"text-[11px] text-white/50\">A enviar‚Ä¶</span>}\n            </div>\n            <div className=\"mt-2 flex items-center justify-between text-[12px] text-white/65\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  hardResetAuthState();\n                  setMode(\"login\");\n                }}\n                className=\"text-[#6BFFFF] hover:text-white transition\"\n              >\n                Usar outro email\n              </button>\n            </div>\n          </>\n        )}\n\n        {mode === \"onboarding\" && (\n          <>\n            <p className=\"text-sm text-white/75 mb-3\">\n              Bem-vindo(a)! S√≥ faltam estes dados para conclu√≠res o teu perfil.\n            </p>\n\n            <label className=\"block text-xs text-white/70 mb-1\">\n              Nome completo\n            </label>\n            <input\n              type=\"text\"\n              value={fullName}\n              onChange={(e) => setFullName(e.target.value)}\n              className=\"w-full rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white outline-none focus:border-[#6BFFFF] focus:ring-1 focus:ring-[#6BFFFF]\"\n              placeholder=\"Ex.: In√™s Martins\"\n            />\n\n            <label className=\"mt-3 block text-xs text-white/70 mb-1\">\n              Username p√∫blico\n            </label>\n              <div className=\"flex items-center rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white\">\n                <span className=\"text-white/40 mr-1\">@</span>\n                <input\n                  type=\"text\"\n                  inputMode=\"text\"\n                  pattern=\"[A-Za-z]{0,16}\"\n                  value={username}\n                  maxLength={16}\n                  onChange={(e) =>\n                    {\n                      const raw = e.target.value;\n                      const cleaned = raw.replace(/[^A-Za-z]/g, \"\").slice(0, 16);\n                      if (raw !== cleaned) {\n                        e.target.value = cleaned;\n                      }\n                      setUsername(cleaned);\n                      setUsernameHint(raw !== cleaned ? \"S√≥ letras A-Z, sem espa√ßos, m√°ximo 16.\" : null);\n                    }\n                  }\n                  className=\"flex-1 bg-transparent outline-none\"\n                  placeholder=\"inesmartins\"\n                />\n              </div>\n              {usernameHint && (\n                <p className=\"mt-1 text-[10px] text-amber-300/90\">{usernameHint}</p>\n              )}\n\n            <p className=\"mt-1 text-[10px] text-white/45 leading-snug\">\n              Podes alterar estes dados depois nas defini√ß√µes.\n            </p>\n          </>\n        )}\n\n        {error && (\n          <div className=\"mt-3 space-y-2\">\n            <p className=\"text-[12px] text-red-300 leading-snug\">{error}</p>\n            {mode === \"signup\" && error.toLowerCase().includes(\"j√° tem conta\") && (\n              <div className=\"space-y-2 text-[12px] text-white/75\">\n                <button\n                  type=\"button\"\n                  onClick={() => setMode(\"login\")}\n                  className=\"w-full rounded-full border border-white/15 bg-white/5 px-3 py-2 text-white hover:bg-white/10 transition\"\n                >\n                  Ir para login\n                </button>\n                <button\n                  type=\"button\"\n                  disabled={loginOtpSending}\n                  onClick={handleLoginOtp}\n                  className=\"w-full rounded-full border border-white/15 bg-white/5 px-3 py-2 text-white hover:bg-white/10 transition disabled:opacity-50\"\n                >\n                  {loginOtpSending ? \"A enviar link de login‚Ä¶\" : \"Enviar link de login por email\"}\n                </button>\n                <button\n                  type=\"button\"\n                  disabled={loginOtpSending}\n                  onClick={handleResetPassword}\n                  className=\"w-full rounded-full border border-white/15 bg-white/5 px-3 py-2 text-white hover:bg-white/10 transition disabled:opacity-50\"\n                >\n                  {loginOtpSending ? \"A enviar recupera√ß√£o‚Ä¶\" : \"Recuperar password\"}\n                </button>\n                {loginOtpSent && (\n                  <p className=\"text-emerald-300 text-[11px]\">\n                    Verifica o teu email para redefinir a password.\n                  </p>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        {mode === \"signup\" && isSignupBlocked && (\n          <p className=\"mt-2 text-[11px] text-white/60\">\n            Aguardar {signupCooldown}s para tentar novamente.\n          </p>\n        )}\n\n        <div className=\"mt-5 flex flex-col gap-2\">\n          {(mode === \"login\" || mode === \"signup\") && (\n            <button\n              type=\"button\"\n              disabled={isPrimaryDisabled}\n              onClick={mode === \"login\" ? handleLogin : handleSignup}\n              className=\"inline-flex w-full items-center justify-center rounded-full bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] px-4 py-2.5 text-[13px] font-semibold text-black shadow-[0_0_26px_rgba(107,255,255,0.55)] disabled:opacity-50\"\n            >\n              {loading\n                ? \"A processar‚Ä¶\"\n                : mode === \"login\"\n                ? \"Entrar\"\n                : \"Criar conta\"}\n            </button>\n          )}\n\n          {mode === \"verify\" && (\n            <button\n              type=\"button\"\n              disabled={isPrimaryDisabled}\n              onClick={handleVerify}\n              className=\"inline-flex w-full items-center justify-center rounded-full bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] px-4 py-2.5 text-[13px] font-semibold text-black shadow-[0_0_26px_rgba(107,255,255,0.55)] disabled:opacity-50\"\n            >\n              {loading ? \"A validar‚Ä¶\" : \"Confirmar c√≥digo\"}\n            </button>\n          )}\n\n          {mode === \"onboarding\" && (\n            <button\n              type=\"button\"\n              disabled={isPrimaryDisabled}\n              onClick={handleOnboardingSave}\n              className=\"inline-flex w-full items-center justify-center rounded-full bg-gradient-to-r from-[#FF00C8] via-[#6BFFFF] to-[#1646F5] px-4 py-2.5 text-[13px] font-semibold text-black shadow-[0_0_26px_rgba(107,255,255,0.55)] disabled:opacity-50\"\n            >\n              {loading ? \"A guardar‚Ä¶\" : \"Guardar e continuar\"}\n            </button>\n          )}\n\n          <button\n            type=\"button\"\n            onClick={isOnboarding ? undefined : handleClose}\n            disabled={isOnboarding}\n            className=\"text-[11px] text-white/50 hover:text-white disabled:opacity-60\"\n          >\n            Fechar\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AASe,SAAS;;IACtB,MAAM,QAAQ,IAAA,6KAAY;IAE1B,IAAI,CAAC,MAAM,MAAM,EAAE,OAAO;IAE1B,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,CAAC,EAAE,MAAM,UAAU,IAAI,QAAQ;IAE9D,qBAAO,6LAAC;QAAiC,GAAG,KAAK;OAAnB;;;;;AAChC;GARwB;;QACR,6KAAY;;;KADJ;AAYxB,SAAS,iBAAiB,EACxB,IAAI,EACJ,KAAK,EACL,QAAQ,EACR,UAAU,EACV,OAAO,EACP,UAAU,EACV,UAAU,EACY;;IACtB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAC/B,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAgB;IAEhE,MAAM,kBAAkB;IACxB,MAAM,kBAAkB,iBAAiB;IACzC,MAAM,eAAe,SAAS;IAE9B,MAAM,WAAW,IAAA,uKAAM,EAAwB;IAE/C,SAAS;QACP,eAAe;QACf,OAAO;QACP,SAAS;QACT,wCAAmC;YACjC,IAAI;gBACF,OAAO,YAAY,CAAC,UAAU,CAAC;gBAC/B,OAAO,YAAY,CAAC,UAAU,CAAC;gBAC/B,OAAO,YAAY,CAAC,UAAU,CAAC;YACjC,EAAE,OAAM;YACN,UAAU,GACZ;QACF;IACF;IACA,SAAS;QACP;QACA,SAAS;QACT,YAAY;QACZ,mBAAmB;QACnB,OAAO;QACP,gBAAgB;QAChB,mBAAmB;QACnB,gBAAgB;QAChB,SAAS;QACT,QAAQ;IACV;IAEA,SAAS,mBAAmB,GAAY;QACtC,IAAI,CAAC,KAAK,OAAO;QACjB,MAAM,SAAS;QACf,MAAM,MAAM,CAAC,OAAO,OAAO,IAAI,OAAO,iBAAiB,IAAI,EAAE,EAAE,WAAW;QAC1E,IAAI,CAAC,KAAK,OAAO;QACjB,OACE,IAAI,QAAQ,CAAC,oBACb,IAAI,QAAQ,CAAC,yBACb,IAAI,QAAQ,CAAC;IAEjB;IAEA,IAAA,0KAAS;sCAAC;YACR,SAAS,mBAAmB,CAAa;gBACvC,IACE,SAAS,OAAO,IAChB,CAAC,SAAS,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,KACnC,CAAC,cACD;oBACA;gBACF;YACF;YAEA,SAAS,gBAAgB,CAAC,aAAa;YACvC;8CAAO;oBACL,SAAS,mBAAmB,CAAC,aAAa;gBAC5C;;QACF;qCAAG;QAAC;QAAY;KAAa;IAE7B,sCAAsC;IACtC,IAAA,0KAAS;sCAAC;YACR;;YACA,IAAI;gBACF,MAAM,eAAe,OAAO,YAAY,CAAC,OAAO,CAAC;gBACjD,MAAM,cAAc,OAAO,YAAY,CAAC,OAAO,CAAC;gBAChD,MAAM,UAAU,OAAO,OAAO,YAAY,CAAC,OAAO,CAAC,4BAA4B;gBAC/E,MAAM,UAAU,UAAU,KAAK,KAAK,CAAC,CAAC,KAAK,GAAG,KAAK,OAAO,IAAI,QAAQ;gBACtE,MAAM,YAAY,KAAK,GAAG,CAAC,GAAG,kBAAkB;gBAChD,IAAI,gBAAgB,CAAC,OAAO,SAAS;gBACrC,IAAI,gBAAgB,UAAU;oBAC5B,QAAQ;oBACR,IAAI,YAAY,GAAG,eAAe;gBACpC;YACF,EAAE,OAAM;YACN,UAAU,GACZ;QACF;qCAAG;QAAC;QAAO;QAAU;KAAQ;IAE7B,oFAAoF;IACpF,2EAA2E;IAC3E,IAAA,0KAAS;sCAAC;YACR,IAAI,SAAS,UAAU;YACvB,IAAI,gBAAgB,GAAG;gBACrB,eAAe;gBACf,wCAAmC;oBACjC,OAAO,YAAY,CAAC,OAAO,CAAC,yBAAyB,OAAO,KAAK,GAAG;gBACtE;YACF;YACA,IAAI,YAAY;YAChB;8CAAC;oBACC,IAAI;wBACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,4IAAe,CAAC,IAAI,CAAC,OAAO;wBACnD,MAAM,WAAW,AAAC,MAAM,QAAwB;wBAChD,MAAM,YACJ,QAAQ,UAAU,uBAClB,QAAS,UAAyD,oBAClE;wBACF,IAAI,aAAa,CAAC,WAAW;4BAC3B;4BACA,SAAS;4BACT;wBACF;oBACF,EAAE,OAAM;oBACN,UAAU,GACZ;gBACF;aAAC;YACD;8CAAO;oBACL,YAAY;gBACd;;QACF;qCAAG;QAAC;QAAM;KAAW;IAErB,eAAe;QACb,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,4IAAe,CAAC,IAAI,CAAC,UAAU;YACtD,MAAM,eAAe,KAAK,OAAO,EAAE;YACnC,MAAM,gBAAgB,KAAK,OAAO,EAAE;YACpC,IAAI,CAAC,gBAAgB,CAAC,eAAe;YACrC,MAAM,MAAM,qBAAqB;gBAC/B,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAc;gBAAc;gBACnD,aAAa;YACf;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,IAAI,CAAC,gCAAgC;QAC/C;IACF;IAEA,eAAe;QACb,IAAI,CAAC,OAAO;YACV,SAAS;YACT;QACF;QACA,mBAAmB;QACnB,SAAS;QACT,gBAAgB;QAChB,IAAI;YACF,MAAM,WACJ,uCACI,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC,GACzC;YACN,MAAM,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,4IAAe,CAAC,IAAI,CAAC,aAAa,CAAC;gBACjE;gBACA,SAAS;oBAAE,iBAAiB;gBAAS;YACvC;YACA,IAAI,QAAQ;gBACV,SAAS,OAAO,OAAO,IAAI;gBAC3B,mBAAmB;gBACnB;YACF;YACA,gBAAgB;QAClB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,gCAAgC;YAC9C,SAAS;QACX,SAAU;YACR,mBAAmB;QACrB;IACF;IAEA,eAAe;QACb,IAAI,CAAC,OAAO;YACV,SAAS;YACT;QACF;QACA,mBAAmB;QACnB,SAAS;QACT,gBAAgB;QAChB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,oCAAoC;gBAC1D,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAM;YAC/B;YACA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;YAC1C,IAAI,CAAC,IAAI,EAAE,IAAI,MAAM,OAAO,OAAO;gBACjC,SAAS,MAAM,SAAS;gBACxB,mBAAmB;gBACnB;YACF;YACA,gBAAgB;QAClB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,qCAAqC;YACnD,SAAS;QACX,SAAU;YACR,mBAAmB;QACrB;IACF;IAEA,eAAe,iBAAiB,UAAkB;QAChD,SAAS;QACT,gBAAgB;QAEhB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,wBAAwB;gBAC9C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,OAAO;gBAAW;YAC3C;YACA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;YAC1C,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,SAAS,MAAM,SAAS;gBACxB,eAAe;YACjB,OAAO;gBACL,gBAAgB;gBAChB,eAAe;gBACf,wCAAmC;oBACjC,OAAO,YAAY,CAAC,OAAO,CAAC,yBAAyB,OAAO,KAAK,GAAG;oBACpE,OAAO,YAAY,CAAC,OAAO,CAAC,sBAAsB;oBAClD,OAAO,YAAY,CAAC,OAAO,CAAC,qBAAqB;gBACnD;YACF;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,0BAA0B;YACxC,SAAS;YACT,eAAe;QACjB,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,eAAe;QACb,IAAI;YACF,8EAA8E;YAC9E,MAAM;YAEN,MAAM,MAAM,MAAM,MAAM,gBAAgB;gBACtC,QAAQ;gBACR,aAAa;YACf;YAEA,iEAAiE;YACjE,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;gBAC1C,MAAM,yBAAyB,MAAM;gBACrC,IAAI,wBAAwB;oBAC1B,IAAI,+CAAkB,eAAe,OAAO;wBAC1C,OAAO,YAAY,CAAC,OAAO,CAAC,sBAAsB;wBAClD,OAAO,YAAY,CAAC,OAAO,CAAC,qBAAqB;oBACnD;oBACA,QAAQ;oBACR,IAAI,OAAO;wBACT,MAAM,iBAAiB;oBACzB;oBACA,WAAW;oBACX;gBACF;gBACA;gBACA,OAAO,IAAI,CAAC,cAAc;gBAC1B;YACF;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,iBAAiB,MAAM,SAAS;YACtC,yEAAyE;YACzE,IAAA,gOAAS,EAAC;YAEV,2FAA2F;YAC3F;YAEA,IAAI,gBAAgB;gBAClB;gBACA,OAAO,IAAI,CAAC,cAAc;YAC5B,OAAO;gBACL,QAAQ;YACV;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,mCAAmC;YACjD;YACA,OAAO,IAAI,CAAC,cAAc;QAC5B;IACF;IAEA,eAAe;QACb,SAAS;QACT,WAAW;QAEX,MAAM,aAAa,CAAC,SAAS,EAAE,EAAE,IAAI,GAAG,WAAW;QAEnD,IAAI,CAAC,cAAc,CAAC,UAAU;YAC5B,SAAS;YACT,WAAW;YACX;QACF;QAEA,IAAI,aAAa;QACjB,IAAI,CAAC,WAAW,QAAQ,CAAC,MAAM;YAC7B,MAAM,MAAM,MAAM,MAAM,gCAAgC;gBACtD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAW;YACpC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;YAC1C,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,MAAM,CAAC,MAAM,OAAO;gBACxC,SAAS;gBACT,WAAW;gBACX;YACF;YACA,aAAa,KAAK,KAAK;QACzB;QAEA,MAAM,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,4IAAe,CAAC,IAAI,CAAC,kBAAkB,CAAC;YAC1E,OAAO;YACP;QACF;QAEA,IAAI,YAAY;YACd,MAAM,UAAU,WAAW,OAAO,IAAI;YACtC,IAAI,mBAAmB,aAAa;gBAClC,wCAAmC;oBACjC,OAAO,YAAY,CAAC,OAAO,CAAC,sBAAsB;oBAClD,OAAO,YAAY,CAAC,OAAO,CAAC,qBAAqB;gBACnD;gBACA,QAAQ;gBACR,SAAS;gBACT,SAAS;gBACT,MAAM,iBAAiB;YACzB,OAAO;gBACL,SAAS,WAAW;YACtB;YACA,WAAW;YACX;QACF;QAEA,MAAM;QACN;QACA,MAAM;QACN,WAAW;IACb;IAEA,IAAA,0KAAS;sCAAC;YACR,IAAI,kBAAkB,GAAG;YACzB,MAAM,IAAI;gDAAY;oBACpB;wDAAkB,CAAC,OAAU,OAAO,IAAI,OAAO,IAAI;;gBACrD;+CAAG;YACH;8CAAO,IAAM,cAAc;;QAC7B;qCAAG;QAAC;KAAe;IAEnB,IAAA,0KAAS;sCAAC;YACR,IAAI,eAAe,GAAG;YACtB,MAAM,IAAI;gDAAY;oBACpB;wDAAe,CAAC,OAAU,OAAO,IAAI,OAAO,IAAI;;gBAClD;+CAAG;YACH;8CAAO,IAAM,cAAc;;QAC7B;qCAAG;QAAC;KAAY;IAEhB,eAAe;QACb,SAAS;QACT,WAAW;QACX,gBAAgB;QAEhB,MAAM,aAAa,CAAC,SAAS,EAAE,EAAE,IAAI,GAAG,WAAW;QAEnD,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,iBAAiB;YAChD,SAAS;YACT,WAAW;YACX;QACF;QAEA,IAAI,aAAa,iBAAiB;YAChC,SAAS;YACT,WAAW;YACX;QACF;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,sBAAsB;gBAC5C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,OAAO;oBAAY;gBAAS;YACrD;YACA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;YAC1C,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,IAAI;gBACxB,SAAS,MAAM,SAAS;gBACxB,WAAW;gBACX;YACF;YACA,wCAAmC;gBACjC,OAAO,YAAY,CAAC,OAAO,CAAC,sBAAsB;gBAClD,OAAO,YAAY,CAAC,OAAO,CAAC,qBAAqB;gBACjD,OAAO,YAAY,CAAC,OAAO,CAAC,yBAAyB,OAAO,KAAK,GAAG;YACtE;YACA,eAAe;YACf,SAAS;YACT,QAAQ;QACV,EAAE,OAAO,KAAK;YACZ,QAAQ,IAAI,CAAC,2CAA2C;YACxD,SAAS;YACT,QAAQ;YACR,WAAW;YACX;QACF;QAEA,WAAW;IACb;IAEA,eAAe;QACb,SAAS;QACT,WAAW;QAEX,MAAM,aAAa,CAAC,SAAS,EAAE,EAAE,IAAI,GAAG,WAAW;QAEnD,IAAI,CAAC,YAAY;YACf,SAAS;YACT,WAAW;YACX;QACF;QAEA,MAAM,WAAW,IAAI,IAAI;QACzB,IAAI,CAAC,YAAY,SAAS,MAAM,GAAG,GAAG;YACpC,SAAS;YACT,WAAW;YACX;QACF;QAEA,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,4IAAe,CAAC,IAAI,CAAC,SAAS,CAAC;YAClE,MAAM;YACN,OAAO;YACP,OAAO;QACT;QAEA,IAAI,aAAa;YACf,MAAM,UAAU,YAAY,OAAO,IAAI;YACvC,SAAS;YACT,eAAe;YACf,WAAW;YACX;QACF;QAEA,MAAM;QACN,IAAA,gOAAS,EAAC;QACV,wCAAmC;YACjC;QACF;QACA,MAAM;QACN,WAAW;IACb;IAEA,eAAe;QACb,SAAS;QACT,WAAW;QAEX,IAAI;YACF,MAAM,gBAAgB,SAAS,OAAO,CAAC,cAAc,IAAI,KAAK,CAAC,GAAG,IAAI,IAAI;YAC1E,IAAI,CAAC,eAAe;gBAClB,SAAS;gBACT,WAAW;gBACX;YACF;YACA,IAAI,cAAc,MAAM,GAAG,IAAI;gBAC7B,SAAS;gBACT,WAAW;gBACX;YACF;YAEA,MAAM,MAAM,MAAM,MAAM,4BAA4B;gBAClD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,UAAU,SAAS,IAAI,MAAM;oBAC7B,UAAU;gBACZ;YACF;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;YAE1C,IAAI,CAAC,IAAI,EAAE,IAAK,QAAQ,KAAK,EAAE,KAAK,OAAQ;gBAC1C,MAAM,MAAM,MAAM,SAAS;gBAC3B,SAAS;gBACT,WAAW;gBACX;YACF;YAEA,wFAAwF;YACxF,IAAA,gOAAS,EAAC,gBAAgB,CAAC;gBACzB,MAAM,OAAO;gBAGb,IAAI,MAAM,SAAS;oBACjB,OAAO;wBACL,GAAG,IAAI;wBACP,SAAS;4BAAE,GAAG,KAAK,OAAO;4BAAE,gBAAgB;wBAAK;oBACnD;gBACF;gBACA,OAAO;YACT,GAAG;YACH;YACA,OAAO,IAAI,CAAC,cAAc;YAC1B,WAAW;QACb,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,SAAS;YACT,WAAW;QACb;IACF;IAEA,MAAM,UAAU,SAAS;IACzB,MAAM,WAAW,SAAS;IAE1B,MAAM,QACJ,SAAS,UACL,mBACA,SAAS,WACT,wBACA,SAAS,WACT,oBACA;IAEN,MAAM,WACJ,SAAS,UACL,+CACA,SAAS,WACT,gDACA,SAAS,WACT,mDACA;IAGN,MAAM,oBACJ,WACC,CAAC,SAAS,WAAW,SAAS,QAAQ,KAAK,CAAC,CAAC,SAAS,CAAC,QAAQ,KAC/D,SAAS,YAAY,CAAC,aAAa,mBAAmB,CAAC,eAAe,KACtE,SAAS,YAAY,mBACrB,SAAS,YAAY,CAAC,CAAC,SAAS,IAAI,IAAI,GAAG,MAAM,GAAG,CAAC,KACrD,SAAS,gBACR,CAAC,CAAC,SAAS,OAAO,CAAC,cAAc,IAAI,IAAI,MACvC,SAAS,OAAO,CAAC,cAAc,IAAI,MAAM,GAAG,EAAE;IAEpD,MAAM,cAAc;QAClB;QACA;QACA,OAAO,IAAI,CAAC,cAAc;IAC5B;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,KAAK;YACL,WAAU;;8BAEV,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAG,WAAU;8CAAmD;;;;;;8CACjE,6LAAC;oCAAE,WAAU;8CAAyB;;;;;;;;;;;;wBAGvC,CAAC,WAAW,QAAQ,mBACnB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS,IAAM,QAAQ;oCACvB,WAAW,CAAC,kCAAkC,EAC5C,UACI,mHACA,qBACJ;8CACH;;;;;;8CAGD,6LAAC;oCACC,MAAK;oCACL,SAAS,IAAM,QAAQ;oCACvB,WAAW,CAAC,kCAAkC,EAC5C,WACI,mHACA,qBACJ;8CACH;;;;;;;;;;;;;;;;;;gBAON,CAAC,SAAS,WAAW,SAAS,QAAQ,mBACrC;;sCACE,6LAAC;4BAAM,WAAU;sCAAmC;;;;;;sCACpD,6LAAC;4BACC,MAAK;4BACL,OAAO,SAAS;4BAChB,UAAU,CAAC;gCACT,SAAS,EAAE,MAAM,CAAC,KAAK;gCACvB,SAAS;4BACX;4BACA,WAAU;4BACV,aAAY;;;;;;sCAGd,6LAAC;4BAAM,WAAU;sCAAwC;;;;;;sCAGzD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAM,eAAe,SAAS;oCAC9B,OAAO;oCACP,UAAU,CAAC;wCACT,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC1B,SAAS;oCACX;oCACA,WAAU;oCACV,aAAY;;;;;;8CAEd,6LAAC;oCACC,MAAK;oCACL,SAAS,IAAM,gBAAgB,CAAC,IAAM,CAAC;oCACvC,WAAU;8CAET,eAAe,YAAY;;;;;;;;;;;;wBAI/B,SAAS,yBACR,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,UAAU;oCACV,WAAU;8CAET,kBAAkB,0BAA0B;;;;;;gCAE9C,8BACC,6LAAC;oCAAK,WAAU;8CAA+B;;;;;;;;;;;;wBAKpD,SAAS,0BACR;;8CACE,6LAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CACC,MAAM,sBAAsB,SAAS;4CACrC,OAAO;4CACP,UAAU,CAAC;gDACT,mBAAmB,EAAE,MAAM,CAAC,KAAK;gDACjC,SAAS;4CACX;4CACA,WAAU;4CACV,aAAY;;;;;;sDAEd,6LAAC;4CACC,MAAK;4CACL,SAAS,IAAM,uBAAuB,CAAC,IAAM,CAAC;4CAC9C,WAAU;sDAET,sBAAsB,YAAY;;;;;;;;;;;;;;wBAM1C,4BACC,6LAAC;4BACC,MAAK;4BACL,UAAU;4BACV,SAAS;gCACP,SAAS;gCACT,WAAW;gCACX,IAAI;oCACF,MAAM,WACJ,uCACI,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,wBAAwB,EAAE,mBAClD,cAAc,OAAO,QAAQ,CAAC,IAAI,GACjC,GACH;oCACN,wCAAmC;wCACjC,IAAI;4CACF,OAAO,YAAY,CAAC,OAAO,CACzB,2BACA,cAAc,OAAO,QAAQ,CAAC,IAAI;wCAEtC,EAAE,OAAM,CAAC;oCACX;oCACA,MAAM,EAAE,OAAO,UAAU,EAAE,GACzB,MAAM,4IAAe,CAAC,IAAI,CAAC,eAAe,CAAC;wCACzC,UAAU;wCACV,SAAS;4CAAE,YAAY;wCAAS;oCAClC;oCACF,IAAI,YAAY;wCACd,SACE,WAAW,OAAO,IAChB;oCAEN;gCACF,EAAE,OAAO,KAAK;oCACZ,QAAQ,KAAK,CAAC,mCAAmC;oCACjD,SACE;gCAEJ,SAAU;oCACR,WAAW;gCACb;4BACF;4BACA,WAAU;sCACX;;;;;;sCAKH,6LAAC;4BAAE,WAAU;sCAA8C;;;;;;;;gBAM9D,SAAS,0BACR;;sCACE,6LAAC;4BAAE,WAAU;;gCAA6B;8CACD,6LAAC;8CAAQ;;;;;;gCAAe;;;;;;;sCAEjE,6LAAC;4BAAM,WAAU;sCAAmC;;;;;;sCACpD,6LAAC;4BACC,MAAK;4BACL,WAAW;4BACX,OAAO;4BACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;4BACtC,WAAU;4BACV,aAAY;;;;;;sCAEd,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;wCAAK;wCACQ;wCACX,cAAc,kBACb,6LAAC;4CAAK,WAAU;;gDAAgB;gDAAmB;gDAAY;;;;;;iEAE/D,6LAAC;4CACC,MAAK;4CACL,SAAS;gDACP,IAAI,OAAO,iBAAiB;4CAC9B;4CACA,UAAU,CAAC,SAAS;4CACpB,WAAU;sDACX;;;;;;;;;;;;gCAKJ,8BAAgB,6LAAC;oCAAK,WAAU;8CAA4B;;;;;;;;;;;;sCAE/D,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCACC,MAAK;gCACL,SAAS;oCACP;oCACA,QAAQ;gCACV;gCACA,WAAU;0CACX;;;;;;;;;;;;;gBAON,SAAS,8BACR;;sCACE,6LAAC;4BAAE,WAAU;sCAA6B;;;;;;sCAI1C,6LAAC;4BAAM,WAAU;sCAAmC;;;;;;sCAGpD,6LAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;4BAC3C,WAAU;4BACV,aAAY;;;;;;sCAGd,6LAAC;4BAAM,WAAU;sCAAwC;;;;;;sCAGvD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAqB;;;;;;8CACrC,6LAAC;oCACC,MAAK;oCACL,WAAU;oCACV,SAAQ;oCACR,OAAO;oCACP,WAAW;oCACX,UAAU,CAAC;wCAEP,MAAM,MAAM,EAAE,MAAM,CAAC,KAAK;wCAC1B,MAAM,UAAU,IAAI,OAAO,CAAC,cAAc,IAAI,KAAK,CAAC,GAAG;wCACvD,IAAI,QAAQ,SAAS;4CACnB,EAAE,MAAM,CAAC,KAAK,GAAG;wCACnB;wCACA,YAAY;wCACZ,gBAAgB,QAAQ,UAAU,2CAA2C;oCAC/E;oCAEF,WAAU;oCACV,aAAY;;;;;;;;;;;;wBAGf,8BACC,6LAAC;4BAAE,WAAU;sCAAsC;;;;;;sCAGvD,6LAAC;4BAAE,WAAU;sCAA8C;;;;;;;;gBAM9D,uBACC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAE,WAAU;sCAAyC;;;;;;wBACrD,SAAS,YAAY,MAAM,WAAW,GAAG,QAAQ,CAAC,iCACjD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS,IAAM,QAAQ;oCACvB,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,MAAK;oCACL,UAAU;oCACV,SAAS;oCACT,WAAU;8CAET,kBAAkB,4BAA4B;;;;;;8CAEjD,6LAAC;oCACC,MAAK;oCACL,UAAU;oCACV,SAAS;oCACT,WAAU;8CAET,kBAAkB,0BAA0B;;;;;;gCAE9C,8BACC,6LAAC;oCAAE,WAAU;8CAA+B;;;;;;;;;;;;;;;;;;gBASrD,SAAS,YAAY,iCACpB,6LAAC;oBAAE,WAAU;;wBAAiC;wBAClC;wBAAe;;;;;;;8BAI7B,6LAAC;oBAAI,WAAU;;wBACZ,CAAC,SAAS,WAAW,SAAS,QAAQ,mBACrC,6LAAC;4BACC,MAAK;4BACL,UAAU;4BACV,SAAS,SAAS,UAAU,cAAc;4BAC1C,WAAU;sCAET,UACG,iBACA,SAAS,UACT,WACA;;;;;;wBAIP,SAAS,0BACR,6LAAC;4BACC,MAAK;4BACL,UAAU;4BACV,SAAS;4BACT,WAAU;sCAET,UAAU,eAAe;;;;;;wBAI7B,SAAS,8BACR,6LAAC;4BACC,MAAK;4BACL,UAAU;4BACV,SAAS;4BACT,WAAU;sCAET,UAAU,eAAe;;;;;;sCAI9B,6LAAC;4BACC,MAAK;4BACL,SAAS,eAAe,YAAY;4BACpC,UAAU;4BACV,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;IAv6BS;;QASQ,kJAAS;;;MATjB"}},
    {"offset": {"line": 3531, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/components/RecoveryRedirector.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\n\nexport function RecoveryRedirector() {\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const { hash, pathname, search } = window.location;\n    if (pathname === \"/reset-password\") return;\n\n    const params = new URLSearchParams(hash.replace(/^#/, \"\"));\n    const query = new URLSearchParams(search.replace(/^\\?/, \"\"));\n\n    const type = params.get(\"type\") || query.get(\"type\");\n    const hasRecoveryFlag = query.get(\"recovery\") === \"1\";\n    const hasToken =\n      params.has(\"access_token\") ||\n      params.has(\"token\") ||\n      params.has(\"code\") ||\n      params.has(\"refresh_token\");\n    const hasError =\n      params.has(\"error\") ||\n      params.has(\"error_code\") ||\n      params.has(\"error_description\");\n\n    // Redireciona para reset-password em qualquer cen√°rio de recupera√ß√£o (tokens ou erros)\n    if ((hasRecoveryFlag || type === \"recovery\") && (hasToken || hasError)) {\n      window.location.replace(`/reset-password${search}${hash}`);\n    } else if (hasError && hasToken) {\n      // fallback defensivo para hashes de recovery sem type/recovery flag\n      window.location.replace(`/reset-password${search}${hash}`);\n    }\n  }, []);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAIO,SAAS;;IACd,IAAA,0KAAS;wCAAC;YACR;;YACA,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,OAAO,QAAQ;YAClD,IAAI,aAAa,mBAAmB;YAEpC,MAAM,SAAS,IAAI,gBAAgB,KAAK,OAAO,CAAC,MAAM;YACtD,MAAM,QAAQ,IAAI,gBAAgB,OAAO,OAAO,CAAC,OAAO;YAExD,MAAM,OAAO,OAAO,GAAG,CAAC,WAAW,MAAM,GAAG,CAAC;YAC7C,MAAM,kBAAkB,MAAM,GAAG,CAAC,gBAAgB;YAClD,MAAM,WACJ,OAAO,GAAG,CAAC,mBACX,OAAO,GAAG,CAAC,YACX,OAAO,GAAG,CAAC,WACX,OAAO,GAAG,CAAC;YACb,MAAM,WACJ,OAAO,GAAG,CAAC,YACX,OAAO,GAAG,CAAC,iBACX,OAAO,GAAG,CAAC;YAEb,uFAAuF;YACvF,IAAI,CAAC,mBAAmB,SAAS,UAAU,KAAK,CAAC,YAAY,QAAQ,GAAG;gBACtE,OAAO,QAAQ,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,SAAS,MAAM;YAC3D,OAAO,IAAI,YAAY,UAAU;gBAC/B,oEAAoE;gBACpE,OAAO,QAAQ,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,SAAS,MAAM;YAC3D;QACF;uCAAG,EAAE;IAEL,OAAO;AACT;GA/BgB;KAAA"}}]
}