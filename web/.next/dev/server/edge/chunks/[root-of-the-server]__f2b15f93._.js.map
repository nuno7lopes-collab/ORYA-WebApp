{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["// Middleware para manter a sessão do Supabase fresca em cada request.\n// Não faz redirect nem proteção de rotas — apenas refresh de sessão.\nimport { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { createServerClient } from \"@supabase/ssr\";\n\nexport async function middleware(req: NextRequest) {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    return NextResponse.next();\n  }\n\n  const res = NextResponse.next({\n    request: {\n      headers: req.headers,\n    },\n  });\n  const orgParam = req.nextUrl.searchParams.get(\"org\") ?? req.nextUrl.searchParams.get(\"organizerId\");\n  if (orgParam && /^\\d+$/.test(orgParam)) {\n    res.cookies.set(\"orya_org\", orgParam, {\n      httpOnly: false,\n      sameSite: \"lax\",\n      path: \"/\",\n      maxAge: 60 * 60 * 24 * 30,\n    });\n  }\n\n  const supabase = createServerClient(supabaseUrl, supabaseAnonKey, {\n    cookies: {\n      get(name: string) {\n        const raw = req.cookies.get(name)?.value;\n        return raw ?? undefined;\n      },\n      set(name: string, value: string, options: Record<string, unknown>) {\n        res.cookies.set({ name, value, ...options });\n      },\n      remove(name: string, options: Record<string, unknown>) {\n        res.cookies.set({ name, value: \"\", ...options, maxAge: 0 });\n      },\n    },\n  });\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  // Auth wall para áreas privadas\n  const pathname = req.nextUrl.pathname;\n  const isProtected =\n    pathname.startsWith(\"/me\") ||\n    pathname.startsWith(\"/organizador\");\n\n  if (isProtected && !user) {\n    const loginUrl = new URL(\"/login\", req.url);\n    loginUrl.searchParams.set(\"redirectTo\", `${pathname}${req.nextUrl.search}`);\n    return NextResponse.redirect(loginUrl);\n  }\n\n  return res;\n}\n\nexport const config = {\n  matcher: [\"/me/:path*\", \"/organizador/:path*\"],\n};\n"],"names":[],"mappings":"AAAA,sEAAsE;AACtE,qEAAqE;;;;;;;AACrE;AAAA;AAEA;AAAA;;;AAEO,eAAe,WAAW,GAAgB;IAC/C,MAAM;IACN,MAAM;IAEN;;IAIA,MAAM,MAAM,gMAAY,CAAC,IAAI,CAAC;QAC5B,SAAS;YACP,SAAS,IAAI,OAAO;QACtB;IACF;IACA,MAAM,WAAW,IAAI,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,UAAU,IAAI,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;IACrF,IAAI,YAAY,QAAQ,IAAI,CAAC,WAAW;QACtC,IAAI,OAAO,CAAC,GAAG,CAAC,YAAY,UAAU;YACpC,UAAU;YACV,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;IACF;IAEA,MAAM,WAAW,IAAA,uMAAkB,EAAC,aAAa,iBAAiB;QAChE,SAAS;YACP,KAAI,IAAY;gBACd,MAAM,MAAM,IAAI,OAAO,CAAC,GAAG,CAAC,OAAO;gBACnC,OAAO,OAAO;YAChB;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAgC;gBAC/D,IAAI,OAAO,CAAC,GAAG,CAAC;oBAAE;oBAAM;oBAAO,GAAG,OAAO;gBAAC;YAC5C;YACA,QAAO,IAAY,EAAE,OAAgC;gBACnD,IAAI,OAAO,CAAC,GAAG,CAAC;oBAAE;oBAAM,OAAO;oBAAI,GAAG,OAAO;oBAAE,QAAQ;gBAAE;YAC3D;QACF;IACF;IAEA,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,gCAAgC;IAChC,MAAM,WAAW,IAAI,OAAO,CAAC,QAAQ;IACrC,MAAM,cACJ,SAAS,UAAU,CAAC,UACpB,SAAS,UAAU,CAAC;IAEtB,IAAI,eAAe,CAAC,MAAM;QACxB,MAAM,WAAW,IAAI,IAAI,UAAU,IAAI,GAAG;QAC1C,SAAS,YAAY,CAAC,GAAG,CAAC,cAAc,GAAG,WAAW,IAAI,OAAO,CAAC,MAAM,EAAE;QAC1E,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAc;KAAsB;AAChD"}}]
}