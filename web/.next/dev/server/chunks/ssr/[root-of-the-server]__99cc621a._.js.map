{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/eventos/EventLivePrepClient.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { CTA_PRIMARY } from \"@/app/organizador/dashboardUi\";\n\ntype LiveHubVisibility = \"PUBLIC\" | \"PRIVATE\" | \"DISABLED\";\n\ntype EventLivePrepClientProps = {\n  event: {\n    id: number;\n    slug: string;\n    title: string;\n    liveHubVisibility: LiveHubVisibility;\n    liveStreamUrl: string | null;\n  };\n  tournamentId?: number | null;\n};\n\nexport default function EventLivePrepClient({\n  event,\n  tournamentId,\n}: EventLivePrepClientProps) {\n  const [currentTournamentId, setCurrentTournamentId] = useState<number | null>(tournamentId ?? null);\n\n  const [liveHubVisibility, setLiveHubVisibility] = useState<LiveHubVisibility>(\n    event.liveHubVisibility ?? \"PUBLIC\",\n  );\n  const [liveStreamUrl, setLiveStreamUrl] = useState(event.liveStreamUrl ?? \"\");\n  const [saving, setSaving] = useState(false);\n  const [message, setMessage] = useState<string | null>(null);\n  const [creatingTournament, setCreatingTournament] = useState(false);\n  const [tournamentMessage, setTournamentMessage] = useState<string | null>(null);\n  const [bracketSize, setBracketSize] = useState(16);\n\n  const handleSave = async () => {\n    setSaving(true);\n    setMessage(null);\n    try {\n      const res = await fetch(\"/api/organizador/events/update\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          eventId: event.id,\n          liveHubVisibility,\n          liveStreamUrl: liveStreamUrl.trim() || null,\n        }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setMessage(json?.error || \"Erro ao guardar LiveHub.\");\n        return;\n      }\n      setMessage(\"LiveHub atualizado.\");\n    } catch {\n      setMessage(\"Erro inesperado ao guardar LiveHub.\");\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleCreateTournament = async () => {\n    setCreatingTournament(true);\n    setTournamentMessage(null);\n    try {\n      const res = await fetch(\"/api/organizador/tournaments/create\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ eventId: event.id, bracketSize }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setTournamentMessage(json?.error || \"Erro ao criar torneio.\");\n        return;\n      }\n      setCurrentTournamentId(json.tournamentId);\n      setTournamentMessage(\"Torneio criado.\");\n    } catch {\n      setTournamentMessage(\"Erro inesperado ao criar torneio.\");\n    } finally {\n      setCreatingTournament(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <section className=\"rounded-3xl border border-white/12 bg-gradient-to-br from-white/8 via-[#0b1226]/75 to-[#050912]/90 p-5 space-y-4 shadow-[0_26px_90px_rgba(0,0,0,0.6)] backdrop-blur-2xl\">\n        <div className=\"space-y-1\">\n          <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">LiveHub</p>\n          <p className=\"text-sm text-white/70\">Define visibilidade e a livestream antes de começares.</p>\n        </div>\n\n        <div className=\"grid gap-3 md:grid-cols-2\">\n          <div className=\"space-y-1\">\n            <label className=\"text-sm font-medium\">Visibilidade</label>\n            <select\n              value={liveHubVisibility}\n              onChange={(e) => setLiveHubVisibility(e.target.value as LiveHubVisibility)}\n              className=\"w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white outline-none focus:border-white/60\"\n            >\n              <option value=\"PUBLIC\">Público</option>\n              <option value=\"PRIVATE\">Privado (só participantes)</option>\n              <option value=\"DISABLED\">Desativado</option>\n            </select>\n            <p className=\"text-[11px] text-white/55\">\n              Público é sempre visível; privado mostra apenas a participantes; desativado oculta o LiveHub.\n            </p>\n          </div>\n\n          <div className=\"space-y-1 md:col-span-2\">\n            <label className=\"text-sm font-medium\">URL da livestream</label>\n            <input\n              value={liveStreamUrl}\n              onChange={(e) => setLiveStreamUrl(e.target.value)}\n              placeholder=\"https://youtu.be/...\"\n              className=\"w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white outline-none focus:border-white/60\"\n            />\n            <p className=\"text-[11px] text-white/55\">\n              Se vazio, o LiveHub mostra o módulo de vídeo como indisponível.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <button\n            type=\"button\"\n            onClick={handleSave}\n            disabled={saving}\n            className={`${CTA_PRIMARY} disabled:opacity-60`}\n          >\n            {saving ? \"A guardar…\" : \"Guardar LiveHub\"}\n          </button>\n          {message && <span className=\"text-[12px] text-white/70\">{message}</span>}\n        </div>\n      </section>\n\n      <section className=\"rounded-3xl border border-white/12 bg-gradient-to-br from-white/8 via-[#0b1226]/75 to-[#050912]/90 p-5 space-y-4 shadow-[0_26px_90px_rgba(0,0,0,0.6)] backdrop-blur-2xl\">\n        <div className=\"space-y-1\">\n          <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Torneio</p>\n          <p className=\"text-sm text-white/70\">Cria a bracket quando estiveres pronto para gerir jogos.</p>\n        </div>\n\n        {!currentTournamentId ? (\n          <div className=\"grid gap-3 md:grid-cols-[240px_1fr] md:items-end\">\n            <div className=\"space-y-1\">\n              <label className=\"text-sm font-medium\">Tamanho da bracket</label>\n              <select\n                value={bracketSize}\n                onChange={(e) => setBracketSize(Number(e.target.value))}\n                className=\"w-full rounded-xl border border-white/15 bg-black/30 px-3 py-2 text-sm text-white outline-none focus:border-white/60\"\n              >\n                {[2, 4, 8, 16, 32, 64].map((size) => (\n                  <option key={size} value={size}>\n                    {size} jogadores\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleCreateTournament}\n                disabled={creatingTournament}\n                className={`${CTA_PRIMARY} disabled:opacity-60`}\n              >\n                {creatingTournament ? \"A criar…\" : \"Criar torneio KO\"}\n              </button>\n              {tournamentMessage && <span className=\"text-[12px] text-white/70\">{tournamentMessage}</span>}\n            </div>\n          </div>\n        ) : (\n          <p className=\"text-[12px] text-white/60\">\n            Torneio pronto. Usa o separador Bracket para gerir participantes, jogos e resultados.\n          </p>\n        )}\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 380, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/avatars.ts"],"sourcesContent":["export const DEFAULT_GUEST_AVATAR = \"/images/guest-avatar.svg\";\n"],"names":[],"mappings":";;;;AAAO,MAAM,uBAAuB"}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerPremium.ts"],"sourcesContent":["import type { LiveHubModule } from \"@/lib/liveHubConfig\";\n\ntype OrganizerRef = {\n  id?: number | null;\n  username?: string | null;\n  // Gerido por subscrição (SaaS), não editar manualmente na UI.\n  liveHubPremiumEnabled?: boolean | null;\n};\n\ntype OrganizerPremiumModules = {\n  inscricoes?: boolean;\n  loja?: boolean;\n  galeria?: boolean;\n};\n\ntype LiveHubMatchOrder = \"ONEVONE\";\n\ntype OrganizerPremiumConfig = {\n  key: \"ONEVONE\";\n  organizerId: number;\n  username: string;\n  liveHubModules?: LiveHubModule[];\n  profileModules?: OrganizerPremiumModules;\n  liveHubMatchOrder?: LiveHubMatchOrder;\n};\n\nconst CUSTOM_PREMIUM_CONFIGS: OrganizerPremiumConfig[] = [\n  {\n    key: \"ONEVONE\",\n    organizerId: 23,\n    username: \"onevone\",\n    liveHubModules: [\"HERO\", \"VIDEO\", \"NOW_PLAYING\", \"NEXT_MATCHES\", \"RESULTS\", \"BRACKET\", \"SPONSORS\"],\n    profileModules: { inscricoes: true, loja: true, galeria: true },\n    liveHubMatchOrder: \"ONEVONE\",\n  },\n];\n\nconst normalizeUsername = (value?: string | null) => (typeof value === \"string\" ? value.trim().toLowerCase() : \"\");\n\nexport function getCustomPremiumConfig(organizer?: OrganizerRef | null) {\n  if (!organizer) return null;\n  const normalizedUsername = normalizeUsername(organizer.username);\n  return (\n    CUSTOM_PREMIUM_CONFIGS.find(\n      (config) =>\n        (config.organizerId && organizer.id === config.organizerId) ||\n        (normalizedUsername && config.username === normalizedUsername),\n    ) ?? null\n  );\n}\n\nexport function isCustomPremiumOrganizer(organizer?: OrganizerRef | null) {\n  return Boolean(getCustomPremiumConfig(organizer));\n}\n\nexport function isCustomPremiumActive(organizer?: OrganizerRef | null, premiumEnabled?: boolean | null) {\n  const config = getCustomPremiumConfig(organizer);\n  if (!config) return false;\n  const enabled = premiumEnabled ?? organizer?.liveHubPremiumEnabled ?? false;\n  return Boolean(enabled);\n}\n\nexport function getCustomPremiumKey(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.key ?? null;\n}\n\nexport function getCustomLiveHubModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubModules ?? null;\n}\n\nexport function getCustomPremiumProfileModules(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.profileModules ?? null;\n}\n\nexport function getCustomLiveHubMatchOrder(organizer?: OrganizerRef | null) {\n  return getCustomPremiumConfig(organizer)?.liveHubMatchOrder ?? null;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AA0BA,MAAM,yBAAmD;IACvD;QACE,KAAK;QACL,aAAa;QACb,UAAU;QACV,gBAAgB;YAAC;YAAQ;YAAS;YAAe;YAAgB;YAAW;YAAW;SAAW;QAClG,gBAAgB;YAAE,YAAY;YAAM,MAAM;YAAM,SAAS;QAAK;QAC9D,mBAAmB;IACrB;CACD;AAED,MAAM,oBAAoB,CAAC,QAA2B,OAAO,UAAU,WAAW,MAAM,IAAI,GAAG,WAAW,KAAK;AAExG,SAAS,uBAAuB,SAA+B;IACpE,IAAI,CAAC,WAAW,OAAO;IACvB,MAAM,qBAAqB,kBAAkB,UAAU,QAAQ;IAC/D,OACE,uBAAuB,IAAI,CACzB,CAAC,SACC,AAAC,OAAO,WAAW,IAAI,UAAU,EAAE,KAAK,OAAO,WAAW,IACzD,sBAAsB,OAAO,QAAQ,KAAK,uBAC1C;AAET;AAEO,SAAS,yBAAyB,SAA+B;IACtE,OAAO,QAAQ,uBAAuB;AACxC;AAEO,SAAS,sBAAsB,SAA+B,EAAE,cAA+B;IACpG,MAAM,SAAS,uBAAuB;IACtC,IAAI,CAAC,QAAQ,OAAO;IACpB,MAAM,UAAU,kBAAkB,WAAW,yBAAyB;IACtE,OAAO,QAAQ;AACjB;AAEO,SAAS,oBAAoB,SAA+B;IACjE,OAAO,uBAAuB,YAAY,OAAO;AACnD;AAEO,SAAS,wBAAwB,SAA+B;IACrE,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,+BAA+B,SAA+B;IAC5E,OAAO,uBAAuB,YAAY,kBAAkB;AAC9D;AAEO,SAAS,2BAA2B,SAA+B;IACxE,OAAO,uBAAuB,YAAY,qBAAqB;AACjE"}},
    {"offset": {"line": 458, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/eventos/%5Bslug%5D/EventLiveClient.tsx"],"sourcesContent":["\"use client\";\n\nimport useSWR from \"swr\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport Link from \"next/link\";\nimport { usePathname, useSearchParams } from \"next/navigation\";\nimport type { LiveHubModule, LiveHubViewerRole } from \"@/lib/liveHubConfig\";\nimport { DEFAULT_GUEST_AVATAR } from \"@/lib/avatars\";\nimport { useAuthModal } from \"@/app/components/autenticação/AuthModalContext\";\nimport { useUser } from \"@/app/hooks/useUser\";\nimport { getCustomLiveHubMatchOrder } from \"@/lib/organizerPremium\";\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json());\nconst LOCALE = \"pt-PT\";\nconst DEFAULT_TIMEZONE = \"Europe/Lisbon\";\n\ntype PairingMeta = {\n  id: number;\n  label: string;\n  subLabel?: string | null;\n  avatarUrl?: string | null;\n  profileUsername?: string | null;\n  href?: string | null;\n};\n\ntype EventPayload = {\n  id: number;\n  slug: string;\n  title: string;\n  description: string | null;\n  templateType?: string | null;\n  startsAt: string;\n  endsAt: string;\n  status: string;\n  locationName: string;\n  locationCity: string | null;\n  coverImageUrl: string | null;\n  liveStreamUrl: string | null;\n  timezone?: string | null;\n};\n\ntype MatchPayload = {\n  id: number;\n  stageId: number;\n  groupId?: number | null;\n  pairing1Id?: number | null;\n  pairing2Id?: number | null;\n  courtId?: number | null;\n  round?: number | null;\n  roundLabel?: string | null;\n  startAt?: string | null;\n  status: string;\n  statusLabel: string;\n  score?: { sets?: Array<{ a: number; b: number }>; goals?: { a: number; b: number; limit?: number } } | null;\n  updatedAt?: string | null;\n};\n\ntype SponsorSlot = {\n  label?: string | null;\n  logoUrl?: string | null;\n  url?: string | null;\n};\n\ntype SponsorsConfig = {\n  hero?: SponsorSlot | null;\n  sideA?: SponsorSlot | null;\n  sideB?: SponsorSlot | null;\n  nowPlaying?: SponsorSlot | null;\n} | null;\n\ntype GoalLimitsConfig = {\n  defaultLimit?: number | null;\n  roundLimits?: Record<string, number> | null;\n} | null;\n\nfunction formatDateRange(start?: string, end?: string, timeZone: string = DEFAULT_TIMEZONE) {\n  if (!start) return \"\";\n  const startDate = new Date(start);\n  const endDate = end ? new Date(end) : null;\n  const day = startDate.toLocaleDateString(LOCALE, { day: \"2-digit\", month: \"long\", timeZone });\n  const time = startDate.toLocaleTimeString(LOCALE, { hour: \"2-digit\", minute: \"2-digit\", timeZone });\n  if (!endDate) return `${day} · ${time}`;\n  const endTime = endDate.toLocaleTimeString(LOCALE, { hour: \"2-digit\", minute: \"2-digit\", timeZone });\n  return `${day} · ${time} - ${endTime}`;\n}\n\nfunction formatTime(value?: string | null, timeZone: string = DEFAULT_TIMEZONE) {\n  if (!value) return \"Por definir\";\n  return new Date(value).toLocaleTimeString(LOCALE, { hour: \"2-digit\", minute: \"2-digit\", timeZone });\n}\n\nfunction formatCountdown(start?: string, nowMs?: number) {\n  if (!start || !nowMs) return null;\n  const diff = new Date(start).getTime() - nowMs;\n  if (diff <= 0) return null;\n  const totalSeconds = Math.floor(diff / 1000);\n  const days = Math.floor(totalSeconds / 86400);\n  const hours = Math.floor((totalSeconds % 86400) / 3600);\n  const minutes = Math.floor((totalSeconds % 3600) / 60);\n  const seconds = totalSeconds % 60;\n  if (days > 0) return `${days}d ${hours}h ${minutes}m`;\n  if (hours > 0) return `${hours}h ${minutes}m`;\n  return `${minutes}m ${seconds}s`;\n}\n\nfunction getEventStatusLabel(start?: string, end?: string) {\n  if (!start) return \"Por anunciar\";\n  const now = new Date();\n  const startsAt = new Date(start);\n  const endsAt = end ? new Date(end) : null;\n  if (now < startsAt) return \"Próximo\";\n  if (endsAt && now > endsAt) return \"Concluído\";\n  return \"A decorrer\";\n}\n\nfunction escapeIcsText(value?: string | null) {\n  if (!value) return \"\";\n  return value.replace(/\\\\/g, \"\\\\\\\\\").replace(/\\n/g, \"\\\\n\").replace(/,/g, \"\\\\,\").replace(/;/g, \"\\\\;\");\n}\n\nfunction formatCalendarDate(value: Date) {\n  return value.toISOString().replace(/[-:]/g, \"\").replace(/\\.\\d{3}Z$/, \"Z\");\n}\n\nfunction buildCalendarLinks(event: EventPayload, timeZone: string) {\n  const startsAt = new Date(event.startsAt);\n  const endsAt = event.endsAt ? new Date(event.endsAt) : startsAt;\n  const location = [event.locationName, event.locationCity].filter(Boolean).join(\" · \");\n  const description = event.description?.trim() || `Evento ${event.title}`;\n  const dtStart = formatCalendarDate(startsAt);\n  const dtEnd = formatCalendarDate(endsAt);\n  const uid = `${event.slug || event.id}@orya`;\n\n  const googleUrl = new URL(\"https://calendar.google.com/calendar/render\");\n  googleUrl.searchParams.set(\"action\", \"TEMPLATE\");\n  googleUrl.searchParams.set(\"text\", event.title);\n  googleUrl.searchParams.set(\"dates\", `${dtStart}/${dtEnd}`);\n  if (description) googleUrl.searchParams.set(\"details\", description);\n  if (location) googleUrl.searchParams.set(\"location\", location);\n  if (timeZone) googleUrl.searchParams.set(\"ctz\", timeZone);\n\n  const icsLines = [\n    \"BEGIN:VCALENDAR\",\n    \"VERSION:2.0\",\n    \"PRODID:-//ORYA//LiveHub//PT\",\n    \"BEGIN:VEVENT\",\n    `UID:${escapeIcsText(uid)}`,\n    `DTSTAMP:${formatCalendarDate(new Date())}`,\n    `DTSTART:${dtStart}`,\n    `DTEND:${dtEnd}`,\n    `SUMMARY:${escapeIcsText(event.title)}`,\n    `DESCRIPTION:${escapeIcsText(description)}`,\n    `LOCATION:${escapeIcsText(location)}`,\n    \"END:VEVENT\",\n    \"END:VCALENDAR\",\n  ];\n\n  const icsUrl = `data:text/calendar;charset=utf-8,${encodeURIComponent(icsLines.join(\"\\n\"))}`;\n  return { google: googleUrl.toString(), ics: icsUrl };\n}\n\nfunction compareMatchOrder(a: MatchPayload, b: MatchPayload) {\n  if (a.startAt && b.startAt) {\n    const diff = new Date(a.startAt).getTime() - new Date(b.startAt).getTime();\n    if (diff !== 0) return diff;\n  } else if (a.startAt && !b.startAt) {\n    return -1;\n  } else if (!a.startAt && b.startAt) {\n    return 1;\n  }\n  const aRound = a.round ?? 0;\n  const bRound = b.round ?? 0;\n  if (aRound !== bRound) return aRound - bRound;\n  return a.id - b.id;\n}\n\nfunction compareBracketOrder(a: MatchPayload, b: MatchPayload) {\n  const aRound = a.round ?? 0;\n  const bRound = b.round ?? 0;\n  if (aRound !== bRound) return aRound - bRound;\n  return a.id - b.id;\n}\n\nfunction formatScore(score?: MatchPayload[\"score\"]) {\n  if (score?.goals) return `${score.goals.a}-${score.goals.b}`;\n  if (score?.sets?.length) return score.sets.map((s) => `${s.a}-${s.b}`).join(\" · \");\n  return \"—\";\n}\n\nfunction getScoreSummary(score?: MatchPayload[\"score\"]) {\n  if (score?.goals) {\n    return { a: score.goals.a, b: score.goals.b };\n  }\n  if (!score?.sets?.length) return null;\n  let a = 0;\n  let b = 0;\n  score.sets.forEach((s) => {\n    if (s.a > s.b) a += 1;\n    if (s.b > s.a) b += 1;\n  });\n  return { a, b };\n}\n\nfunction getWinnerSide(score?: MatchPayload[\"score\"]) {\n  if (score?.goals) {\n    const limit = score.goals.limit;\n    if (Number.isFinite(limit)) {\n      if (score.goals.a === limit) return \"A\";\n      if (score.goals.b === limit) return \"B\";\n      return null;\n    }\n    if (score.goals.a === score.goals.b) return null;\n    return score.goals.a > score.goals.b ? \"A\" : \"B\";\n  }\n  const summary = getScoreSummary(score);\n  if (!summary) return null;\n  if (summary.a === summary.b) return null;\n  return summary.a > summary.b ? \"A\" : \"B\";\n}\n\nfunction resolveBracketAdvancement(matches: MatchPayload[]) {\n  const cloned = matches.map((match) => ({ ...match }));\n  const matchesByRound = cloned.reduce<Record<number, MatchPayload[]>>((acc, match) => {\n    const round = match.round ?? 0;\n    if (round <= 0) return acc;\n    if (!acc[round]) acc[round] = [];\n    acc[round].push(match);\n    return acc;\n  }, {});\n  const rounds = Object.keys(matchesByRound)\n    .map((round) => Number(round))\n    .filter((round) => round > 0)\n    .sort((a, b) => a - b);\n\n  for (let idx = 0; idx < rounds.length - 1; idx += 1) {\n    const round = rounds[idx];\n    const nextRound = rounds[idx + 1];\n    const currentMatches = (matchesByRound[round] ?? []).slice().sort(compareBracketOrder);\n    const nextMatches = (matchesByRound[nextRound] ?? []).slice().sort(compareBracketOrder);\n\n    currentMatches.forEach((match, matchIdx) => {\n      if (match.status !== \"DONE\") return;\n      const winnerSide = getWinnerSide(match.score);\n      if (!winnerSide) return;\n      const winnerPairingId = winnerSide === \"A\" ? match.pairing1Id : match.pairing2Id;\n      if (!winnerPairingId) return;\n      const target = nextMatches[Math.floor(matchIdx / 2)];\n      if (!target) return;\n      if (matchIdx % 2 === 0) {\n        if (!target.pairing1Id) target.pairing1Id = winnerPairingId;\n      } else if (!target.pairing2Id) {\n        target.pairing2Id = winnerPairingId;\n      }\n    });\n  }\n\n  return cloned;\n}\n\nfunction buildRoundLabels(totalRounds: number) {\n  if (totalRounds <= 1) return [\"Final\"];\n  if (totalRounds === 2) return [\"Meias\", \"Final\"];\n  if (totalRounds === 3) return [\"Quartos\", \"Meias\", \"Final\"];\n  if (totalRounds === 4) return [\"Oitavos\", \"Quartos\", \"Meias\", \"Final\"];\n  if (totalRounds === 5) return [\"R32\", \"Oitavos\", \"Quartos\", \"Meias\", \"Final\"];\n  return [\"R64\", \"R32\", \"Oitavos\", \"Quartos\", \"Meias\", \"Final\"];\n}\n\nfunction normalizeGoalLimits(input: GoalLimitsConfig): GoalLimitsConfig {\n  if (!input) return null;\n  const defaultLimit =\n    typeof input.defaultLimit === \"number\" && Number.isFinite(input.defaultLimit) ? input.defaultLimit : null;\n  const roundLimitsRaw = input.roundLimits ?? null;\n  const roundLimits: Record<string, number> = {};\n  if (roundLimitsRaw && typeof roundLimitsRaw === \"object\") {\n    Object.entries(roundLimitsRaw).forEach(([key, value]) => {\n      if (typeof value === \"number\" && Number.isFinite(value)) {\n        roundLimits[key] = value;\n      }\n    });\n  }\n  return {\n    defaultLimit,\n    roundLimits: Object.keys(roundLimits).length ? roundLimits : null,\n  };\n}\n\nfunction resolveGoalLimit(round: number | null | undefined, limits: GoalLimitsConfig) {\n  const normalized = normalizeGoalLimits(limits);\n  const fallback = normalized?.defaultLimit ?? 3;\n  if (!round || !normalized?.roundLimits) return fallback;\n  const roundKey = String(round);\n  const roundLimit = normalized.roundLimits[roundKey];\n  return Number.isFinite(roundLimit) ? roundLimit : fallback;\n}\n\nfunction getStreamEmbed(url?: string | null) {\n  if (!url) return { embedUrl: null, href: null, provider: null };\n  try {\n    const parsed = new URL(url);\n    const host = parsed.hostname.replace(/^www\\./, \"\");\n    const parentHost =\n      typeof window !== \"undefined\"\n        ? window.location.hostname\n        : (process.env.NEXT_PUBLIC_BASE_URL ?? process.env.NEXT_PUBLIC_APP_URL ?? \"app.orya.pt\")\n            .replace(/^https?:\\/\\//, \"\");\n\n    if (host === \"youtu.be\") {\n      const id = parsed.pathname.split(\"/\").filter(Boolean)[0];\n      return id\n        ? { embedUrl: `https://www.youtube.com/embed/${id}`, href: url, provider: \"youtube\" }\n        : { embedUrl: null, href: url, provider: \"youtube\" };\n    }\n\n    if (host.endsWith(\"youtube.com\")) {\n      const queryId = parsed.searchParams.get(\"v\");\n      if (queryId) {\n        return { embedUrl: `https://www.youtube.com/embed/${queryId}`, href: url, provider: \"youtube\" };\n      }\n      const parts = parsed.pathname.split(\"/\").filter(Boolean);\n      const pathType = parts[0];\n      const pathId = parts[1];\n      if (pathId && [\"live\", \"embed\", \"shorts\"].includes(pathType)) {\n        return { embedUrl: `https://www.youtube.com/embed/${pathId}`, href: url, provider: \"youtube\" };\n      }\n      return { embedUrl: null, href: url, provider: \"youtube\" };\n    }\n\n    if (host.endsWith(\"twitch.tv\") || host === \"player.twitch.tv\") {\n      let channel = parsed.searchParams.get(\"channel\");\n      let video = parsed.searchParams.get(\"video\");\n\n      if (!channel && !video) {\n        const parts = parsed.pathname.split(\"/\").filter(Boolean);\n        if (parts[0] === \"videos\" && parts[1]) {\n          video = parts[1];\n        } else if (parts[0]) {\n          channel = parts[0];\n        }\n      }\n\n      const embedBase = \"https://player.twitch.tv/\";\n      if (channel) {\n        return {\n          embedUrl: `${embedBase}?channel=${channel}&parent=${parentHost}`,\n          href: url,\n          provider: \"twitch\",\n        };\n      }\n      if (video) {\n        return {\n          embedUrl: `${embedBase}?video=${video}&parent=${parentHost}`,\n          href: url,\n          provider: \"twitch\",\n        };\n      }\n      return { embedUrl: null, href: url, provider: \"twitch\" };\n    }\n\n    return { embedUrl: null, href: url, provider: \"unknown\" };\n  } catch {\n    return { embedUrl: null, href: url ?? null, provider: null };\n  }\n}\n\nfunction pairingMeta(id: number | null | undefined, pairings: Record<number, PairingMeta>) {\n  if (!id) return null;\n  return pairings[id] ?? null;\n}\n\nfunction pairingLabelPlain(id: number | null | undefined, pairings: Record<number, PairingMeta>) {\n  if (!id) return \"\";\n  return pairings[id]?.label ?? \"\";\n}\n\nfunction renderPairingName(id: number | null | undefined, pairings: Record<number, PairingMeta>, className?: string) {\n  if (!id) return <span className={className} />;\n  const meta = pairings[id];\n  const label = meta?.label ?? `#${id}`;\n  const subLabel = meta?.subLabel;\n  const avatarUrl = meta?.avatarUrl || DEFAULT_GUEST_AVATAR;\n  const content = (\n    <span className=\"inline-flex items-center gap-2\">\n      <span\n        className=\"h-5 w-5 rounded-full border border-white/10 bg-white/10 bg-cover bg-center\"\n        style={{ backgroundImage: `url(${avatarUrl})` }}\n      />\n      <span>{label}</span>\n      {subLabel && <span className=\"text-[11px] text-white/40\">{subLabel}</span>}\n    </span>\n  );\n  if (meta?.href) {\n    return (\n      <Link href={meta.href} className={className ? `${className} hover:underline` : \"hover:underline\"}>\n        {content}\n      </Link>\n    );\n  }\n  return <span className={className}>{content}</span>;\n}\n\nfunction RoleBadge({ role }: { role: LiveHubViewerRole }) {\n  const style =\n    role === \"ORGANIZER\"\n      ? \"border-emerald-400/40 bg-emerald-500/10 text-emerald-100\"\n      : role === \"PARTICIPANT\"\n        ? \"border-sky-400/40 bg-sky-500/10 text-sky-100\"\n        : \"border-white/15 bg-white/5 text-white/70\";\n  const label = role === \"ORGANIZER\" ? \"Organizador\" : role === \"PARTICIPANT\" ? \"Participante\" : \"Público\";\n  return <span className={`rounded-full border px-3 py-1 text-[11px] uppercase tracking-[0.2em] ${style}`}>{label}</span>;\n}\n\nfunction SponsorsStrip({ organizer }: { organizer: { publicName?: string | null } | null }) {\n  const sponsorLabels = organizer?.publicName ? [organizer.publicName] : [];\n  return (\n    <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div className=\"flex flex-wrap items-center gap-2\">\n          {sponsorLabels.length > 0 ? (\n            sponsorLabels.map((label) => (\n              <span\n                key={`sponsor-${label}`}\n                className=\"rounded-full border border-white/15 bg-white/5 px-3 py-1 text-xs text-white/70\"\n              >\n                {label}\n              </span>\n            ))\n          ) : (\n            <span className=\"text-sm text-white/60\">Sponsors em breve</span>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2 text-xs text-white/50\">\n          <span>Powered by</span>\n          <span className=\"text-white/80\">ORYA</span>\n        </div>\n      </div>\n    </section>\n  );\n}\n\nfunction MatchCard({\n  match,\n  pairings,\n  highlight,\n  timeZone,\n  size = \"md\",\n  showCourt,\n}: {\n  match: MatchPayload;\n  pairings: Record<number, PairingMeta>;\n  highlight?: boolean;\n  timeZone: string;\n  size?: \"md\" | \"lg\";\n  showCourt: boolean;\n}) {\n  const titleClass = size === \"lg\" ? \"text-base\" : \"text-sm\";\n  const metaClass = size === \"lg\" ? \"text-xs\" : \"text-[11px]\";\n  const statusClass = size === \"lg\" ? \"text-[11px]\" : \"text-[11px]\";\n  const scoreClass = size === \"lg\" ? \"text-sm\" : \"text-xs\";\n  const timeLabel = formatTime(match.startAt, timeZone);\n  const metaParts = [`Jogo #${match.id}`];\n  if (match.round) metaParts.push(`R${match.round}`);\n  metaParts.push(timeLabel);\n  if (showCourt) {\n    metaParts.push(match.courtId ? `Campo ${match.courtId}` : \"Campo —\");\n  }\n  return (\n    <div\n      className={`rounded-xl border px-3 py-2 transition ${\n        highlight ? \"border-emerald-400/60 bg-emerald-500/10\" : \"border-white/10 bg-white/5\"\n      }`}\n    >\n      <div className=\"flex items-center justify-between gap-3\">\n        <div className=\"space-y-1\">\n          <p className={`text-white font-medium ${titleClass}`}>\n            {renderPairingName(match.pairing1Id, pairings)} <span className=\"text-white/40\">vs</span>{\" \"}\n            {renderPairingName(match.pairing2Id, pairings)}\n          </p>\n          <p className={`${metaClass} text-white/60`}>\n            {metaParts.join(\" · \")}\n          </p>\n        </div>\n        <div className=\"text-right\">\n          <p className={`${statusClass} uppercase tracking-[0.18em] text-white/50`}>{match.statusLabel}</p>\n          <p className={`text-white/80 ${scoreClass}`}>{formatScore(match.score)}</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction EmptyCard({ title, children }: { title: string; children: string }) {\n  return (\n    <div className=\"rounded-2xl border border-white/10 bg-white/5 p-4 text-sm text-white/70\">\n      <p className=\"text-white font-semibold\">{title}</p>\n      <p className=\"mt-2 text-white/60\">{children}</p>\n    </div>\n  );\n}\n\nfunction OrganizerMatchEditor({\n  match,\n  tournamentId,\n  onUpdated,\n  goalLimit,\n  locked = false,\n  lockedReason,\n  canResolveDispute = false,\n}: {\n  match: MatchPayload;\n  tournamentId: number;\n  onUpdated: () => void;\n  goalLimit: number;\n  locked?: boolean;\n  lockedReason?: string | null;\n  canResolveDispute?: boolean;\n}) {\n  const [score, setScore] = useState(() => ({\n    a: match.score?.goals?.a ?? 0,\n    b: match.score?.goals?.b ?? 0,\n  }));\n  const [expectedUpdatedAt, setExpectedUpdatedAt] = useState<string | null>(match.updatedAt ?? null);\n  const [saving, setSaving] = useState(false);\n  const [undoing, setUndoing] = useState(false);\n  const [disputePending, setDisputePending] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [info, setInfo] = useState<string | null>(null);\n  const pendingScoreRef = useRef<{ a: number; b: number } | null>(null);\n  const debounceRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const expectedUpdatedAtRef = useRef<string | null>(match.updatedAt ?? null);\n  const savingRef = useRef(false);\n\n  useEffect(() => {\n    setScore({ a: match.score?.goals?.a ?? 0, b: match.score?.goals?.b ?? 0 });\n  }, [match.id, match.updatedAt, match.score?.goals?.a, match.score?.goals?.b]);\n\n  useEffect(() => {\n    const next = match.updatedAt ?? null;\n    setExpectedUpdatedAt(next);\n    expectedUpdatedAtRef.current = next;\n    pendingScoreRef.current = null;\n    if (debounceRef.current) {\n      clearTimeout(debounceRef.current);\n      debounceRef.current = null;\n    }\n  }, [match.id, match.updatedAt]);\n\n  useEffect(() => {\n    return () => {\n      if (debounceRef.current) {\n        clearTimeout(debounceRef.current);\n      }\n    };\n  }, []);\n\n  const flushPending = () => {\n    if (savingRef.current || !pendingScoreRef.current) return;\n    const pending = pendingScoreRef.current;\n    pendingScoreRef.current = null;\n    pushScore(pending.a, pending.b);\n  };\n\n  const clampScore = (value: number) => Math.max(0, Math.min(goalLimit, value));\n\n  const pushScore = async (nextA: number, nextB: number) => {\n    if (locked) {\n      setError(lockedReason || \"Este jogo está bloqueado.\");\n      return;\n    }\n    const expected = expectedUpdatedAtRef.current ?? match.updatedAt ?? null;\n    if (!expected) {\n      setError(\"Sem versão do jogo.\");\n      return;\n    }\n    setSaving(true);\n    savingRef.current = true;\n    setError(null);\n    const res = await fetch(`/api/organizador/tournaments/${tournamentId}/matches/${match.id}/result`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        score: { goals: { a: nextA, b: nextB, limit: goalLimit } },\n        expectedUpdatedAt: expected,\n      }),\n    });\n    const json = await res.json().catch(() => null);\n    setSaving(false);\n    savingRef.current = false;\n    if (!json?.ok) {\n      if (json?.error === \"MATCH_CONFLICT\") {\n        setError(\"Resultados atualizados noutro local. A atualizar...\");\n        onUpdated();\n        return;\n      }\n      setError(json?.error || \"Falha ao guardar resultado.\");\n      return;\n    }\n    if (json?.match?.updatedAt) {\n      setExpectedUpdatedAt(json.match.updatedAt as string);\n      expectedUpdatedAtRef.current = json.match.updatedAt as string;\n    }\n    if (!pendingScoreRef.current) {\n      setScore({ a: nextA, b: nextB });\n    }\n    onUpdated();\n    flushPending();\n  };\n\n  const adjust = (side: \"A\" | \"B\", delta: number) => {\n    if (locked) {\n      setError(lockedReason || \"Este jogo está bloqueado.\");\n      return;\n    }\n    const nextA = clampScore(side === \"A\" ? score.a + delta : score.a);\n    const nextB = clampScore(side === \"B\" ? score.b + delta : score.b);\n    if (nextA === score.a && nextB === score.b) return;\n    setScore({ a: nextA, b: nextB });\n    pendingScoreRef.current = { a: nextA, b: nextB };\n    if (debounceRef.current) {\n      clearTimeout(debounceRef.current);\n    }\n    debounceRef.current = setTimeout(() => {\n      flushPending();\n    }, 120);\n  };\n\n\n  const overrideWinner = async (side: \"A\" | \"B\") => {\n    if (saving) return;\n    if (locked) {\n      setError(lockedReason || \"Este jogo está bloqueado.\");\n      return;\n    }\n    const expected = expectedUpdatedAtRef.current ?? match.updatedAt ?? null;\n    if (!expected) {\n      setError(\"Sem versão do jogo.\");\n      return;\n    }\n    const pairingId = side === \"A\" ? match.pairing1Id : match.pairing2Id;\n    if (!pairingId) {\n      setError(\"Sem jogador atribuído.\");\n      return;\n    }\n    const confirmed = window.confirm(\"Confirmar override manual? Isto vai marcar o jogo como terminado.\");\n    if (!confirmed) return;\n    const nextA = side === \"A\" ? goalLimit : 0;\n    const nextB = side === \"B\" ? goalLimit : 0;\n    setSaving(true);\n    savingRef.current = true;\n    setError(null);\n    const res = await fetch(`/api/organizador/tournaments/${tournamentId}/matches/${match.id}/result`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        score: { goals: { a: nextA, b: nextB, limit: goalLimit } },\n        winnerPairingId: pairingId,\n        status: \"DONE\",\n        expectedUpdatedAt: expected,\n        force: true,\n      }),\n    });\n    const json = await res.json().catch(() => null);\n    setSaving(false);\n    savingRef.current = false;\n    if (!json?.ok) {\n      if (json?.error === \"MATCH_CONFLICT\") {\n        setError(\"Resultados atualizados noutro local. A atualizar...\");\n        onUpdated();\n        return;\n      }\n      setError(json?.error || \"Falha ao aplicar override.\");\n      return;\n    }\n    if (json?.match?.updatedAt) {\n      setExpectedUpdatedAt(json.match.updatedAt as string);\n      expectedUpdatedAtRef.current = json.match.updatedAt as string;\n    }\n    setScore({ a: nextA, b: nextB });\n    onUpdated();\n  };\n\n  const markDisputed = async () => {\n    if (saving || disputePending) return;\n    if (locked) {\n      setError(lockedReason || \"Este jogo está bloqueado.\");\n      return;\n    }\n    const expected = expectedUpdatedAtRef.current ?? match.updatedAt ?? null;\n    if (!expected) {\n      setError(\"Sem versão do jogo.\");\n      return;\n    }\n    const confirmed = window.confirm(\"Marcar este jogo como disputado? Isto vai bloquear o avanço automático.\");\n    if (!confirmed) return;\n    setDisputePending(true);\n    setError(null);\n    setInfo(null);\n    try {\n      const res = await fetch(`/api/organizador/tournaments/${tournamentId}/matches/${match.id}/result`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          status: \"DISPUTED\",\n          expectedUpdatedAt: expected,\n          force: true,\n        }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error || \"Falha ao marcar disputa.\");\n        return;\n      }\n      if (json?.match?.updatedAt) {\n        setExpectedUpdatedAt(json.match.updatedAt as string);\n        expectedUpdatedAtRef.current = json.match.updatedAt as string;\n      }\n      setInfo(\"Jogo marcado como disputado.\");\n      onUpdated();\n    } finally {\n      setDisputePending(false);\n    }\n  };\n\n  const resolveDispute = async () => {\n    if (saving || disputePending) return;\n    if (!canResolveDispute) {\n      setError(\"Apenas ADMIN pode resolver a disputa.\");\n      return;\n    }\n    const expected = expectedUpdatedAtRef.current ?? match.updatedAt ?? null;\n    if (!expected) {\n      setError(\"Sem versão do jogo.\");\n      return;\n    }\n    const confirmed = window.confirm(\"Resolver disputa e reabrir o jogo?\");\n    if (!confirmed) return;\n    setDisputePending(true);\n    setError(null);\n    setInfo(null);\n    const nextStatus = score.a > 0 || score.b > 0 ? \"IN_PROGRESS\" : \"PENDING\";\n    try {\n      const res = await fetch(`/api/organizador/tournaments/${tournamentId}/matches/${match.id}/result`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          status: nextStatus,\n          expectedUpdatedAt: expected,\n          force: true,\n        }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error || \"Falha ao resolver disputa.\");\n        return;\n      }\n      if (json?.match?.updatedAt) {\n        setExpectedUpdatedAt(json.match.updatedAt as string);\n        expectedUpdatedAtRef.current = json.match.updatedAt as string;\n      }\n      setInfo(\"Disputa resolvida.\");\n      onUpdated();\n    } finally {\n      setDisputePending(false);\n    }\n  };\n\n  const undoLast = async () => {\n    if (undoing || saving) return;\n    setUndoing(true);\n    setError(null);\n    setInfo(null);\n    try {\n      const res = await fetch(`/api/organizador/tournaments/${tournamentId}/matches/${match.id}/undo`, {\n        method: \"POST\",\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setError(json?.error || \"Undo indisponível.\");\n        return;\n      }\n      if (json?.match?.updatedAt) {\n        setExpectedUpdatedAt(json.match.updatedAt as string);\n        expectedUpdatedAtRef.current = json.match.updatedAt as string;\n      }\n      setScore({\n        a: json?.match?.score?.goals?.a ?? 0,\n        b: json?.match?.score?.goals?.b ?? 0,\n      });\n      setInfo(\"Última ação desfeita.\");\n      onUpdated();\n    } finally {\n      setUndoing(false);\n    }\n  };\n\n  return (\n    <div className=\"rounded-xl border border-white/10 bg-black/30 px-3 py-2\">\n      <div className=\"flex items-center justify-between\">\n        <span className=\"text-white text-sm\">Golos (limite {goalLimit})</span>\n      </div>\n      <div className=\"mt-2 grid gap-2 text-xs text-white/70\">\n        {([\"A\", \"B\"] as const).map((side) => {\n          const value = side === \"A\" ? score.a : score.b;\n          const finished = score.a === goalLimit || score.b === goalLimit;\n          return (\n            <div key={`${match.id}-score-${side}`} className=\"flex items-center justify-between gap-2\">\n              <span className=\"text-white/60\">{side === \"A\" ? \"Jogador A\" : \"Jogador B\"}</span>\n              <div className=\"flex items-center gap-2\">\n                <button\n                  type=\"button\"\n                  disabled={locked || value <= 0}\n                  onClick={() => adjust(side, -1)}\n                  className=\"h-7 w-7 rounded-full border border-white/15 text-white/70 hover:border-white/40 disabled:opacity-50\"\n                >\n                  −\n                </button>\n                <span className=\"min-w-[24px] text-center text-sm text-white\">{value}</span>\n                <button\n                  type=\"button\"\n                  disabled={locked || value >= goalLimit || finished}\n                  onClick={() => adjust(side, 1)}\n                  className=\"h-7 w-7 rounded-full border border-white/15 text-white/70 hover:border-white/40 disabled:opacity-50\"\n                >\n                  +\n                </button>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n      {error && <p className=\"mt-2 text-[11px] text-rose-300\">{error}</p>}\n      {info && <p className=\"mt-2 text-[11px] text-emerald-200\">{info}</p>}\n      <div className=\"mt-3 flex flex-wrap gap-2\">\n        <button\n          type=\"button\"\n          onClick={undoLast}\n          disabled={undoing || saving}\n          className=\"rounded-full border border-white/15 px-3 py-1 text-[11px] text-white/70 hover:border-white/40 disabled:opacity-60\"\n        >\n          {undoing ? \"A desfazer…\" : \"Undo (60s)\"}\n        </button>\n        {match.status === \"DISPUTED\" ? (\n          <button\n            type=\"button\"\n            onClick={resolveDispute}\n            disabled={disputePending || saving || !canResolveDispute}\n            className=\"rounded-full border border-amber-400/40 px-3 py-1 text-[11px] text-amber-100 hover:border-amber-200/70 disabled:opacity-60\"\n          >\n            {disputePending ? \"A resolver…\" : canResolveDispute ? \"Resolver disputa\" : \"Resolver disputa (ADMIN)\"}\n          </button>\n        ) : (\n          <button\n            type=\"button\"\n            onClick={markDisputed}\n            disabled={disputePending || saving || locked}\n            className=\"rounded-full border border-rose-400/40 px-3 py-1 text-[11px] text-rose-100 hover:border-rose-200/70 disabled:opacity-60\"\n          >\n            {disputePending ? \"A marcar…\" : \"Marcar disputa\"}\n          </button>\n        )}\n      </div>\n      <details className=\"mt-3 rounded-lg border border-amber-400/30 bg-amber-500/10 px-3 py-2 text-[11px] text-amber-100\">\n        <summary className=\"cursor-pointer uppercase tracking-[0.18em] text-[11px]\">\n          Override manual\n        </summary>\n        <div className=\"mt-2 space-y-2\">\n          <p className=\"text-[11px] text-amber-100/80\">Usa só em casos excecionais.</p>\n          <div className=\"flex flex-wrap gap-2\">\n            <button\n              type=\"button\"\n              disabled={saving || !match.pairing1Id}\n              onClick={() => overrideWinner(\"A\")}\n              className=\"rounded-full border border-amber-400/40 px-3 py-1 text-[11px] text-amber-100 hover:border-amber-200/70 disabled:opacity-60\"\n            >\n              Forçar {match.pairing1Id ? `Jogador #${match.pairing1Id}` : \"Jogador A\"}\n            </button>\n            <button\n              type=\"button\"\n              disabled={saving || !match.pairing2Id}\n              onClick={() => overrideWinner(\"B\")}\n              className=\"rounded-full border border-amber-400/40 px-3 py-1 text-[11px] text-amber-100 hover:border-amber-200/70 disabled:opacity-60\"\n            >\n              Forçar {match.pairing2Id ? `Jogador #${match.pairing2Id}` : \"Jogador B\"}\n            </button>\n          </div>\n        </div>\n      </details>\n    </div>\n  );\n}\n\nfunction LiveHubTv({\n  event,\n  tournament,\n  pairings,\n  timeZone,\n  showCourt,\n}: {\n  event: EventPayload;\n  tournament: any;\n  pairings: Record<number, PairingMeta>;\n  timeZone: string;\n  showCourt: boolean;\n}) {\n  const matches = tournament.stages.flatMap((s: any) => [...s.matches, ...s.groups.flatMap((g: any) => g.matches)]);\n\n  const upcoming = matches\n    .filter((m: MatchPayload) => m.status !== \"DONE\" && m.status !== \"IN_PROGRESS\" && m.status !== \"LIVE\")\n    .sort((a: MatchPayload, b: MatchPayload) => {\n      if (a.startAt && b.startAt) {\n        const diff = new Date(a.startAt).getTime() - new Date(b.startAt).getTime();\n        if (diff !== 0) return diff;\n      }\n      if (showCourt) {\n        const aCourt = a.courtId ?? 9999;\n        const bCourt = b.courtId ?? 9999;\n        return aCourt - bCourt;\n      }\n      return 0;\n    })\n    .slice(0, 8);\n\n  const live = matches.filter((m: MatchPayload) => m.status === \"IN_PROGRESS\" || m.status === \"LIVE\").slice(0, 6);\n  const playoffStage =\n    tournament.stages.find((s: any) => s.stageType === \"PLAYOFF\" && s.matches?.length) ??\n    tournament.stages.find((s: any) => s.matches?.length) ??\n    tournament.stages[0];\n  const tvBracketMatches = playoffStage?.matches?.slice(0, 8) ?? [];\n  const tvGroupStages = tournament.stages.filter((s: any) => (s.groups ?? []).length > 0);\n\n  return (\n    <div className=\"space-y-8\">\n      <header className=\"flex flex-wrap items-end justify-between gap-6\">\n        <div>\n          <p className=\"text-[11px] uppercase tracking-[0.4em] text-white/60\">Modo TV</p>\n          <h1 className=\"text-4xl font-semibold text-white\">{event.title}</h1>\n          <p className=\"text-white/60\">{formatDateRange(event.startsAt, event.endsAt, timeZone)}</p>\n        </div>\n        <div className=\"rounded-2xl border border-white/10 bg-white/5 px-4 py-2 text-sm text-white/70\">\n          Atualiza automaticamente\n        </div>\n      </header>\n\n      <div className=\"grid gap-5 lg:grid-cols-2\">\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold\">Agora a jogar</h2>\n            <span className=\"text-white/60 text-sm\">{live.length} ativos</span>\n          </div>\n          {live.length === 0 && <p className=\"text-white/60\">Sem jogos em curso.</p>}\n          {live.map((m: MatchPayload) => (\n            <MatchCard key={`live-${m.id}`} match={m} pairings={pairings} timeZone={timeZone} size=\"lg\" showCourt={showCourt} />\n          ))}\n        </section>\n\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold\">Próximos jogos</h2>\n            <span className=\"text-white/60 text-sm\">{upcoming.length} agendados</span>\n          </div>\n          {upcoming.length === 0 && <p className=\"text-white/60\">Sem jogos agendados.</p>}\n          {upcoming.map((m: MatchPayload) => (\n            <MatchCard key={`up-${m.id}`} match={m} pairings={pairings} timeZone={timeZone} size=\"lg\" showCourt={showCourt} />\n          ))}\n        </section>\n      </div>\n\n      {tvBracketMatches.length > 0 && (\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold\">Bracket</h2>\n            <span className=\"text-white/60 text-sm\">{tvBracketMatches.length} jogos</span>\n          </div>\n          <div className=\"grid gap-3 md:grid-cols-2\">\n            {tvBracketMatches.map((match: MatchPayload) => (\n              <MatchCard key={`tv-bracket-${match.id}`} match={match} pairings={pairings} timeZone={timeZone} size=\"lg\" showCourt={showCourt} />\n            ))}\n          </div>\n        </section>\n      )}\n      {tvBracketMatches.length === 0 && tvGroupStages.length > 0 && (\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold\">Tabela</h2>\n            <span className=\"text-white/60 text-sm\">Classificações</span>\n          </div>\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {tvGroupStages.map((stage: any) =>\n              stage.groups.map((group: any) => (\n                <div key={`tv-group-${group.id}`} className=\"rounded-2xl border border-white/10 bg-black/30 p-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"text-white font-semibold\">{group.name || \"Grupo\"}</h3>\n                    <span className=\"text-[11px] uppercase tracking-[0.18em] text-white/50\">{stage.stageType}</span>\n                  </div>\n                  <div className=\"mt-3 space-y-2 text-sm\">\n                    {(group.standings ?? []).length === 0 && (\n                      <p className=\"text-white/60\">Sem classificação disponível.</p>\n                    )}\n                    {(group.standings ?? []).map((row: any, idx: number) => (\n                      <div key={`tv-group-${group.id}-${row.pairingId}`} className=\"flex items-center justify-between text-white/80\">\n                        <div className=\"flex items-center gap-3\">\n                          <span className=\"text-white/50\">{idx + 1}</span>\n                          {renderPairingName(row.pairingId, pairings)}\n                        </div>\n                        <span className=\"text-white/50\">{row.wins}-{row.losses}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )),\n            )}\n          </div>\n        </section>\n      )}\n    </div>\n  );\n}\n\nfunction BracketRoundsView({\n  matches,\n  pairings,\n  isOrganizerEdit,\n  tournamentId,\n  onUpdated,\n  goalLimits,\n  highlightPairingId,\n  canResolveDispute,\n  view = \"split\",\n}: {\n  matches: MatchPayload[];\n  pairings: Record<number, PairingMeta>;\n  isOrganizerEdit: boolean;\n  tournamentId: number | null;\n  onUpdated: () => void;\n  goalLimits: GoalLimitsConfig;\n  highlightPairingId?: number | null;\n  canResolveDispute?: boolean;\n  view?: \"split\" | \"full\";\n}) {\n  const [activeRound, setActiveRound] = useState<number | null>(null);\n\n  const matchesByRound = matches.reduce((acc: Record<number, MatchPayload[]>, match: MatchPayload) => {\n    const round = match.round ?? 0;\n    if (!acc[round]) acc[round] = [];\n    acc[round].push(match);\n    return acc;\n  }, {});\n  const rounds = Object.keys(matchesByRound)\n    .map((r) => Number(r))\n    .sort((a, b) => a - b);\n  const roundLabels = buildRoundLabels(rounds.length);\n  const finalRound = rounds.length > 0 ? rounds[rounds.length - 1] : null;\n  const roundLabelMap = rounds.reduce((acc, round, idx) => {\n    acc[round] = roundLabels[idx] || `Ronda ${round}`;\n    return acc;\n  }, {} as Record<number, string>);\n  const treeRowHeight = 32;\n  const liveMatches = matches.filter((match) => match.status === \"IN_PROGRESS\" || match.status === \"LIVE\");\n  const liveRounds = new Set<number>(liveMatches.map((match) => match.round ?? 0).filter((round) => round > 0));\n  const liveRound = liveMatches[0]?.round ?? null;\n  const roundIsComplete = (round: number) => {\n    const list = matchesByRound[round] ?? [];\n    return list.length > 0 && list.every((match) => match.status === \"DONE\");\n  };\n  const roundHasLive = (round: number) => {\n    const list = matchesByRound[round] ?? [];\n    return list.some((match) => match.status === \"IN_PROGRESS\" || match.status === \"LIVE\");\n  };\n  const currentRound =\n    (liveRound && rounds.includes(liveRound) ? liveRound : null) ??\n    rounds.find((round) => !roundIsComplete(round)) ??\n    finalRound;\n  const roundIsLocked = (round: number) => {\n    const idx = rounds.indexOf(round);\n    if (idx <= 0) return false;\n    return rounds.slice(0, idx).some((r) => !roundIsComplete(r));\n  };\n  const desktopTreeStartIndex = Math.max(0, rounds.length - 3);\n  const mobileTreeStartIndex = Math.max(0, rounds.length - 2);\n  const activeRoundIndex = activeRound ? rounds.indexOf(activeRound) : -1;\n  const desktopTreeRounds = rounds.slice(desktopTreeStartIndex);\n  const mobileTreeRounds = rounds.slice(mobileTreeStartIndex);\n  const showDesktopTree = activeRoundIndex >= desktopTreeStartIndex;\n  const showMobileTree = activeRoundIndex >= mobileTreeStartIndex;\n\n  const renderRow = (\n    side: \"A\" | \"B\",\n    match: MatchPayload,\n    winnerSide: \"A\" | \"B\" | null,\n    summary: { a: number; b: number } | null,\n    compact?: boolean,\n    final?: boolean,\n  ) => {\n    const pairingId = side === \"A\" ? match.pairing1Id : match.pairing2Id;\n    const isWinner = winnerSide === side;\n    const isLoser = winnerSide && winnerSide !== side;\n    const score = summary ? (side === \"A\" ? summary.a : summary.b) : 0;\n    const scoreTone = isWinner ? \"text-emerald-300\" : isLoser ? \"text-rose-300\" : \"text-white/70\";\n    const nameTone = isLoser ? \"text-white/50\" : \"text-white/85\";\n    const textClass = compact ? \"text-[11px]\" : \"text-sm\";\n    const paddingClass = compact ? \"py-1\" : \"py-2\";\n    if (compact) {\n      const meta = pairingMeta(pairingId, pairings);\n      const fallbackLabel = pairingId ? `#${pairingId}` : \"A definir\";\n      const label = meta?.label ?? fallbackLabel;\n      const displayLabel = label.length > 16 ? label.slice(0, 16) : label;\n      const avatarUrl = meta?.avatarUrl || DEFAULT_GUEST_AVATAR;\n      const avatarClass = final ? \"h-14 w-14\" : \"h-12 w-12\";\n      return (\n        <div className={`flex items-center justify-between gap-3 ${paddingClass}`}>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"flex flex-col items-center gap-1\">\n              <span\n                className={`${avatarClass} rounded-full border border-white/10 bg-white/10 bg-cover bg-center`}\n                style={{ backgroundImage: `url(${avatarUrl})` }}\n              />\n              <span className={`max-w-[120px] truncate text-[11px] ${nameTone}`} title={label}>\n                {displayLabel}\n              </span>\n            </div>\n          </div>\n          <span\n            className={`min-w-[22px] text-right text-base font-semibold tabular-nums ${final ? \"text-lg\" : \"\"} ${scoreTone}`}\n          >\n            {score}\n          </span>\n        </div>\n      );\n    }\n    return (\n      <div className={`flex items-center justify-between gap-2 ${paddingClass}`}>\n        <div className={`min-w-0 ${textClass} ${nameTone}`}>{renderPairingName(pairingId, pairings, \"truncate\")}</div>\n        <span className={`${textClass} min-w-[24px] text-right font-semibold tabular-nums ${scoreTone}`}>{score}</span>\n      </div>\n    );\n  };\n\n  const renderListMatch = (\n    match: MatchPayload,\n    options?: {\n      withConnector?: boolean;\n      connectorSide?: \"left\" | \"right\";\n      connectorDirection?: \"up\" | \"down\";\n      connectorHeight?: number;\n      compact?: boolean;\n      accent?: boolean;\n      final?: boolean;\n      locked?: boolean;\n      style?: Record<string, string | number>;\n    },\n  ) => {\n    const summary = getScoreSummary(match.score);\n    const winnerSide = match.status === \"DONE\" ? getWinnerSide(match.score) : null;\n    const isLive = match.status === \"IN_PROGRESS\" || match.status === \"LIVE\";\n    const isDisputed = match.status === \"DISPUTED\";\n    const isLocked = Boolean(options?.locked || isDisputed);\n    const lockedReason = isDisputed\n      ? \"Jogo em disputa. Resolve antes de editar.\"\n      : options?.locked\n        ? \"Esta fase ainda não está ativa.\"\n        : null;\n    const useCompact = Boolean(options?.compact);\n    const isHighlighted =\n      typeof highlightPairingId === \"number\" &&\n      (match.pairing1Id === highlightPairingId || match.pairing2Id === highlightPairingId);\n    const wrapperTone = useCompact\n      ? \"border-transparent bg-transparent\"\n      : isDisputed\n        ? \"border-rose-400/60 bg-rose-500/10\"\n        : isLive\n        ? \"border-emerald-400/70 bg-emerald-500/15\"\n        : isHighlighted\n          ? \"border-emerald-400/50 bg-emerald-500/10\"\n          : \"border-white/10 bg-black/30\";\n    const isFinal = Boolean(options?.final);\n    const paddingClass = isFinal ? \"p-3\" : useCompact ? \"p-2\" : \"p-3\";\n    const accentClass = options?.accent ? \"ring-1 ring-white/25 shadow-[0_10px_24px_rgba(0,0,0,0.35)]\" : \"\";\n    const liveClass = isLive ? \"ring-1 ring-emerald-400/60 shadow-[0_0_16px_rgba(16,185,129,0.25)]\" : \"\";\n    const disputeClass = isDisputed ? \"ring-1 ring-rose-400/60 shadow-[0_0_16px_rgba(244,63,94,0.28)]\" : \"\";\n    const finalClass = isFinal\n      ? \"ring-1 ring-amber-300/70 shadow-[0_18px_40px_rgba(0,0,0,0.45)]\"\n      : \"\";\n    const needsRelative = Boolean(options?.withConnector || options?.connectorSide || isLive);\n    const lockedClass = isLocked ? \"opacity-70\" : \"\";\n    const wrapperClass = `${needsRelative ? \"relative\" : \"\"} rounded-2xl border ${wrapperTone} ${paddingClass} ${accentClass} ${liveClass} ${disputeClass} ${finalClass} ${lockedClass}`;\n    return (\n      <div key={`list-${match.id}`} className={wrapperClass} style={options?.style}>\n        {isLive && (\n          <span className=\"absolute -top-2 left-3 rounded-full border border-emerald-400/60 bg-emerald-500/20 px-2 py-0.5 text-[10px] uppercase tracking-[0.2em] text-emerald-100\">\n            Live\n          </span>\n        )}\n        {isDisputed && (\n          <span className=\"absolute -top-2 left-3 rounded-full border border-rose-400/60 bg-rose-500/20 px-2 py-0.5 text-[10px] uppercase tracking-[0.2em] text-rose-100\">\n            Disputa\n          </span>\n        )}\n        {isFinal && (\n          <span className=\"absolute -top-2 right-3 rounded-full border border-amber-300/70 bg-amber-500/20 px-2 py-0.5 text-[10px] uppercase tracking-[0.2em] text-amber-100\">\n            Final\n          </span>\n        )}\n        {isFinal ? (\n          <div className=\"grid grid-cols-2 gap-4\">\n            {renderRow(\"A\", match, winnerSide, summary, useCompact, isFinal)}\n            {renderRow(\"B\", match, winnerSide, summary, useCompact, isFinal)}\n          </div>\n        ) : (\n          <div className={useCompact ? \"space-y-1\" : \"space-y-2\"}>\n            {renderRow(\"A\", match, winnerSide, summary, useCompact, isFinal)}\n            {renderRow(\"B\", match, winnerSide, summary, useCompact, isFinal)}\n          </div>\n        )}\n        {(options?.withConnector || options?.connectorSide) && (\n          <div\n            className={`pointer-events-none absolute top-1/2 h-px w-6 bg-white/15 ${\n              options?.connectorSide === \"left\" ? \"left-[-18px]\" : \"right-[-18px]\"\n            }`}\n          />\n        )}\n        {options?.connectorHeight && options?.connectorDirection && (\n          <div\n            className={`pointer-events-none absolute w-px bg-white/15 ${\n              options?.connectorSide === \"left\" ? \"left-[-18px]\" : \"right-[-18px]\"\n            } ${options?.connectorDirection === \"up\" ? \"bottom-1/2\" : \"top-1/2\"}`}\n            style={{ height: options.connectorHeight }}\n          />\n        )}\n        {isOrganizerEdit && tournamentId && (\n          <div className=\"pt-1\">\n            <OrganizerMatchEditor\n              match={match}\n              tournamentId={tournamentId}\n              onUpdated={onUpdated}\n              goalLimit={resolveGoalLimit(match.round ?? null, goalLimits)}\n              locked={isLocked}\n              lockedReason={lockedReason}\n              canResolveDispute={canResolveDispute}\n            />\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  useEffect(() => {\n    if (rounds.length === 0) return;\n    if (!activeRound || !rounds.includes(activeRound)) {\n      setActiveRound(currentRound ?? rounds[0]);\n    }\n  }, [activeRound, currentRound, rounds.join(\",\")]);\n\n  const activeMatches = activeRound ? matchesByRound[activeRound] ?? [] : [];\n  const activeMatchesSorted = activeMatches.slice().sort((a, b) => a.id - b.id);\n  const splitIndex = Math.ceil(activeMatchesSorted.length / 2);\n  const leftMatches = activeMatchesSorted.slice(0, splitIndex);\n  const rightMatches = activeMatchesSorted.slice(splitIndex);\n\n  const renderSymmetricTreeGrid = (\n    treeRounds: number[],\n    options?: { compact?: boolean; rowHeight?: number; minColWidth?: number; accentRound?: number | null },\n  ) => {\n    if (treeRounds.length === 0) return null;\n    const lastRound = treeRounds[treeRounds.length - 1];\n    const leftRounds = treeRounds.filter((round) => round !== lastRound);\n    const leftCount = leftRounds.length;\n    const columns = leftCount * 2 + 1;\n    const rowHeight = options?.rowHeight ?? treeRowHeight;\n    const minColWidth = options?.minColWidth ?? 160;\n    const treeRows = leftCount > 0 ? 2 ** leftCount : 1;\n    const leftIndexMap = leftRounds.reduce((acc, round, idx) => {\n      acc[round] = idx;\n      return acc;\n    }, {} as Record<number, number>);\n    const rightRounds = [...leftRounds].reverse();\n    const columnLabels = [\n      ...leftRounds.map((round) => roundLabelMap[round] || `Ronda ${round}`),\n      roundLabelMap[lastRound] || `Ronda ${lastRound}`,\n      ...rightRounds.map((round) => roundLabelMap[round] || `Ronda ${round}`),\n    ];\n    const roundMatches = (round: number) =>\n      (matchesByRound[round] ?? []).slice().sort((a, b) => compareBracketOrder(a, b));\n    const roundSplit = (round: number) => {\n      const list = roundMatches(round);\n      const half = Math.ceil(list.length / 2);\n      return { left: list.slice(0, half), right: list.slice(half) };\n    };\n    const finalMatch = roundMatches(lastRound)[0] ?? null;\n    const finalRow = leftCount > 0 ? 2 ** (leftCount - 1) : 1;\n    const accentRound = options?.accentRound ?? null;\n    const columnTemplate =\n      options?.minColWidth && options.minColWidth > 0\n        ? `repeat(${columns}, minmax(${options.minColWidth}px, 1fr))`\n        : `repeat(${columns}, minmax(0, 1fr))`;\n\n    return (\n      <div className=\"space-y-3\">\n        <div className=\"grid gap-4\" style={{ gridTemplateColumns: columnTemplate }}>\n          {columnLabels.map((label, idx) => (\n            <p key={`sym-label-${idx}`} className=\"text-[11px] uppercase tracking-[0.24em] text-white/50\">\n              {label}\n            </p>\n          ))}\n        </div>\n        <div\n          className=\"grid gap-x-6 gap-y-2\"\n          style={{\n            gridTemplateColumns: columnTemplate,\n            gridTemplateRows: `repeat(${treeRows}, minmax(${rowHeight}px, 1fr))`,\n            minHeight: treeRows ? `${treeRows * rowHeight}px` : undefined,\n          }}\n        >\n          {leftRounds.flatMap((round, colIdx) => {\n            const { left } = roundSplit(round);\n            const roundIndex = leftIndexMap[round] ?? colIdx;\n            const connectorHeight = left.length > 1 ? rowHeight * 2 ** roundIndex : 0;\n            return left.map((match, matchIdx) => {\n              const row = 2 ** roundIndex * (2 * matchIdx + 1);\n              const connectorDirection = matchIdx % 2 === 0 ? \"down\" : \"up\";\n              return renderListMatch(match, {\n                connectorSide: \"right\",\n                connectorDirection: connectorHeight ? connectorDirection : undefined,\n                connectorHeight: connectorHeight || undefined,\n                compact: options?.compact,\n                locked: roundIsLocked(round),\n                style: { gridColumn: colIdx + 1, gridRow: row },\n              });\n            });\n          })}\n          {finalMatch &&\n            renderListMatch(finalMatch, {\n              compact: options?.compact,\n              accent: accentRound === lastRound,\n              final: true,\n              locked: roundIsLocked(lastRound),\n              style: { gridColumn: leftCount + 1, gridRow: finalRow },\n            })}\n          {rightRounds.flatMap((round, idx) => {\n            const { right } = roundSplit(round);\n            const roundIndex = leftIndexMap[round] ?? 0;\n            const col = leftCount + 2 + idx;\n            const connectorHeight = right.length > 1 ? rowHeight * 2 ** roundIndex : 0;\n            return right.map((match, matchIdx) => {\n              const row = 2 ** roundIndex * (2 * matchIdx + 1);\n              const connectorDirection = matchIdx % 2 === 0 ? \"down\" : \"up\";\n              return renderListMatch(match, {\n                connectorSide: \"left\",\n                connectorDirection: connectorHeight ? connectorDirection : undefined,\n                connectorHeight: connectorHeight || undefined,\n                compact: options?.compact,\n                locked: roundIsLocked(round),\n                style: { gridColumn: col, gridRow: row },\n              });\n            });\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  const renderMobileFinalTree = (treeRounds: number[]) => {\n    if (treeRounds.length === 0) return null;\n    const finalRound = treeRounds[treeRounds.length - 1];\n    const semiRound = treeRounds.length > 1 ? treeRounds[treeRounds.length - 2] : null;\n    const finalMatch = (matchesByRound[finalRound] ?? []).slice().sort(compareBracketOrder)[0] ?? null;\n    const semiMatches = semiRound\n      ? (matchesByRound[semiRound] ?? []).slice().sort(compareBracketOrder)\n      : [];\n    return (\n      <div className=\"space-y-4\">\n        {semiRound && (\n          <div className=\"space-y-2\">\n            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">\n              {roundLabelMap[semiRound] || `Ronda ${semiRound}`}\n            </p>\n            <div className=\"grid gap-3 sm:grid-cols-2\">\n              {semiMatches.map((match) =>\n                renderListMatch(match, { locked: roundIsLocked(match.round ?? 0) }),\n              )}\n            </div>\n          </div>\n        )}\n        {finalMatch && (\n          <div className=\"space-y-2\">\n            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">\n              {roundLabelMap[finalRound] || `Ronda ${finalRound}`}\n            </p>\n            <div className=\"mx-auto max-w-sm\">\n              {renderListMatch(finalMatch, { final: true, accent: true, locked: roundIsLocked(finalRound) })}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (view === \"full\") {\n    return (\n      <div className=\"space-y-4\">\n        {rounds.map((round, idx) => (\n          <div key={`full-round-${round}`} className=\"space-y-2\">\n            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">\n              {roundLabels[idx] || `Ronda ${round}`}\n            </p>\n            {(matchesByRound[round] ?? [])\n              .slice()\n              .sort((a, b) => a.id - b.id)\n              .map((match) => renderListMatch(match, { locked: roundIsLocked(match.round ?? 0) }))}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div className=\"flex min-w-0 flex-1 items-center gap-2 overflow-x-auto py-1\">\n          {rounds.map((round) => {\n            const isActive = activeRound === round;\n            const isLiveRound = roundHasLive(round);\n            const isCompleted = roundIsComplete(round);\n            const isLocked = roundIsLocked(round);\n            const isCurrent = round === currentRound;\n            const tone = isCompleted\n              ? \"border-purple-400/60 bg-purple-500/15 text-purple-100\"\n              : isLiveRound || isCurrent\n                ? \"border-emerald-400/60 bg-emerald-500/15 text-emerald-100\"\n                : isLocked\n                  ? \"border-white/10 bg-white/5 text-white/40\"\n                  : \"border-white/15 bg-white/5 text-white/60\";\n            return (\n              <button\n                key={`round-tab-${round}`}\n                type=\"button\"\n                onClick={() => {\n                  if (!isLocked) setActiveRound(round);\n                }}\n                disabled={isLocked}\n                className={`shrink-0 rounded-full border px-3 py-1 text-[11px] uppercase tracking-[0.18em] ${tone} ${\n                  isLocked ? \"cursor-not-allowed\" : \"hover:border-white/40\"\n                } ${isActive ? \"ring-1 ring-white/30\" : \"\"}`}\n              >\n                <span>{roundLabelMap[round] || `Ronda ${round}`}</span>\n                {isCompleted && (\n                  <span className=\"ml-2 rounded-full border border-purple-400/50 bg-purple-500/20 px-1.5 py-0.5 text-[10px] text-purple-100\">\n                    Concluida\n                  </span>\n                )}\n                {!isCompleted && isLiveRound && (\n                  <span className=\"ml-2 rounded-full border border-emerald-400/50 bg-emerald-500/20 px-1.5 py-0.5 text-[10px] text-emerald-100\">\n                    Live\n                  </span>\n                )}\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      <div className=\"hidden md:block\">\n        {showDesktopTree ? (\n          <div className=\"space-y-3\">\n            {renderSymmetricTreeGrid(desktopTreeRounds, {\n              compact: true,\n              rowHeight: 32,\n              minColWidth: 140,\n              accentRound: activeRound === finalRound ? finalRound : null,\n            })}\n          </div>\n        ) : (\n          <div className=\"grid gap-3 md:grid-cols-2\">\n            <div className=\"space-y-3\">\n              {leftMatches.map((match) =>\n                renderListMatch(match, { locked: roundIsLocked(match.round ?? 0) })\n              )}\n            </div>\n            <div className=\"space-y-3\">\n              {rightMatches.map((match) =>\n                renderListMatch(match, { locked: roundIsLocked(match.round ?? 0) })\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"md:hidden\">\n        {showMobileTree ? (\n          <div className=\"space-y-3\">{renderMobileFinalTree(mobileTreeRounds)}</div>\n        ) : (\n          <div className=\"space-y-3\">\n            {activeMatchesSorted.map((match) =>\n              renderListMatch(match, { locked: roundIsLocked(match.round ?? 0) })\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction OneVOneBracket({\n  stage,\n  pairings,\n  eventStatus,\n  isOrganizerEdit,\n  tournamentId,\n  onUpdated,\n  goalLimits,\n  canResolveDispute,\n}: {\n  stage: { matches?: MatchPayload[]; name?: string | null } | null;\n  pairings: Record<number, PairingMeta>;\n  eventStatus: string;\n  isOrganizerEdit: boolean;\n  tournamentId: number | null;\n  onUpdated: () => void;\n  goalLimits: GoalLimitsConfig;\n  canResolveDispute?: boolean;\n}) {\n  if (!stage || !stage.matches || stage.matches.length === 0) {\n    return (\n      <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 text-white/70\">\n        <p className=\"text-[11px] uppercase tracking-[0.3em] text-white/50\">Bracket</p>\n        <h2 className=\"mt-2 text-xl font-semibold text-white\">Chave em preparação</h2>\n        <p className=\"text-sm text-white/60\">Em breve os jogos vão aparecer aqui.</p>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div>\n          <p className=\"text-[11px] uppercase tracking-[0.3em] text-white/50\">Bracket</p>\n          <h2 className=\"text-xl font-semibold text-white\">{stage.name || \"Eliminatórias 1v1\"}</h2>\n        </div>\n        <span className=\"text-xs text-white/50\">{eventStatus === \"Próximo\" ? \"Pré-evento\" : \"Ao vivo\"}</span>\n      </div>\n      <BracketRoundsView\n        matches={stage.matches}\n        pairings={pairings}\n        isOrganizerEdit={isOrganizerEdit}\n        tournamentId={tournamentId}\n        onUpdated={onUpdated}\n        goalLimits={goalLimits}\n        canResolveDispute={canResolveDispute}\n      />\n    </section>\n  );\n}\n\nfunction OneVOneLiveLayout({\n  event,\n  organizer,\n  tournament,\n  pairings,\n  timeZone,\n  eventStatus,\n  countdownLabel,\n  nowMatch,\n  championLabel,\n  sponsors,\n  onToggleFollow,\n  followPending,\n  isFollowing,\n  showSponsors,\n  isOrganizerEdit,\n  canManageLiveConfig,\n  canResolveDispute,\n  onRefresh,\n  variant = \"full\",\n}: {\n  event: EventPayload;\n  organizer: { id: number; publicName: string; username: string | null; brandingAvatarUrl: string | null } | null;\n  tournament: any;\n  pairings: Record<number, PairingMeta>;\n  timeZone: string;\n  eventStatus: string;\n  countdownLabel: string | null;\n  nowMatch: MatchPayload | null;\n  championLabel: string | null;\n  sponsors: SponsorsConfig;\n  onToggleFollow: () => void;\n  followPending: boolean;\n  isFollowing: boolean;\n  showSponsors: boolean;\n  isOrganizerEdit: boolean;\n  canManageLiveConfig: boolean;\n  canResolveDispute: boolean;\n  onRefresh: () => void;\n  variant?: \"full\" | \"inline\";\n}) {\n  const streamEmbed = getStreamEmbed(event.liveStreamUrl);\n  const embedUrl = streamEmbed.embedUrl;\n  const streamHref = streamEmbed.href;\n  const streamLabel =\n    streamEmbed.provider === \"youtube\"\n      ? \"Abrir no YouTube\"\n      : streamEmbed.provider === \"twitch\"\n        ? \"Abrir na Twitch\"\n        : \"Abrir stream\";\n  const [streamUrl, setStreamUrl] = useState(event.liveStreamUrl ?? \"\");\n  const [savingConfig, setSavingConfig] = useState(false);\n  const [configMessage, setConfigMessage] = useState<string | null>(null);\n  const [sponsorDraft, setSponsorDraft] = useState<SponsorsConfig>(sponsors ?? {});\n  const [goalLimitsDraft, setGoalLimitsDraft] = useState<GoalLimitsConfig>(\n    normalizeGoalLimits(tournament?.goalLimits as GoalLimitsConfig),\n  );\n  const [activeTab, setActiveTab] = useState<\"chat\" | \"stats\" | \"rules\">(\"chat\");\n  const featuredMatchId = typeof tournament?.featuredMatchId === \"number\" ? tournament.featuredMatchId : null;\n  const bracketStage =\n    tournament?.stages?.find((s: any) => s.stageType === \"PLAYOFF\" && s.matches?.length) ??\n    tournament?.stages?.find((s: any) => s.matches?.length) ??\n    null;\n  const flatMatches: MatchPayload[] = tournament?.stages\n    ? tournament.stages.flatMap((s: any) => [...s.matches, ...(s.groups ?? []).flatMap((g: any) => g.matches)])\n    : [];\n  const firstRoundMatches = bracketStage?.matches?.filter((m: MatchPayload) => (m.round ?? 0) === 1) ?? [];\n  const playerCount = firstRoundMatches.length ? firstRoundMatches.length * 2 : null;\n  const locationLabel = [event.locationCity, event.locationName].filter(Boolean).join(\" · \");\n\n  const nowLabelParts = nowMatch\n    ? [pairingLabelPlain(nowMatch.pairing1Id, pairings), pairingLabelPlain(nowMatch.pairing2Id, pairings)].filter(Boolean)\n    : [];\n  const nowLabel = nowLabelParts.length ? nowLabelParts.join(\" vs \") : null;\n  const scoreLabel = nowMatch ? formatScore(nowMatch.score) : null;\n  const heroStatus =\n    eventStatus === \"A decorrer\"\n      ? `Ao vivo${nowLabel ? ` · Agora a jogar: ${nowLabel}${scoreLabel && scoreLabel !== \"—\" ? ` (${scoreLabel})` : \"\"}` : \"\"}`\n      : eventStatus === \"Concluído\"\n        ? championLabel\n          ? `Concluído · Campeão: ${championLabel}`\n          : \"Concluído\"\n        : \"A live começa em breve\";\n\n  const hasHeroSponsor = Boolean(sponsors?.hero?.logoUrl || sponsors?.hero?.label);\n  const nowSponsor = sponsors?.nowPlaying ?? null;\n  const sideSponsors = [sponsors?.sideA, sponsors?.sideB].filter(\n    (slot) => slot && (slot.logoUrl || slot.label),\n  ) as SponsorSlot[];\n  const goalLimits = normalizeGoalLimits(tournament?.goalLimits as GoalLimitsConfig);\n  const goalDefaultLimit = goalLimits?.defaultLimit ?? 3;\n  const goalRoundOverrides = goalLimits?.roundLimits ?? null;\n  const roundNumbers = bracketStage?.matches\n    ? Array.from(new Set(bracketStage.matches.map((m: MatchPayload) => m.round ?? 0))).filter((r) => r > 0).sort((a, b) => a - b)\n    : [];\n  const roundLabels = buildRoundLabels(roundNumbers.length);\n  const roundLabelMap = roundNumbers.reduce((acc, round, idx) => {\n    acc[round] = roundLabels[idx] || `Ronda ${round}`;\n    return acc;\n  }, {} as Record<number, string>);\n  const nowSummary = nowMatch ? getScoreSummary(nowMatch.score) : null;\n  const nowWinnerSide = nowMatch && nowMatch.status === \"DONE\" ? getWinnerSide(nowMatch.score) : null;\n  const nowIsLive = nowMatch ? nowMatch.status === \"IN_PROGRESS\" || nowMatch.status === \"LIVE\" : false;\n  const nowMetaA = nowMatch ? pairingMeta(nowMatch.pairing1Id, pairings) : null;\n  const nowMetaB = nowMatch ? pairingMeta(nowMatch.pairing2Id, pairings) : null;\n  const nowLabelA = nowMetaA?.label ?? \"\";\n  const nowLabelB = nowMetaB?.label ?? \"\";\n  const nowDisplayLabelA = nowLabelA.length > 16 ? nowLabelA.slice(0, 16) : nowLabelA;\n  const nowDisplayLabelB = nowLabelB.length > 16 ? nowLabelB.slice(0, 16) : nowLabelB;\n  const nowAvatarA = nowMetaA?.avatarUrl || DEFAULT_GUEST_AVATAR;\n  const nowAvatarB = nowMetaB?.avatarUrl || DEFAULT_GUEST_AVATAR;\n  const nowScoreA = nowSummary ? nowSummary.a : 0;\n  const nowScoreB = nowSummary ? nowSummary.b : 0;\n  const overrideActive = Boolean(featuredMatchId && nowMatch?.id === featuredMatchId);\n  const [featuredDraft, setFeaturedDraft] = useState<number | null>(featuredMatchId);\n\n  useEffect(() => {\n    setStreamUrl(event.liveStreamUrl ?? \"\");\n  }, [event.liveStreamUrl]);\n\n  useEffect(() => {\n    setSponsorDraft(sponsors ?? {});\n  }, [sponsors]);\n\n  useEffect(() => {\n    setGoalLimitsDraft(normalizeGoalLimits(tournament?.goalLimits as GoalLimitsConfig));\n  }, [tournament?.goalLimits]);\n\n  useEffect(() => {\n    setFeaturedDraft(featuredMatchId);\n  }, [featuredMatchId]);\n\n  const saveFeaturedMatch = async (matchId: number | null) => {\n    if (!tournament?.id) return;\n    setSavingConfig(true);\n    setConfigMessage(null);\n    try {\n      await fetch(`/api/organizador/tournaments/${tournament.id}/featured-match`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ matchId }),\n      });\n      setConfigMessage(matchId ? \"Override aplicado.\" : \"Override removido.\");\n      onRefresh();\n    } catch {\n      setConfigMessage(\"Erro ao atualizar override.\");\n    } finally {\n      setSavingConfig(false);\n      setTimeout(() => setConfigMessage(null), 2000);\n    }\n  };\n\n  const saveLiveConfig = async () => {\n    setSavingConfig(true);\n    setConfigMessage(null);\n    try {\n      if (streamUrl.trim() !== (event.liveStreamUrl ?? \"\")) {\n        await fetch(\"/api/organizador/events/update\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            eventId: event.id,\n            liveStreamUrl: streamUrl.trim() || null,\n          }),\n        });\n      }\n      if (tournament?.id) {\n        await fetch(`/api/organizador/tournaments/${tournament.id}/sponsors`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            hero: sponsorDraft?.hero ?? null,\n            sideA: sponsorDraft?.sideA ?? null,\n            sideB: sponsorDraft?.sideB ?? null,\n            nowPlaying: sponsorDraft?.nowPlaying ?? null,\n          }),\n        });\n        await fetch(`/api/organizador/tournaments/${tournament.id}/rules`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            defaultLimit: goalLimitsDraft?.defaultLimit ?? null,\n            roundLimits: goalLimitsDraft?.roundLimits ?? {},\n          }),\n        });\n      }\n      setConfigMessage(\"Configuração guardada.\");\n      onRefresh();\n    } catch {\n      setConfigMessage(\"Erro ao guardar configuração.\");\n    } finally {\n      setSavingConfig(false);\n      setTimeout(() => setConfigMessage(null), 2000);\n    }\n  };\n\n  const updateDefaultLimit = (value: string) => {\n    const next = value === \"\" ? null : Number(value);\n    if (value !== \"\" && !Number.isFinite(next)) return;\n    setGoalLimitsDraft((prev) => ({\n      ...(prev ?? {}),\n      defaultLimit: next,\n      roundLimits: prev?.roundLimits ?? null,\n    }));\n  };\n\n  const updateRoundLimit = (round: number, value: string) => {\n    const next = value === \"\" ? null : Number(value);\n    if (value !== \"\" && !Number.isFinite(next)) return;\n    setGoalLimitsDraft((prev) => {\n      const roundLimits = { ...(prev?.roundLimits ?? {}) };\n      if (next === null) {\n        delete roundLimits[String(round)];\n      } else {\n        roundLimits[String(round)] = next;\n      }\n      return {\n        ...(prev ?? {}),\n        roundLimits: Object.keys(roundLimits).length ? roundLimits : null,\n      };\n    });\n  };\n\n  const heroSponsorSection = hasHeroSponsor ? (\n    <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n      <a\n        href={sponsors?.hero?.url || undefined}\n        target={sponsors?.hero?.url ? \"_blank\" : undefined}\n        rel={sponsors?.hero?.url ? \"noreferrer\" : undefined}\n        className=\"flex items-center justify-between gap-4\"\n      >\n        <div className=\"space-y-1\">\n          <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Sponsor principal</p>\n          {sponsors?.hero?.label && <p className=\"text-white/80\">{sponsors.hero.label}</p>}\n        </div>\n        {sponsors?.hero?.logoUrl && (\n          // eslint-disable-next-line @next/next/no-img-element\n          <img\n            src={sponsors.hero.logoUrl}\n            alt={sponsors.hero.label || \"Sponsor\"}\n            className=\"h-10 w-auto rounded-xl border border-white/10 bg-white/5 px-3 py-2 object-contain\"\n          />\n        )}\n      </a>\n    </section>\n  ) : null;\n\n  const nowPlayingSection = (\n    <section className=\"rounded-3xl border border-white/10 bg-white/5 p-5 space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-white\">Agora a jogar</h3>\n        <div className=\"flex items-center gap-2 text-xs text-white/50\">\n          {overrideActive && (\n            <span className=\"rounded-full border border-white/15 bg-white/5 px-2 py-0.5 text-[10px] uppercase tracking-[0.2em] text-white/70\">\n              Override\n            </span>\n          )}\n          <span>{nowMatch ? (nowIsLive ? \"Ao vivo\" : \"Ultimo resultado\") : \"Sem destaque\"}</span>\n        </div>\n      </div>\n      {nowSponsor && (\n        <div className=\"flex items-center justify-between rounded-2xl border border-white/10 bg-black/30 px-3 py-2 text-[11px] text-white/70\">\n          <span className=\"uppercase tracking-[0.2em] text-white/50\">Sponsor do jogo</span>\n          <div className=\"flex items-center gap-2\">\n            {nowSponsor.logoUrl && (\n              // eslint-disable-next-line @next/next/no-img-element\n              <img\n                src={nowSponsor.logoUrl}\n                alt={nowSponsor.label || \"Sponsor\"}\n                className=\"h-7 w-auto rounded-lg border border-white/10 bg-white/5 px-2 py-1 object-contain\"\n              />\n            )}\n            {nowSponsor.label && <span>{nowSponsor.label}</span>}\n          </div>\n        </div>\n      )}\n      {!nowMatch && <p className=\"text-sm text-white/60\">Sem jogos em curso.</p>}\n      {nowMatch && (\n        <div\n          className={`rounded-2xl border p-4 ${\n            nowIsLive ? \"border-emerald-400/50 bg-emerald-500/10\" : \"border-white/10 bg-black/20\"\n          }`}\n        >\n          <div className=\"grid items-center gap-6 md:grid-cols-[1fr_auto_1fr]\">\n            <div className=\"flex flex-col items-center gap-2\">\n              <div\n                className={`h-20 w-20 rounded-full border border-white/10 bg-white/10 bg-cover bg-center ${\n                  nowWinnerSide === \"A\" ? \"ring-2 ring-emerald-400/60 shadow-[0_0_20px_rgba(16,185,129,0.35)]\" : \"\"\n                }`}\n                style={{ backgroundImage: `url(${nowAvatarA})` }}\n              />\n              <span className=\"max-w-[140px] truncate text-sm text-white/85\" title={nowLabelA}>\n                {nowDisplayLabelA}\n              </span>\n              <span\n                className={`text-3xl font-semibold ${\n                  nowWinnerSide === \"A\" ? \"text-emerald-300\" : nowWinnerSide ? \"text-rose-300\" : \"text-white/70\"\n                }`}\n              >\n                {nowScoreA}\n              </span>\n            </div>\n            <div className=\"flex flex-col items-center gap-2 text-center\">\n              <span className=\"text-[11px] uppercase tracking-[0.3em] text-white/50\">\n                {nowIsLive ? \"Agora a jogar\" : \"Resultado\"}\n              </span>\n              <span className=\"text-sm font-semibold text-white/80\">VS</span>\n            </div>\n            <div className=\"flex flex-col items-center gap-2\">\n              <div\n                className={`h-20 w-20 rounded-full border border-white/10 bg-white/10 bg-cover bg-center ${\n                  nowWinnerSide === \"B\" ? \"ring-2 ring-emerald-400/60 shadow-[0_0_20px_rgba(16,185,129,0.35)]\" : \"\"\n                }`}\n                style={{ backgroundImage: `url(${nowAvatarB})` }}\n              />\n              <span className=\"max-w-[140px] truncate text-sm text-white/85\" title={nowLabelB}>\n                {nowDisplayLabelB}\n              </span>\n              <span\n                className={`text-3xl font-semibold ${\n                  nowWinnerSide === \"B\" ? \"text-emerald-300\" : nowWinnerSide ? \"text-rose-300\" : \"text-white/70\"\n                }`}\n              >\n                {nowScoreB}\n              </span>\n            </div>\n          </div>\n        </div>\n      )}\n    </section>\n  );\n\n  if (variant === \"inline\") {\n    return (\n      <div className=\"space-y-4\">\n        {heroSponsorSection}\n        {nowPlayingSection}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      <header className=\"rounded-3xl border border-white/10 bg-[radial-gradient(circle_at_top,rgba(99,102,241,0.2),transparent_55%),linear-gradient(135deg,rgba(6,8,20,0.9),rgba(15,18,35,0.8))] p-6 text-center\">\n        <p className=\"text-[12px] uppercase tracking-[0.45em] text-white/50\">Live</p>\n        <h1 className=\"mt-2 text-3xl font-semibold text-white md:text-4xl\">{event.title} — Live</h1>\n        <p className=\"mt-2 text-sm text-white/60\">\n          {locationLabel}\n          {playerCount ? ` · ${playerCount} jogadores` : \"\"}\n          {\" · Eliminatórias 1v1\"}\n        </p>\n        <p className=\"mt-2 text-sm text-white/70\">{heroStatus}</p>\n        {eventStatus === \"Próximo\" && countdownLabel && (\n          <div className=\"mx-auto mt-4 inline-flex items-center gap-3 rounded-2xl border border-white/15 bg-white/5 px-4 py-2 text-sm text-white/80\">\n            <span className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">O evento começa em</span>\n            <span className=\"text-lg font-semibold text-white\">{countdownLabel}</span>\n          </div>\n        )}\n      </header>\n\n      {nowPlayingSection}\n\n      <div className={`grid gap-6 ${hasHeroSponsor ? \"lg:grid-cols-[1.6fr_1fr]\" : \"\"}`}>\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Live stream</p>\n              <h2 className=\"text-lg font-semibold text-white\">{embedUrl ? \"Em direto\" : \"Live em breve\"}</h2>\n            </div>\n            {eventStatus === \"A decorrer\" && (\n              <span className=\"rounded-full border border-rose-400/50 bg-rose-500/10 px-3 py-1 text-[11px] uppercase tracking-[0.2em] text-rose-200\">\n                Live\n              </span>\n            )}\n          </div>\n          {embedUrl ? (\n            <div className=\"aspect-video w-full overflow-hidden rounded-2xl border border-white/10 bg-black\">\n              <iframe\n                src={embedUrl}\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n                className=\"h-full w-full\"\n                title=\"Live stream\"\n              />\n            </div>\n          ) : (\n            <div className=\"rounded-2xl border border-white/10 bg-black/40 p-6 text-sm text-white/70\">\n              A live vai começar em breve. Assim que o link estiver ativo aparece aqui.\n            </div>\n          )}\n          {!embedUrl && streamHref && (\n            <a\n              href={streamHref}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n              className=\"rounded-full border border-white/15 px-4 py-2 text-sm text-white/80 hover:border-white/40\"\n            >\n              {streamLabel}\n            </a>\n          )}\n          {!embedUrl && organizer && (\n            <button\n              type=\"button\"\n              disabled={followPending}\n              onClick={onToggleFollow}\n              className=\"rounded-full border border-white/20 px-4 py-2 text-sm text-white/80 hover:border-white/40 disabled:opacity-60\"\n            >\n              {followPending ? \"A atualizar…\" : isFollowing ? \"A seguir\" : \"Segue para receber notificação\"}\n            </button>\n          )}\n          <div className=\"flex items-center gap-2 pt-2 text-[11px] uppercase tracking-[0.18em] text-white/50\">\n            {([\"chat\", \"stats\", \"rules\"] as const).map((tab) => (\n              <button\n                key={tab}\n                type=\"button\"\n                onClick={() => setActiveTab(tab)}\n                className={`rounded-full border px-3 py-1 ${\n                  activeTab === tab\n                    ? \"border-fuchsia-400/40 bg-fuchsia-500/10 text-fuchsia-100\"\n                    : \"border-white/15 bg-white/5 text-white/60\"\n                }`}\n              >\n                {tab === \"chat\" ? \"Chat\" : tab === \"stats\" ? \"Stats\" : \"Regras\"}\n              </button>\n            ))}\n          </div>\n          <div className=\"rounded-2xl border border-white/10 bg-black/30 p-4 text-sm text-white/70\">\n            {activeTab === \"chat\" && \"Chat disponível em breve.\"}\n            {activeTab === \"stats\" && \"Stats do torneio em breve.\"}\n            {activeTab === \"rules\" && (\n              <ul className=\"space-y-1 text-sm text-white/70\">\n                <li>Jogo a eliminar direto (1v1).</li>\n                <li>Vence quem chega primeiro ao limite de golos.</li>\n                <li>Limite padrão: {goalDefaultLimit} golos.</li>\n                {goalRoundOverrides && (\n                  <li>Existem limites por ronda configurados pelo organizador.</li>\n                )}\n                <li>Fair play obrigatório.</li>\n                <li>Decisões do staff são finais.</li>\n              </ul>\n            )}\n          </div>\n        </section>\n\n        {heroSponsorSection}\n      </div>\n\n      <OneVOneBracket\n        stage={bracketStage}\n        pairings={pairings}\n        eventStatus={eventStatus}\n        isOrganizerEdit={isOrganizerEdit}\n        tournamentId={tournament?.id ?? null}\n        onUpdated={onRefresh}\n        goalLimits={tournament?.goalLimits as GoalLimitsConfig}\n        canResolveDispute={canResolveDispute}\n      />\n\n      {sideSponsors.length > 0 && (\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n          <div className=\"grid gap-2 md:grid-cols-2\">\n            {sideSponsors.map((slot, idx) => (\n              <a\n                key={`side-sponsor-${idx}`}\n                href={slot.url || undefined}\n                target={slot.url ? \"_blank\" : undefined}\n                rel={slot.url ? \"noreferrer\" : undefined}\n                className=\"flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-white/70\"\n              >\n                {slot.logoUrl && (\n                  // eslint-disable-next-line @next/next/no-img-element\n                  <img src={slot.logoUrl} alt={slot.label || \"Sponsor\"} className=\"h-8 w-auto object-contain\" />\n                )}\n                {slot.label && <span>{slot.label}</span>}\n              </a>\n            ))}\n          </div>\n        </section>\n      )}\n\n      {showSponsors && !hasHeroSponsor && sideSponsors.length === 0 && <SponsorsStrip organizer={organizer} />}\n\n      {isOrganizerEdit && (\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-base font-semibold text-white\">Live Ops (overlay)</h3>\n            <span className=\"text-xs text-white/50\">Organizador</span>\n          </div>\n          <div className=\"rounded-2xl border border-white/10 bg-black/30 p-3 space-y-2\">\n            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">Agora a jogar</p>\n            <div className=\"flex flex-wrap gap-2\">\n              <select\n                value={featuredDraft ?? \"\"}\n                onChange={(e) => {\n                  const value = e.target.value;\n                  setFeaturedDraft(value ? Number(value) : null);\n                }}\n                className=\"min-w-[220px] flex-1 rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n              >\n                <option value=\"\">Automático</option>\n                {flatMatches\n                  .filter((m) => m.pairing1Id && m.pairing2Id)\n                  .sort(compareMatchOrder)\n                  .map((match) => {\n                    const label = `${pairingLabelPlain(match.pairing1Id, pairings)} vs ${pairingLabelPlain(match.pairing2Id, pairings)}`;\n                    return (\n                      <option key={`featured-${match.id}`} value={match.id}>\n                        #{match.id} · {label || \"Jogo\"}\n                      </option>\n                    );\n                  })}\n              </select>\n              <button\n                type=\"button\"\n                disabled={savingConfig}\n                onClick={() => saveFeaturedMatch(featuredDraft ?? null)}\n                className=\"rounded-full border border-white/20 px-4 py-2 text-[12px] text-white/80 hover:border-white/40 disabled:opacity-60\"\n              >\n                {savingConfig ? \"A guardar…\" : \"Aplicar override\"}\n              </button>\n              <button\n                type=\"button\"\n                disabled={savingConfig}\n                onClick={() => saveFeaturedMatch(null)}\n                className=\"rounded-full border border-white/20 px-4 py-2 text-[12px] text-white/60 hover:border-white/40 disabled:opacity-60\"\n              >\n                Reset automático\n              </button>\n            </div>\n            {featuredMatchId && (\n              <p className=\"text-[11px] text-white/50\">Override ativo no jogo #{featuredMatchId}.</p>\n            )}\n          </div>\n          {configMessage && <p className=\"text-xs text-white/60\">{configMessage}</p>}\n          {canManageLiveConfig ? (\n            <>\n              <div className=\"grid gap-3 md:grid-cols-2\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm text-white/70\">URL da livestream</label>\n                  <input\n                    value={streamUrl}\n                    onChange={(e) => setStreamUrl(e.target.value)}\n                    placeholder=\"https://youtube.com/...\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                  {streamUrl && (\n                    <a\n                      href={streamUrl}\n                      target=\"_blank\"\n                      rel=\"noreferrer\"\n                      className=\"text-xs text-white/60 hover:text-white\"\n                    >\n                      Testar embed ↗\n                    </a>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm text-white/70\">Sponsor principal</label>\n                  <input\n                    value={sponsorDraft?.hero?.label ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        hero: { ...(prev?.hero ?? {}), label: e.target.value },\n                      }))\n                    }\n                    placeholder=\"Nome do sponsor\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                  <input\n                    value={sponsorDraft?.hero?.logoUrl ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        hero: { ...(prev?.hero ?? {}), logoUrl: e.target.value },\n                      }))\n                    }\n                    placeholder=\"URL do logo\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                  <input\n                    value={sponsorDraft?.hero?.url ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        hero: { ...(prev?.hero ?? {}), url: e.target.value },\n                      }))\n                    }\n                    placeholder=\"Link (site/Instagram)\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm text-white/70\">Sponsor agora a jogar</label>\n                  <input\n                    value={sponsorDraft?.nowPlaying?.label ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        nowPlaying: { ...(prev?.nowPlaying ?? {}), label: e.target.value },\n                      }))\n                    }\n                    placeholder=\"Nome do sponsor\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                  <input\n                    value={sponsorDraft?.nowPlaying?.logoUrl ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        nowPlaying: { ...(prev?.nowPlaying ?? {}), logoUrl: e.target.value },\n                      }))\n                    }\n                    placeholder=\"URL do logo\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                  <input\n                    value={sponsorDraft?.nowPlaying?.url ?? \"\"}\n                    onChange={(e) =>\n                      setSponsorDraft((prev) => ({\n                        ...(prev ?? {}),\n                        nowPlaying: { ...(prev?.nowPlaying ?? {}), url: e.target.value },\n                      }))\n                    }\n                    placeholder=\"Link (site/Instagram)\"\n                    className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid gap-3 md:grid-cols-2\">\n                {([\"sideA\", \"sideB\"] as Array<\"sideA\" | \"sideB\">).map((slotKey) => {\n                  const slot = sponsorDraft?.[slotKey] ?? null;\n                  return (\n                    <div key={slotKey} className=\"space-y-2\">\n                      <label className=\"text-sm text-white/70\">\n                        Sponsor {slotKey === \"sideA\" ? \"secundário A\" : \"secundário B\"}\n                      </label>\n                      <input\n                        value={slot?.label ?? \"\"}\n                        onChange={(e) =>\n                          setSponsorDraft((prev) => ({\n                            ...(prev ?? {}),\n                            [slotKey]: { ...(slot ?? {}), label: e.target.value },\n                          }))\n                        }\n                        placeholder=\"Nome\"\n                        className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                      />\n                      <input\n                        value={slot?.logoUrl ?? \"\"}\n                        onChange={(e) =>\n                          setSponsorDraft((prev) => ({\n                            ...(prev ?? {}),\n                            [slotKey]: { ...(slot ?? {}), logoUrl: e.target.value },\n                          }))\n                        }\n                        placeholder=\"URL do logo\"\n                        className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                      />\n                      <input\n                        value={slot?.url ?? \"\"}\n                        onChange={(e) =>\n                          setSponsorDraft((prev) => ({\n                            ...(prev ?? {}),\n                            [slotKey]: { ...(slot ?? {}), url: e.target.value },\n                          }))\n                        }\n                        placeholder=\"Link (site/Instagram)\"\n                        className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                      />\n                    </div>\n                  );\n                })}\n              </div>\n\n              <div className=\"rounded-2xl border border-white/10 bg-black/30 p-4 space-y-3\">\n                <div>\n                  <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Regras de golos</p>\n                  <h4 className=\"text-sm font-semibold text-white\">Limite por ronda</h4>\n                </div>\n                <div className=\"grid gap-2 sm:grid-cols-2\">\n                  <label className=\"space-y-1 text-sm text-white/70\">\n                    <span>Limite padrão</span>\n                    <input\n                      type=\"number\"\n                      min={1}\n                      value={goalLimitsDraft?.defaultLimit ?? \"\"}\n                      onChange={(e) => updateDefaultLimit(e.target.value)}\n                      placeholder=\"Ex: 3\"\n                      className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                    />\n                  </label>\n                  {roundNumbers.map((round) => (\n                    <label key={`round-limit-${round}`} className=\"space-y-1 text-sm text-white/70\">\n                      <span>{roundLabelMap[round] || `Ronda ${round}`}</span>\n                      <input\n                        type=\"number\"\n                        min={1}\n                        value={goalLimitsDraft?.roundLimits?.[String(round)] ?? \"\"}\n                        onChange={(e) => updateRoundLimit(round, e.target.value)}\n                        placeholder={`${goalDefaultLimit}`}\n                        className=\"w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                      />\n                    </label>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <button\n                  type=\"button\"\n                  disabled={savingConfig}\n                  onClick={saveLiveConfig}\n                  className=\"rounded-full border border-emerald-400/40 bg-emerald-500/10 px-4 py-2 text-sm text-emerald-100 hover:border-emerald-300/70 disabled:opacity-60\"\n                >\n                  {savingConfig ? \"A guardar…\" : \"Guardar configuração\"}\n                </button>\n              </div>\n            </>\n          ) : (\n            <p className=\"text-xs text-white/50\">Configuração avançada reservada a ADMIN.</p>\n          )}\n        </section>\n      )}\n    </div>\n  );\n}\n\nexport default function EventLiveClient({\n  slug,\n  variant = \"full\",\n}: {\n  slug: string;\n  variant?: \"full\" | \"inline\";\n}) {\n  const searchParams = useSearchParams();\n  const pathname = usePathname();\n  const { isLoggedIn } = useUser();\n  const { openModal } = useAuthModal();\n  const [showFullBracket, setShowFullBracket] = useState(false);\n  const [followPending, setFollowPending] = useState(false);\n  const [isFollowing, setIsFollowing] = useState(false);\n  const [startingMatchId, setStartingMatchId] = useState<number | null>(null);\n  const [startMessage, setStartMessage] = useState<string | null>(null);\n  const isTv = searchParams?.get(\"tv\") === \"1\";\n  const isOrganizerRoute = Boolean(pathname && pathname.startsWith(\"/organizador/\"));\n  const [nowMs, setNowMs] = useState(() => Date.now());\n\n  const url = useMemo(() => `/api/livehub/${slug}`, [slug]);\n  const { data, error, mutate } = useSWR(url, fetcher, { refreshInterval: 10000 });\n\n  const organizer = (data?.organizer as\n    | {\n        id: number;\n        publicName: string;\n        username: string | null;\n        brandingAvatarUrl: string | null;\n        liveHubPremiumEnabled?: boolean | null;\n        isFollowed?: boolean;\n      }\n    | null) ?? null;\n  const access = data?.access as\n    | {\n        liveHubAllowed?: boolean;\n        liveHubVisibility?: \"PUBLIC\" | \"PRIVATE\" | \"DISABLED\";\n      }\n    | undefined;\n  const tournament = data?.tournament ?? null;\n  const tournamentStages = useMemo(() => {\n    if (!tournament?.stages) return [];\n    return tournament.stages.map((stage: any) => {\n      const shouldResolve = stage.stageType === \"PLAYOFF\";\n      const matches = Array.isArray(stage.matches)\n        ? shouldResolve\n          ? resolveBracketAdvancement(stage.matches)\n          : stage.matches\n        : [];\n      return { ...stage, matches };\n    });\n  }, [tournament]);\n  const tournamentView = tournament ? { ...tournament, stages: tournamentStages } : null;\n  const pairings: Record<number, PairingMeta> = data?.pairings || {};\n\n  useEffect(() => {\n    setIsFollowing(Boolean(organizer?.isFollowed));\n  }, [organizer?.isFollowed]);\n\n  useEffect(() => {\n    const interval = setInterval(() => setNowMs(Date.now()), 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  if (error) {\n    return <div className=\"p-4 text-white/70\">Erro a carregar live.</div>;\n  }\n  if (!data) {\n    return <div className=\"p-4 text-white/70\">A carregar…</div>;\n  }\n  if (!data?.ok) {\n    return <div className=\"p-4 text-white/70\">Live indisponível para este evento.</div>;\n  }\n\n  const event: EventPayload = data.event;\n  const viewerRole: LiveHubViewerRole = data.viewerRole;\n  const canEditMatches = Boolean(data?.canEditMatches);\n  const organizerRole = typeof data?.organizerRole === \"string\" ? data.organizerRole : null;\n  const canManageLiveConfig =\n    organizerRole === \"OWNER\" || organizerRole === \"CO_OWNER\" || organizerRole === \"ADMIN\";\n  const canResolveDispute = canManageLiveConfig;\n  const liveHub = data.liveHub as { modules: LiveHubModule[]; mode: \"DEFAULT\" | \"PREMIUM\" };\n  const pairingIdFromQuery = searchParams?.get(\"pairingId\");\n  const showCourt = event.templateType === \"PADEL\";\n\n  if (access?.liveHubAllowed === false) {\n    const visibility = access?.liveHubVisibility ?? \"PUBLIC\";\n    const message =\n      visibility === \"DISABLED\"\n        ? \"O LiveHub foi desativado pelo organizador.\"\n        : visibility === \"PRIVATE\"\n          ? \"O LiveHub está reservado para participantes.\"\n          : \"O LiveHub está indisponível.\";\n    return (\n      <div className=\"rounded-3xl border border-white/10 bg-black/40 p-6 text-white/70 space-y-2\">\n        <p className=\"text-[11px] uppercase tracking-[0.3em] text-white/50\">Acesso reservado</p>\n        <h2 className=\"text-xl font-semibold text-white\">Este LiveHub não está disponível agora.</h2>\n        <p className=\"text-sm text-white/60\">{message}</p>\n      </div>\n    );\n  }\n\n  const timeZone = event.timezone || DEFAULT_TIMEZONE;\n\n  const ensureAuthForFollow = () => {\n    if (isLoggedIn) return true;\n    const redirectTo =\n      typeof window !== \"undefined\" ? `${window.location.pathname}${window.location.search}` : \"/\";\n    openModal({ mode: \"login\", redirectTo });\n    return false;\n  };\n\n  const toggleFollow = async () => {\n    if (!organizer) return;\n    if (!ensureAuthForFollow()) return;\n    const next = !isFollowing;\n    setFollowPending(true);\n    setIsFollowing(next);\n    try {\n      const res = await fetch(next ? \"/api/social/follow-organizer\" : \"/api/social/unfollow-organizer\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ organizerId: organizer.id }),\n      });\n      if (!res.ok) {\n        setIsFollowing(!next);\n      }\n    } catch {\n      setIsFollowing(!next);\n    } finally {\n      setFollowPending(false);\n    }\n  };\n\n  if (isTv && tournamentView) {\n    return (\n      <LiveHubTv event={event} tournament={tournamentView} pairings={pairings} timeZone={timeZone} showCourt={showCourt} />\n    );\n  }\n\n  const flatMatches: MatchPayload[] = tournamentView\n    ? tournamentView.stages.flatMap((s: any) => [...s.matches, ...s.groups.flatMap((g: any) => g.matches)])\n    : [];\n\n  const roundsGlobal = Array.from(new Set(flatMatches.map((m) => m.round ?? 0)))\n    .filter((r) => r > 0)\n    .sort((a, b) => a - b);\n  const roundIsCompleteGlobal = (round: number) => {\n    const list = flatMatches.filter((m) => (m.round ?? 0) === round);\n    return list.length > 0 && list.every((m) => m.status === \"DONE\");\n  };\n  const roundIsLockedGlobal = (round: number) => {\n    const idx = roundsGlobal.indexOf(round);\n    if (idx <= 0) return false;\n    return roundsGlobal.slice(0, idx).some((r) => !roundIsCompleteGlobal(r));\n  };\n\n  const liveMatches = flatMatches.filter((m) => m.status === \"IN_PROGRESS\" || m.status === \"LIVE\");\n  const completedMatches = flatMatches.filter((m) => m.status === \"DONE\");\n  const byUpdatedAtDesc = (a: MatchPayload, b: MatchPayload) =>\n    a.updatedAt && b.updatedAt ? new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime() : 0;\n  const latestCompletedMatch = completedMatches.slice().sort(byUpdatedAtDesc)[0] ?? null;\n  const defaultNowMatch = liveMatches.sort(compareMatchOrder)[0] ?? latestCompletedMatch;\n  const oneVOneOrderedMatches = flatMatches.slice().sort(compareBracketOrder);\n  const oneVOneLiveMatches = oneVOneOrderedMatches.filter((m) => m.status === \"IN_PROGRESS\" || m.status === \"LIVE\");\n  const oneVOneLatestCompleted = oneVOneOrderedMatches.filter((m) => m.status === \"DONE\").sort(byUpdatedAtDesc)[0] ?? null;\n  const oneVOneNowMatch = oneVOneLiveMatches[0] ?? oneVOneLatestCompleted;\n  const usePremium = liveHub?.mode === \"PREMIUM\";\n  const matchOrder = usePremium ? getCustomLiveHubMatchOrder(organizer) : null;\n  const useOneVOneOrdering = matchOrder === \"ONEVONE\";\n  const isOneVOne = useOneVOneOrdering;\n  const featuredMatchId = typeof tournamentView?.featuredMatchId === \"number\" ? tournamentView.featuredMatchId : null;\n  const featuredMatch = featuredMatchId ? flatMatches.find((m) => m.id === featuredMatchId) ?? null : null;\n  const featuredActive =\n    featuredMatch && featuredMatch.status !== \"DONE\" && featuredMatch.status !== \"CANCELLED\" ? featuredMatch : null;\n  const autoNowMatch = useOneVOneOrdering ? oneVOneNowMatch : defaultNowMatch;\n  const nowMatch = featuredActive ?? autoNowMatch;\n\n  const upcomingMatches = flatMatches\n    .filter((m) => m.status !== \"DONE\" && m.id !== (nowMatch?.id ?? -1))\n    .sort(compareMatchOrder)\n    .slice(0, 4);\n\n  const recentResults = flatMatches\n    .filter((m) => m.status === \"DONE\")\n    .sort((a, b) =>\n      a.updatedAt && b.updatedAt ? new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime() : 0,\n    )\n    .slice(0, 6);\n\n  const modules = liveHub?.modules ?? [];\n  const resolvedModules =\n    event.liveStreamUrl && !modules.includes(\"VIDEO\") ? [\"VIDEO\", ...modules] : modules;\n  const eventStatus = getEventStatusLabel(event.startsAt, event.endsAt);\n  const calendarLinks = event.startsAt ? buildCalendarLinks(event, timeZone) : null;\n  const countdownLabel = formatCountdown(event.startsAt, nowMs);\n  const goalLimits = normalizeGoalLimits(tournamentView?.goalLimits as GoalLimitsConfig);\n  const sponsors = (tournamentView?.sponsors as SponsorsConfig) ?? null;\n  const derivedChampionPairingId = (() => {\n    if (!tournamentView?.stages?.length) return null;\n    const playoffStages = tournamentView.stages.filter(\n      (stage: any) => stage.stageType === \"PLAYOFF\" && stage.matches?.length,\n    );\n    const bracketStage =\n      playoffStages[playoffStages.length - 1] ?? tournamentView.stages.find((stage: any) => stage.matches?.length);\n    if (!bracketStage?.matches?.length) return null;\n    const maxRound = Math.max(...bracketStage.matches.map((match: MatchPayload) => match.round ?? 0));\n    if (!Number.isFinite(maxRound) || maxRound <= 0) return null;\n    const finalMatch = bracketStage.matches\n      .filter((match: MatchPayload) => (match.round ?? 0) === maxRound)\n      .sort((a: MatchPayload, b: MatchPayload) => b.id - a.id)[0];\n    if (!finalMatch || finalMatch.status !== \"DONE\") return null;\n    const winnerSide = getWinnerSide(finalMatch.score);\n    if (!winnerSide) return null;\n    return winnerSide === \"A\" ? finalMatch.pairing1Id ?? null : finalMatch.pairing2Id ?? null;\n  })();\n  const championLabel = tournamentView?.championPairingId\n    ? pairingLabelPlain(tournamentView.championPairingId, pairings) || null\n    : derivedChampionPairingId\n      ? pairingLabelPlain(derivedChampionPairingId, pairings) || null\n      : null;\n  const isOrganizerEdit =\n    viewerRole === \"ORGANIZER\" && canEditMatches && isOrganizerRoute && searchParams?.get(\"edit\") === \"1\";\n  const organizerEditHref = (() => {\n    const base = isOrganizerRoute && pathname ? pathname : `/organizador/eventos/${event.id}/live`;\n    const params = new URLSearchParams(searchParams?.toString());\n    params.set(\"tab\", \"preview\");\n    params.set(\"edit\", \"1\");\n    return `${base}?${params.toString()}`;\n  })();\n  const pendingMatches = flatMatches\n    .filter((match) => match.status === \"PENDING\" || match.status === \"SCHEDULED\")\n    .sort(compareMatchOrder);\n  const firstPlayableMatch = pendingMatches.find((match) => match.pairing1Id && match.pairing2Id) ?? null;\n\n  const startFirstMatch = async () => {\n    if (!tournamentView || !firstPlayableMatch) {\n      setStartMessage(\"Sem jogos completos para iniciar.\");\n      return;\n    }\n    if (!firstPlayableMatch.updatedAt) {\n      setStartMessage(\"Sem versão do jogo.\");\n      return;\n    }\n    setStartingMatchId(firstPlayableMatch.id);\n    setStartMessage(null);\n    try {\n      const res = await fetch(\n        `/api/organizador/tournaments/${tournamentView.id}/matches/${firstPlayableMatch.id}/result`,\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            status: \"IN_PROGRESS\",\n            expectedUpdatedAt: firstPlayableMatch.updatedAt,\n          }),\n        },\n      );\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setStartMessage(json?.error || \"Erro ao começar o jogo.\");\n        return;\n      }\n      setStartMessage(\"Jogo iniciado.\");\n      mutate();\n    } catch {\n      setStartMessage(\"Erro ao começar o jogo.\");\n    } finally {\n      setStartingMatchId(null);\n    }\n  };\n  const nextPendingLabel = firstPlayableMatch\n    ? [pairingLabelPlain(firstPlayableMatch.pairing1Id, pairings), pairingLabelPlain(firstPlayableMatch.pairing2Id, pairings)]\n        .filter(Boolean)\n        .join(\" vs \")\n    : null;\n\n  if (variant === \"inline\" && !isOneVOne) {\n    const hero = sponsors?.hero;\n    const inlineStatus = nowMatch\n      ? nowMatch.status === \"IN_PROGRESS\" || nowMatch.status === \"LIVE\"\n        ? \"Ao vivo\"\n        : \"Ultimo resultado\"\n      : \"Sem destaque\";\n    return (\n      <div className=\"space-y-4\">\n        {hero && (\n          <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n            <a\n              href={hero.url || undefined}\n              target={hero.url ? \"_blank\" : undefined}\n              rel={hero.url ? \"noreferrer\" : undefined}\n              className=\"flex items-center justify-between gap-4\"\n            >\n              <div className=\"space-y-1\">\n                <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Sponsor principal</p>\n                {hero.label && <p className=\"text-white/80\">{hero.label}</p>}\n              </div>\n              {hero.logoUrl && (\n                // eslint-disable-next-line @next/next/no-img-element\n                <img\n                  src={hero.logoUrl}\n                  alt={hero.label || \"Sponsor\"}\n                  className=\"h-10 w-auto rounded-xl border border-white/10 bg-white/5 px-3 py-2 object-contain\"\n                />\n              )}\n            </a>\n          </section>\n        )}\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-lg font-semibold text-white\">Agora a jogar</h3>\n            <span className=\"text-xs text-white/50\">{inlineStatus}</span>\n          </div>\n          {!nowMatch && <p className=\"text-sm text-white/60\">Sem jogos em curso.</p>}\n          {nowMatch && (\n            <MatchCard\n              match={nowMatch}\n              pairings={pairings}\n              timeZone={timeZone}\n              size=\"lg\"\n              showCourt={showCourt}\n            />\n          )}\n        </section>\n      </div>\n    );\n  }\n\n  if (isOneVOne) {\n    const showSponsors = resolvedModules.includes(\"SPONSORS\");\n    return (\n      <div className=\"space-y-6\">\n        {variant === \"full\" && viewerRole === \"ORGANIZER\" && canEditMatches && isOrganizerRoute && !isOrganizerEdit && (\n          <div className=\"rounded-3xl border border-white/10 bg-white/5 p-4 text-sm text-white/70\">\n            Estás em modo público.{\" \"}\n            <Link href={organizerEditHref} className=\"text-white underline\">\n              Ativar overlay do organizador\n            </Link>\n            .\n          </div>\n        )}\n        {variant === \"full\" && viewerRole === \"ORGANIZER\" && canEditMatches && isOrganizerRoute && (\n          <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <div className=\"space-y-1\">\n                <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">Arranque</p>\n                <p className=\"text-sm text-white/70\">Começa o primeiro jogo pendente.</p>\n                {nextPendingLabel && (\n                  <p className=\"text-[11px] text-white/50\">Próximo: {nextPendingLabel}</p>\n                )}\n              </div>\n              <button\n                type=\"button\"\n                onClick={startFirstMatch}\n                disabled={!firstPlayableMatch || Boolean(startingMatchId)}\n                className=\"rounded-full border border-emerald-400/40 bg-emerald-500/10 px-4 py-2 text-[12px] font-semibold text-emerald-100 hover:border-emerald-300/70 disabled:opacity-60\"\n              >\n                {startingMatchId ? \"A iniciar…\" : \"Começar jogos\"}\n              </button>\n            </div>\n            {startMessage && <p className=\"mt-2 text-[11px] text-white/60\">{startMessage}</p>}\n          </section>\n        )}\n        <OneVOneLiveLayout\n          event={event}\n          organizer={organizer}\n          tournament={tournamentView}\n          pairings={pairings}\n          timeZone={timeZone}\n          eventStatus={eventStatus}\n          countdownLabel={countdownLabel}\n          nowMatch={nowMatch}\n          championLabel={championLabel}\n          sponsors={sponsors}\n          onToggleFollow={toggleFollow}\n          followPending={followPending}\n          isFollowing={isFollowing}\n          showSponsors={showSponsors}\n          isOrganizerEdit={isOrganizerEdit}\n          canManageLiveConfig={canManageLiveConfig}\n          canResolveDispute={canResolveDispute}\n          onRefresh={() => mutate()}\n          variant={variant}\n        />\n\n      </div>\n    );\n  }\n\n  const renderModule = (mod: LiveHubModule) => {\n    switch (mod) {\n      case \"HERO\": {\n        const statusTone =\n          eventStatus === \"A decorrer\"\n            ? \"border-emerald-400/40 bg-emerald-500/10 text-emerald-100\"\n            : eventStatus === \"Próximo\"\n              ? \"border-sky-400/40 bg-sky-500/10 text-sky-100\"\n              : eventStatus === \"Concluído\"\n                ? \"border-amber-300/40 bg-amber-400/10 text-amber-100\"\n                : \"border-white/15 bg-white/5 text-white/70\";\n        return (\n          <section key=\"hero\" className=\"rounded-3xl border border-white/10 bg-black/40 p-5 space-y-4\">\n            <div className=\"flex flex-wrap items-start justify-between gap-4\">\n              <div className=\"space-y-2\">\n                <p className=\"text-[11px] uppercase tracking-[0.3em] text-white/60\">LiveHub</p>\n                <h1 className=\"text-2xl font-semibold text-white md:text-3xl\">{event.title}</h1>\n                <p className=\"text-white/70 text-sm\">{formatDateRange(event.startsAt, event.endsAt, timeZone)}</p>\n                {event.locationName && (\n                  <p className=\"text-white/50 text-sm\">\n                    {event.locationName}{event.locationCity ? ` · ${event.locationCity}` : \"\"}\n                  </p>\n                )}\n                {eventStatus === \"Próximo\" && countdownLabel && (\n                  <p className=\"text-sm text-white/60\">Começa em {countdownLabel}</p>\n                )}\n              </div>\n              <div className=\"flex flex-wrap items-center gap-2\">\n                <RoleBadge role={viewerRole} />\n                <span className={`rounded-full border px-3 py-1 text-[11px] uppercase tracking-[0.2em] ${statusTone}`}>\n                  {eventStatus}\n                </span>\n                <span className=\"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] uppercase tracking-[0.2em] text-white/60\">\n                  Modo automático\n                </span>\n                {calendarLinks && (\n                  <a\n                    href={calendarLinks.ics}\n                    download={`${event.slug || \"evento\"}.ics`}\n                    className=\"rounded-full border border-white/15 px-3 py-1 text-[11px] uppercase tracking-[0.2em] text-white/70 hover:border-white/40\"\n                  >\n                    Adicionar ao calendário\n                  </a>\n                )}\n              </div>\n            </div>\n\n            {organizer && (\n              <div className=\"flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-4 py-3\">\n                <div className=\"h-10 w-10 overflow-hidden rounded-full border border-white/10 bg-white/10\">\n                  {organizer.brandingAvatarUrl ? (\n                    // eslint-disable-next-line @next/next/no-img-element\n                    <img src={organizer.brandingAvatarUrl} alt=\"Organizador\" className=\"h-full w-full object-cover\" />\n                  ) : (\n                    <div className=\"flex h-full w-full items-center justify-center text-xs text-white/60\">\n                      {organizer.publicName?.slice(0, 2) ?? \"OR\"}\n                    </div>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">Organizado por</p>\n                  <p className=\"text-white font-medium\">{organizer.publicName}</p>\n                  {organizer.username && <p className=\"text-white/50 text-xs\">@{organizer.username}</p>}\n                </div>\n              </div>\n            )}\n          </section>\n        );\n      }\n      case \"VIDEO\": {\n        const streamEmbed = getStreamEmbed(event.liveStreamUrl);\n        const embedUrl = streamEmbed.embedUrl;\n        const streamHref = streamEmbed.href;\n        const streamLabel =\n          streamEmbed.provider === \"youtube\"\n            ? \"Abrir no YouTube\"\n            : streamEmbed.provider === \"twitch\"\n              ? \"Abrir na Twitch\"\n              : \"Abrir stream\";\n        if (!embedUrl) {\n          return (\n            <section key=\"video\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n              <div>\n                <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Live</p>\n                <h2 className=\"text-lg font-semibold text-white\">Live stream em breve</h2>\n              </div>\n              <p className=\"text-sm text-white/60\">\n                Ainda não existe uma livestream ativa. Assim que o link estiver disponível, aparece aqui.\n              </p>\n              {streamHref && (\n                <a\n                  href={streamHref}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"rounded-full border border-white/15 px-3 py-1 text-xs text-white/70 hover:border-white/40\"\n                >\n                  {streamLabel}\n                </a>\n              )}\n              {organizer && (\n                <button\n                  type=\"button\"\n                  disabled={followPending}\n                  onClick={toggleFollow}\n                  className=\"rounded-full border border-white/20 px-4 py-2 text-sm text-white/80 hover:border-white/40 disabled:opacity-60\"\n                >\n                  {followPending ? \"A atualizar…\" : isFollowing ? \"A seguir\" : \"Segue para receber notificação\"}\n                </button>\n              )}\n            </section>\n          );\n        }\n        return (\n          <section key=\"video\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Live</p>\n                <h2 className=\"text-lg font-semibold text-white\">Assistir agora</h2>\n              </div>\n              {streamHref && (\n                <a\n                  href={streamHref}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"rounded-full border border-white/15 px-3 py-1 text-xs text-white/70 hover:border-white/40\"\n                >\n                  {streamLabel}\n                </a>\n              )}\n            </div>\n            <div className=\"aspect-video w-full overflow-hidden rounded-2xl border border-white/10 bg-black\">\n              <iframe\n                src={embedUrl}\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n                className=\"h-full w-full\"\n                title=\"Live stream\"\n              />\n            </div>\n          </section>\n        );\n      }\n      case \"NOW_PLAYING\": {\n        if (!tournamentView) return <EmptyCard key=\"now\" title=\"Agora a jogar\" children=\"Sem torneio associado.\" />;\n        return (\n          <section key=\"now\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-white\">Agora a jogar</h2>\n              <span className=\"text-xs text-white/50\">{liveMatches.length} em jogo</span>\n            </div>\n            <div className=\"grid gap-3 md:grid-cols-2\">\n              {liveMatches.length === 0 && <p className=\"text-white/60\">Sem jogos em curso.</p>}\n              {liveMatches.map((match) => (\n                <MatchCard key={`now-${match.id}`} match={match} pairings={pairings} timeZone={timeZone} highlight showCourt={showCourt} />\n              ))}\n            </div>\n          </section>\n        );\n      }\n      case \"NEXT_MATCHES\": {\n        if (!tournamentView) return <EmptyCard key=\"next\" title=\"Próximos jogos\" children=\"Sem torneio associado.\" />;\n        return (\n          <section key=\"next\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-white\">Próximos jogos</h2>\n              <span className=\"text-xs text-white/50\">{upcomingMatches.length} previstos</span>\n            </div>\n            <div className=\"grid gap-3 md:grid-cols-2\">\n              {upcomingMatches.length === 0 && <p className=\"text-white/60\">Sem jogos agendados.</p>}\n              {upcomingMatches.map((match) => {\n                const highlight =\n                  (pairingIdFromQuery &&\n                    (`${match.pairing1Id}` === pairingIdFromQuery || `${match.pairing2Id}` === pairingIdFromQuery)) ||\n                  (tournamentView?.userPairingId &&\n                    (match.pairing1Id === tournamentView.userPairingId || match.pairing2Id === tournamentView.userPairingId));\n                return (\n                  <MatchCard\n                    key={`next-${match.id}`}\n                    match={match}\n                    pairings={pairings}\n                    highlight={highlight}\n                    timeZone={timeZone}\n                    showCourt={showCourt}\n                  />\n                );\n              })}\n            </div>\n          </section>\n        );\n      }\n      case \"RESULTS\": {\n        if (!tournamentView) return <EmptyCard key=\"results\" title=\"Resultados\" children=\"Sem torneio associado.\" />;\n        return (\n          <section key=\"results\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-white\">Resultados recentes</h2>\n              <span className=\"text-xs text-white/50\">{recentResults.length} jogos</span>\n            </div>\n            <div className=\"grid gap-3 md:grid-cols-2\">\n              {recentResults.length === 0 && <p className=\"text-white/60\">Sem resultados registados.</p>}\n              {recentResults.map((match) => (\n                <MatchCard key={`res-${match.id}`} match={match} pairings={pairings} timeZone={timeZone} showCourt={showCourt} />\n              ))}\n            </div>\n          </section>\n        );\n      }\n      case \"BRACKET\": {\n        if (!tournamentView) return <EmptyCard key=\"bracket\" title=\"Bracket\" children=\"Sem torneio associado.\" />;\n        const stages = tournamentView.stages ?? [];\n        const playoffStages = stages.filter((stage: any) => stage.stageType === \"PLAYOFF\" && stage.matches?.length);\n        const bracketStages = playoffStages.length > 0 ? playoffStages : stages.filter((stage: any) => stage.matches?.length);\n        const hasBracket = bracketStages.length > 0;\n        const hasGroups = stages.some((stage: any) => stage.groups?.length);\n\n        if (hasBracket) {\n          const bracketHasEarlyRounds = bracketStages.some((stage: any) => {\n            const roundCount = new Set(stage.matches.map((m: MatchPayload) => m.round ?? 0)).size;\n            return roundCount > 3;\n          });\n          const highlightPairingId = (() => {\n            if (pairingIdFromQuery) {\n              const parsed = Number(pairingIdFromQuery);\n              return Number.isFinite(parsed) ? parsed : null;\n            }\n            return tournamentView?.userPairingId ?? null;\n          })();\n          return (\n            <section key=\"bracket\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-4\">\n              <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                <div>\n                  <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Bracket</p>\n                  <h2 className=\"text-lg font-semibold text-white\">Chave completa</h2>\n                </div>\n                {bracketHasEarlyRounds && (\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowFullBracket((prev) => !prev)}\n                    className=\"hidden md:inline-flex rounded-full border border-white/15 px-3 py-1 text-xs text-white/70 hover:border-white/40\"\n                  >\n                    {showFullBracket ? \"Mostrar menos\" : \"Ver bracket completo\"}\n                  </button>\n                )}\n              </div>\n              <div className=\"space-y-4\">\n                {bracketStages.map((stage: any) => {\n                  if (!stage.matches.length) return null;\n                  return (\n                    <div key={stage.id} className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"text-white font-semibold\">{stage.name || \"Playoffs\"}</h3>\n                        <span className=\"text-[11px] uppercase tracking-[0.18em] text-white/50\">{stage.stageType}</span>\n                      </div>\n                      <BracketRoundsView\n                        matches={stage.matches}\n                        pairings={pairings}\n                        isOrganizerEdit={isOrganizerEdit}\n                        tournamentId={tournamentView?.id ?? null}\n                        onUpdated={onRefresh}\n                        goalLimits={goalLimits}\n                        highlightPairingId={highlightPairingId}\n                        canResolveDispute={canResolveDispute}\n                        view={showFullBracket ? \"full\" : \"split\"}\n                      />\n                    </div>\n                  );\n                })}\n              </div>\n            </section>\n          );\n        }\n\n        if (hasGroups) {\n          return (\n            <section key=\"bracket\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-4\">\n              <div>\n                <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Tabela</p>\n                <h2 className=\"text-lg font-semibold text-white\">Classificação dos grupos</h2>\n              </div>\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                {stages.map((stage: any) =>\n                  stage.groups?.map((group: any) => (\n                    <div key={`group-${group.id}`} className=\"rounded-2xl border border-white/10 bg-black/30 p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"text-white font-semibold\">{group.name || \"Grupo\"}</h3>\n                        <span className=\"text-[11px] uppercase tracking-[0.18em] text-white/50\">{stage.stageType}</span>\n                      </div>\n                      <div className=\"mt-3 space-y-2\">\n                        {(group.standings ?? []).length === 0 && (\n                          <p className=\"text-sm text-white/60\">Sem classificação disponível.</p>\n                        )}\n                        {(group.standings ?? []).map((row: any, idx: number) => {\n                          return (\n                            <div key={`group-${group.id}-row-${row.pairingId}`} className=\"flex items-center justify-between text-sm text-white/80\">\n                              <div className=\"flex items-center gap-3\">\n                                <span className=\"text-white/50\">{idx + 1}</span>\n                                {renderPairingName(row.pairingId, pairings)}\n                              </div>\n                              <span className=\"text-white/50\">{row.wins}-{row.losses}</span>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </div>\n                  )),\n                )}\n              </div>\n            </section>\n          );\n        }\n\n        return <EmptyCard key=\"bracket\" title=\"Bracket\" children=\"Sem chave definida.\" />;\n      }\n      case \"CHAMPION\": {\n        if (!tournamentView) return <EmptyCard key=\"champ\" title=\"Campeão\" children=\"Sem torneio associado.\" />;\n        const championId = (tournamentView.championPairingId as number | null) ?? derivedChampionPairingId;\n        const meta = pairingMeta(championId, pairings);\n        if (!championId || !meta) {\n          return <EmptyCard key=\"champ\" title=\"Campeão\" children=\"Ainda não existe campeão definido.\" />;\n        }\n        return (\n          <section key=\"champ\" className=\"rounded-3xl border border-amber-300/30 bg-[linear-gradient(135deg,rgba(255,215,120,0.12),rgba(20,20,20,0.8))] p-5\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex h-14 w-14 items-center justify-center rounded-2xl border border-amber-200/40 bg-amber-300/10 text-2xl\">\n                🏆\n              </div>\n              <div>\n                <p className=\"text-[11px] uppercase tracking-[0.3em] text-amber-100/70\">Campeão</p>\n                <div className=\"text-xl font-semibold text-white\">\n                  {renderPairingName(championId, pairings)}\n                </div>\n              </div>\n            </div>\n          </section>\n        );\n      }\n      case \"SUMMARY\": {\n        return (\n          <section key=\"summary\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-2\">\n            <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Resumo</p>\n            <h2 className=\"text-lg font-semibold text-white\">Sobre este evento</h2>\n            <p className=\"text-white/70 text-sm leading-relaxed\">\n              {event.description?.trim() || \"Descrição em breve.\"}\n            </p>\n          </section>\n        );\n      }\n      case \"CTA\": {\n        const ctaCopy =\n          viewerRole === \"PUBLIC\"\n            ? \"Queres aparecer como participante? Garante o teu bilhete.\"\n            : \"Já tens acesso como participante. Aproveita o LiveHub.\";\n        const ctaLabel = viewerRole === \"PUBLIC\" ? \"Garantir lugar\" : \"Ver o meu bilhete\";\n        return (\n          <section key=\"cta\" className=\"rounded-3xl border border-white/10 bg-white/5 p-4\">\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <div>\n                <p className=\"text-[11px] uppercase tracking-[0.25em] text-white/60\">Participação</p>\n                <p className=\"text-white/80\">{ctaCopy}</p>\n              </div>\n              <Link\n                href={`/eventos/${event.slug}`}\n                className=\"rounded-full border border-white/20 px-4 py-2 text-sm text-white/80 hover:border-white/40\"\n              >\n                {ctaLabel}\n              </Link>\n            </div>\n          </section>\n        );\n      }\n      case \"SPONSORS\": {\n        return <SponsorsStrip organizer={organizer} />;\n      }\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {resolvedModules.map((mod) => renderModule(mod))}\n\n      {viewerRole === \"ORGANIZER\" && canEditMatches && tournamentView && isOrganizerRoute && (\n        <section className=\"rounded-3xl border border-white/10 bg-white/5 p-4 space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold text-white\">Gestão rápida</h2>\n            <span className=\"text-xs text-white/50\">Organizador</span>\n          </div>\n          <div className=\"rounded-2xl border border-white/10 bg-black/30 px-4 py-3\">\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <div className=\"space-y-1\">\n                <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/50\">Arranque</p>\n                <p className=\"text-sm text-white/70\">Começa o primeiro jogo pendente.</p>\n                {nextPendingLabel && (\n                  <p className=\"text-[11px] text-white/50\">Próximo: {nextPendingLabel}</p>\n                )}\n              </div>\n              <button\n                type=\"button\"\n                onClick={startFirstMatch}\n                disabled={!firstPlayableMatch || Boolean(startingMatchId)}\n                className=\"rounded-full border border-emerald-400/40 bg-emerald-500/10 px-4 py-2 text-[12px] font-semibold text-emerald-100 hover:border-emerald-300/70 disabled:opacity-60\"\n              >\n                {startingMatchId ? \"A iniciar…\" : \"Começar jogos\"}\n              </button>\n            </div>\n            {startMessage && <p className=\"mt-2 text-[11px] text-white/60\">{startMessage}</p>}\n          </div>\n          <div className=\"space-y-3\">\n            {flatMatches\n              .filter((m) => m.status !== \"DONE\")\n              .slice(0, 6)\n              .map((match) => (\n                <div key={`edit-${match.id}`} className=\"space-y-2\">\n                  <MatchCard match={match} pairings={pairings} timeZone={timeZone} showCourt={showCourt} />\n                  <OrganizerMatchEditor\n                    match={match}\n                    tournamentId={tournamentView.id}\n                    onUpdated={() => mutate()}\n                    goalLimit={resolveGoalLimit(match.round ?? null, goalLimits)}\n                    locked={roundIsLockedGlobal(match.round ?? 0) || match.status === \"DISPUTED\"}\n                    lockedReason={\n                      match.status === \"DISPUTED\"\n                        ? \"Jogo em disputa. Resolve antes de editar.\"\n                        : roundIsLockedGlobal(match.round ?? 0)\n                          ? \"Esta fase ainda não está ativa.\"\n                          : null\n                    }\n                    canResolveDispute={canResolveDispute}\n                  />\n                </div>\n              ))}\n            {flatMatches.filter((m) => m.status !== \"DONE\").length === 0 && (\n              <p className=\"text-white/60\">Sem jogos pendentes para editar.</p>\n            )}\n          </div>\n        </section>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5814, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/standings.ts"],"sourcesContent":["import seedrandom from \"seedrandom\";\nimport { TournamentMatchStatus } from \"@prisma/client\";\n\nexport type TieBreakRule = \"WINS\" | \"SET_DIFF\" | \"GAME_DIFF\" | \"HEAD_TO_HEAD\" | \"RANDOM\";\n\nexport type MatchResult = {\n  pairing1Id: number;\n  pairing2Id: number;\n  status: TournamentMatchStatus;\n  score?: { sets?: Array<{ a: number; b: number }>; games?: Array<{ a: number; b: number }> };\n};\n\nexport type Standing = {\n  pairingId: number;\n  wins: number;\n  losses: number;\n  setDiff: number;\n  gameDiff: number;\n  headToHead: Record<number, number>; // pairingId -> wins against\n};\n\nexport function computeGroupStandings(\n  pairings: number[],\n  matches: MatchResult[],\n  rules: TieBreakRule[],\n  seed?: string,\n): Standing[] {\n  const rng = seedrandom(seed || `${Date.now()}`);\n  const map = new Map<number, Standing>();\n  pairings.forEach((p) =>\n    map.set(p, { pairingId: p, wins: 0, losses: 0, setDiff: 0, gameDiff: 0, headToHead: {} }),\n  );\n\n  const finished = matches.filter((m) => m.status === \"DONE\");\n  for (const m of finished) {\n    const s1 = map.get(m.pairing1Id);\n    const s2 = map.get(m.pairing2Id);\n    if (!s1 || !s2) continue;\n    const sets = m.score?.sets ?? [];\n    let aSets = 0;\n    let bSets = 0;\n    let aGames = 0;\n    let bGames = 0;\n    for (const set of sets) {\n      aSets += set.a;\n      bSets += set.b;\n      aGames += set.a;\n      bGames += set.b;\n    }\n    if (aSets > bSets) {\n      s1.wins += 1;\n      s2.losses += 1;\n      s1.headToHead[m.pairing2Id] = (s1.headToHead[m.pairing2Id] ?? 0) + 1;\n    } else if (bSets > aSets) {\n      s2.wins += 1;\n      s1.losses += 1;\n      s2.headToHead[m.pairing1Id] = (s2.headToHead[m.pairing1Id] ?? 0) + 1;\n    }\n    s1.setDiff += aSets - bSets;\n    s2.setDiff += bSets - aSets;\n    s1.gameDiff += aGames - bGames;\n    s2.gameDiff += bGames - aGames;\n  }\n\n  const standings = Array.from(map.values());\n\n  const comparator = (a: Standing, b: Standing) => {\n    for (const rule of rules) {\n      if (rule === \"WINS\") {\n        if (a.wins !== b.wins) return b.wins - a.wins;\n      } else if (rule === \"SET_DIFF\") {\n        if (a.setDiff !== b.setDiff) return b.setDiff - a.setDiff;\n      } else if (rule === \"GAME_DIFF\") {\n        if (a.gameDiff !== b.gameDiff) return b.gameDiff - a.gameDiff;\n      } else if (rule === \"HEAD_TO_HEAD\") {\n        const aHH = a.headToHead[b.pairingId] ?? 0;\n        const bHH = b.headToHead[a.pairingId] ?? 0;\n        if (aHH !== bHH) return bHH - aHH;\n      } else if (rule === \"RANDOM\") {\n        const r = rng() - 0.5;\n        if (r !== 0) return r > 0 ? 1 : -1;\n      }\n    }\n    return 0;\n  };\n\n  return standings.sort(comparator);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAqBO,SAAS,sBACd,QAAkB,EAClB,OAAsB,EACtB,KAAqB,EACrB,IAAa;IAEb,MAAM,MAAM,IAAA,8IAAU,EAAC,QAAQ,GAAG,KAAK,GAAG,IAAI;IAC9C,MAAM,MAAM,IAAI;IAChB,SAAS,OAAO,CAAC,CAAC,IAChB,IAAI,GAAG,CAAC,GAAG;YAAE,WAAW;YAAG,MAAM;YAAG,QAAQ;YAAG,SAAS;YAAG,UAAU;YAAG,YAAY,CAAC;QAAE;IAGzF,MAAM,WAAW,QAAQ,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;IACpD,KAAK,MAAM,KAAK,SAAU;QACxB,MAAM,KAAK,IAAI,GAAG,CAAC,EAAE,UAAU;QAC/B,MAAM,KAAK,IAAI,GAAG,CAAC,EAAE,UAAU;QAC/B,IAAI,CAAC,MAAM,CAAC,IAAI;QAChB,MAAM,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE;QAChC,IAAI,QAAQ;QACZ,IAAI,QAAQ;QACZ,IAAI,SAAS;QACb,IAAI,SAAS;QACb,KAAK,MAAM,OAAO,KAAM;YACtB,SAAS,IAAI,CAAC;YACd,SAAS,IAAI,CAAC;YACd,UAAU,IAAI,CAAC;YACf,UAAU,IAAI,CAAC;QACjB;QACA,IAAI,QAAQ,OAAO;YACjB,GAAG,IAAI,IAAI;YACX,GAAG,MAAM,IAAI;YACb,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI;QACrE,OAAO,IAAI,QAAQ,OAAO;YACxB,GAAG,IAAI,IAAI;YACX,GAAG,MAAM,IAAI;YACb,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,IAAI;QACrE;QACA,GAAG,OAAO,IAAI,QAAQ;QACtB,GAAG,OAAO,IAAI,QAAQ;QACtB,GAAG,QAAQ,IAAI,SAAS;QACxB,GAAG,QAAQ,IAAI,SAAS;IAC1B;IAEA,MAAM,YAAY,MAAM,IAAI,CAAC,IAAI,MAAM;IAEvC,MAAM,aAAa,CAAC,GAAa;QAC/B,KAAK,MAAM,QAAQ,MAAO;YACxB,IAAI,SAAS,QAAQ;gBACnB,IAAI,EAAE,IAAI,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,IAAI;YAC/C,OAAO,IAAI,SAAS,YAAY;gBAC9B,IAAI,EAAE,OAAO,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,GAAG,EAAE,OAAO;YAC3D,OAAO,IAAI,SAAS,aAAa;gBAC/B,IAAI,EAAE,QAAQ,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,GAAG,EAAE,QAAQ;YAC/D,OAAO,IAAI,SAAS,gBAAgB;gBAClC,MAAM,MAAM,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC,IAAI;gBACzC,MAAM,MAAM,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC,IAAI;gBACzC,IAAI,QAAQ,KAAK,OAAO,MAAM;YAChC,OAAO,IAAI,SAAS,UAAU;gBAC5B,MAAM,IAAI,QAAQ;gBAClB,IAAI,MAAM,GAAG,OAAO,IAAI,IAAI,IAAI,CAAC;YACnC;QACF;QACA,OAAO;IACT;IAEA,OAAO,UAAU,IAAI,CAAC;AACxB"}},
    {"offset": {"line": 5887, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/structure.ts"],"sourcesContent":["import { TournamentMatchStatus } from \"@prisma/client\";\nimport { computeGroupStandings, TieBreakRule } from \"@/domain/tournaments/standings\";\n\nexport function summarizeMatchStatus(status: TournamentMatchStatus) {\n  if (status === \"IN_PROGRESS\") return \"Em jogo\";\n  if (status === \"DONE\") return \"Terminado\";\n  if (status === \"DISPUTED\") return \"Em disputa\";\n  if (status === \"SCHEDULED\") return \"Agendado\";\n  if (status === \"CANCELLED\") return \"Cancelado\";\n  return \"Pendente\";\n}\n\nexport function computeStandingsForGroup(\n  matches: { pairing1Id: number | null; pairing2Id: number | null; status: TournamentMatchStatus; score: unknown }[],\n  rules: TieBreakRule[],\n  seed?: string,\n) {\n  const pairings = Array.from(\n    new Set(\n      matches\n        .flatMap((m) => [m.pairing1Id, m.pairing2Id])\n        .filter((v): v is number => typeof v === \"number\"),\n    ),\n  );\n  if (pairings.length === 0) return [];\n  return computeGroupStandings(\n    pairings,\n    matches\n      .filter((m) => m.pairing1Id && m.pairing2Id)\n      .map((m) => ({\n        pairing1Id: m.pairing1Id as number,\n        pairing2Id: m.pairing2Id as number,\n        status: m.status,\n        score: m.score as unknown,\n      })),\n    rules,\n    seed,\n  );\n}\n"],"names":[],"mappings":";;;;;;AACA;;AAEO,SAAS,qBAAqB,MAA6B;IAChE,IAAI,WAAW,eAAe,OAAO;IACrC,IAAI,WAAW,QAAQ,OAAO;IAC9B,IAAI,WAAW,YAAY,OAAO;IAClC,IAAI,WAAW,aAAa,OAAO;IACnC,IAAI,WAAW,aAAa,OAAO;IACnC,OAAO;AACT;AAEO,SAAS,yBACd,OAAkH,EAClH,KAAqB,EACrB,IAAa;IAEb,MAAM,WAAW,MAAM,IAAI,CACzB,IAAI,IACF,QACG,OAAO,CAAC,CAAC,IAAM;YAAC,EAAE,UAAU;YAAE,EAAE,UAAU;SAAC,EAC3C,MAAM,CAAC,CAAC,IAAmB,OAAO,MAAM;IAG/C,IAAI,SAAS,MAAM,KAAK,GAAG,OAAO,EAAE;IACpC,OAAO,IAAA,2JAAqB,EAC1B,UACA,QACG,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,IAAI,EAAE,UAAU,EAC1C,GAAG,CAAC,CAAC,IAAM,CAAC;YACX,YAAY,EAAE,UAAU;YACxB,YAAY,EAAE,UAAU;YACxB,QAAQ,EAAE,MAAM;YAChB,OAAO,EAAE,KAAK;QAChB,CAAC,IACH,OACA;AAEJ"}},
    {"offset": {"line": 5926, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/matchRules.ts"],"sourcesContent":["import { TournamentMatchStatus } from \"@prisma/client\";\n\nexport type SetScore = { a: number; b: number };\nexport type ScorePayload = { sets: SetScore[] };\nexport type GoalScorePayload = { a: number; b: number; limit?: number };\nexport type MatchScorePayload = { sets?: SetScore[]; goals?: GoalScorePayload };\n\nexport type ValidationResult =\n  | { ok: true; winner: \"A\" | \"B\"; normalized: ScorePayload }\n  | { ok: false; code: string; message: string };\n\nexport type GoalValidationResult =\n  | { ok: true; winner: \"A\" | \"B\" | null; status: TournamentMatchStatus; normalized: GoalScorePayload }\n  | { ok: false; code: string; message: string };\n\nconst WIN_BY = 2;\nconst MAX_SETS = 3; // BO3\nconst MIN_GAMES_TO_WIN = 6;\nconst TIEBREAK_GAMES = 7;\n\nfunction isValidSet(set: SetScore) {\n  const a = Number(set.a);\n  const b = Number(set.b);\n  if (!Number.isFinite(a) || !Number.isFinite(b) || a < 0 || b < 0) return false;\n  const max = Math.max(a, b);\n  const diff = Math.abs(a - b);\n  // tiebreak 7-6 é aceite\n  if (max === TIEBREAK_GAMES && diff === 1) return true;\n  if (max >= MIN_GAMES_TO_WIN) return diff >= WIN_BY;\n  return false;\n}\n\nexport function validateScore(score: ScorePayload): ValidationResult {\n  if (!score || !Array.isArray(score.sets) || score.sets.length === 0) {\n    return { ok: false, code: \"INVALID_SCORE\", message: \"Score vazio ou inválido.\" };\n  }\n  if (score.sets.length > MAX_SETS) {\n    return { ok: false, code: \"TOO_MANY_SETS\", message: \"Máximo de 3 sets (BO3).\" };\n  }\n\n  let winsA = 0;\n  let winsB = 0;\n  for (const s of score.sets) {\n    if (!isValidSet(s)) return { ok: false, code: \"INVALID_SET\", message: \"Set inválido.\" };\n    if (s.a > s.b) winsA += 1;\n    else winsB += 1;\n  }\n\n  if (winsA === winsB) return { ok: false, code: \"NO_WINNER\", message: \"Empate não permitido no BO3.\" };\n  if (winsA > MAX_SETS || winsB > MAX_SETS) {\n    return { ok: false, code: \"TOO_MANY_WINS\", message: \"Vitórias a mais para BO3.\" };\n  }\n  if (winsA > winsB && winsA > MAX_SETS - 1) {\n    return { ok: true, winner: \"A\", normalized: score };\n  }\n  if (winsB > winsA && winsB > MAX_SETS - 1) {\n    return { ok: true, winner: \"B\", normalized: score };\n  }\n  return { ok: false, code: \"NO_WINNER\", message: \"Score não determina vencedor.\" };\n}\n\nexport function validateGoalScore(score: GoalScorePayload): GoalValidationResult {\n  const a = Number(score?.a);\n  const b = Number(score?.b);\n  const limit = Number(score?.limit);\n  if (!Number.isFinite(a) || !Number.isFinite(b) || a < 0 || b < 0) {\n    return { ok: false, code: \"INVALID_SCORE\", message: \"Score inválido.\" };\n  }\n  if (!Number.isFinite(limit) || limit <= 0) {\n    return { ok: false, code: \"INVALID_LIMIT\", message: \"Limite de golos inválido.\" };\n  }\n  if (a > limit || b > limit) {\n    return { ok: false, code: \"LIMIT_EXCEEDED\", message: \"Score ultrapassa o limite.\" };\n  }\n  if (a === limit && b === limit) {\n    return { ok: false, code: \"TIE_NOT_ALLOWED\", message: \"Empate não permitido.\" };\n  }\n  if (a === limit) {\n    return { ok: true, winner: \"A\", status: TournamentMatchStatus.DONE, normalized: { a, b, limit } };\n  }\n  if (b === limit) {\n    return { ok: true, winner: \"B\", status: TournamentMatchStatus.DONE, normalized: { a, b, limit } };\n  }\n  if (a > 0 || b > 0) {\n    return { ok: true, winner: null, status: TournamentMatchStatus.IN_PROGRESS, normalized: { a, b, limit } };\n  }\n  return { ok: true, winner: null, status: TournamentMatchStatus.PENDING, normalized: { a, b, limit } };\n}\n\nexport function getWinnerSideFromScore(score?: MatchScorePayload | null) {\n  if (!score) return null;\n  if (score.goals) {\n    const res = validateGoalScore(score.goals);\n    return res.ok ? res.winner : null;\n  }\n  if (Array.isArray(score.sets) && score.sets.length > 0) {\n    const res = validateScore({ sets: score.sets });\n    return res.ok ? res.winner : null;\n  }\n  return null;\n}\n\nexport function canEditMatch(status: TournamentMatchStatus, force?: boolean) {\n  if (force) return true;\n  // não permite editar DONE se não for force\n  return status !== \"DONE\" && status !== \"DISPUTED\";\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6113, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/domain/tournaments/liveWarnings.ts"],"sourcesContent":["import { Prisma } from \"@prisma/client\";\nimport { validateScore } from \"@/domain/tournaments/matchRules\";\n\ntype Warning =\n  | { type: \"REQUIRES_ACTION\"; pairingId: number }\n  | { type: \"INVALID_SCORE\"; matchId: number }\n  | { type: \"MISSING_COURT\"; matchId: number }\n  | { type: \"MISSING_START\"; matchId: number };\n\nexport function computeLiveWarnings(opts: {\n  matches: Array<{ id: number; courtId: number | null; startAt: Date | null; score: any; status: string }>;\n  pairings: Array<{ id: number; guaranteeStatus?: string | null }>;\n  startThresholdMinutes?: number;\n}): Warning[] {\n  const { matches, pairings, startThresholdMinutes = 60 } = opts;\n  const warnings: Warning[] = [];\n\n  // guarantee REQUIRES_ACTION\n  pairings.forEach((p) => {\n    if ((p.guaranteeStatus || \"\").toUpperCase() === \"REQUIRES_ACTION\") {\n      warnings.push({ type: \"REQUIRES_ACTION\", pairingId: p.id });\n    }\n  });\n\n  // matches: missing court/start + score inválido\n  const threshold = new Date(Date.now() + startThresholdMinutes * 60 * 1000);\n  matches.forEach((m) => {\n    if (!m.courtId) warnings.push({ type: \"MISSING_COURT\", matchId: m.id });\n    if (!m.startAt || m.startAt < threshold) warnings.push({ type: \"MISSING_START\", matchId: m.id });\n    if ((m.status || \"\").toUpperCase() === \"DONE\") {\n      const sets = Array.isArray(m.score?.sets) ? m.score.sets : [];\n      if (sets.length === 0) return;\n      const res = validateScore({ sets } as any);\n      if (!res.ok) warnings.push({ type: \"INVALID_SCORE\", matchId: m.id });\n    }\n  });\n\n  return warnings;\n}\n"],"names":[],"mappings":";;;;AACA;;AAQO,SAAS,oBAAoB,IAInC;IACC,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,wBAAwB,EAAE,EAAE,GAAG;IAC1D,MAAM,WAAsB,EAAE;IAE9B,4BAA4B;IAC5B,SAAS,OAAO,CAAC,CAAC;QAChB,IAAI,CAAC,EAAE,eAAe,IAAI,EAAE,EAAE,WAAW,OAAO,mBAAmB;YACjE,SAAS,IAAI,CAAC;gBAAE,MAAM;gBAAmB,WAAW,EAAE,EAAE;YAAC;QAC3D;IACF;IAEA,gDAAgD;IAChD,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,wBAAwB,KAAK;IACrE,QAAQ,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,EAAE,OAAO,EAAE,SAAS,IAAI,CAAC;YAAE,MAAM;YAAiB,SAAS,EAAE,EAAE;QAAC;QACrE,IAAI,CAAC,EAAE,OAAO,IAAI,EAAE,OAAO,GAAG,WAAW,SAAS,IAAI,CAAC;YAAE,MAAM;YAAiB,SAAS,EAAE,EAAE;QAAC;QAC9F,IAAI,CAAC,EAAE,MAAM,IAAI,EAAE,EAAE,WAAW,OAAO,QAAQ;YAC7C,MAAM,OAAO,MAAM,OAAO,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,CAAC,IAAI,GAAG,EAAE;YAC7D,IAAI,KAAK,MAAM,KAAK,GAAG;YACvB,MAAM,MAAM,IAAA,oJAAa,EAAC;gBAAE;YAAK;YACjC,IAAI,CAAC,IAAI,EAAE,EAAE,SAAS,IAAI,CAAC;gBAAE,MAAM;gBAAiB,SAAS,EAAE,EAAE;YAAC;QACpE;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 6160, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/tournaments/%5Bid%5D/live/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { use, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport useSWR from \"swr\";\nimport { summarizeMatchStatus, computeStandingsForGroup } from \"@/domain/tournaments/structure\";\nimport { type TieBreakRule } from \"@/domain/tournaments/standings\";\nimport { computeLiveWarnings } from \"@/domain/tournaments/liveWarnings\";\nimport { DEFAULT_GUEST_AVATAR } from \"@/lib/avatars\";\n\ntype PageProps = { params: Promise<{ id: string }> };\ntype TournamentLiveManagerProps = { tournamentId: number };\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json());\n\ntype Participant = {\n  id: number;\n  name: string;\n  username?: string | null;\n  email?: string | null;\n  avatarUrl?: string | null;\n  seed?: number | null;\n};\n\ntype ParticipantDraft = {\n  id?: number | null;\n  name: string;\n  username: string;\n  email: string;\n  avatarUrl: string | null;\n};\n\ntype UserResult = {\n  id: string;\n  username: string | null;\n  fullName: string | null;\n  avatarUrl: string | null;\n};\n\nfunction Filters({ stages, setFilters }: { stages: any[]; setFilters: (f: any) => void }) {\n  const [status, setStatus] = useState<string>(\"\");\n  const [stageId, setStageId] = useState<string>(\"\");\n  const [court, setCourt] = useState<string>(\"\");\n  const [todayOnly, setTodayOnly] = useState(false);\n  const [search, setSearch] = useState(\"\");\n\n  return (\n    <div className=\"flex flex-wrap items-center gap-2 text-sm\">\n      <select\n        value={status}\n        onChange={(e) => {\n          setStatus(e.target.value);\n          setFilters((prev: any) => ({ ...prev, status: e.target.value || null }));\n        }}\n        className=\"rounded-full border border-white/15 bg-white/5 px-3 py-1 text-white/80\"\n      >\n        <option value=\"\">Todos os estados</option>\n        <option value=\"PENDING\">Pendente</option>\n        <option value=\"IN_PROGRESS\">Em jogo</option>\n        <option value=\"DONE\">Terminado</option>\n      </select>\n      <select\n        value={stageId}\n        onChange={(e) => {\n          setStageId(e.target.value);\n          setFilters((prev: any) => ({ ...prev, stageId: e.target.value ? Number(e.target.value) : null }));\n        }}\n        className=\"rounded-full border border-white/15 bg-white/5 px-3 py-1 text-white/80\"\n      >\n        <option value=\"\">Todas as fases</option>\n        {stages.map((s) => (\n          <option key={s.id} value={s.id}>\n            {s.name || s.stageType}\n          </option>\n        ))}\n      </select>\n      <input\n        value={court}\n        onChange={(e) => {\n          setCourt(e.target.value);\n          setFilters((prev: any) => ({ ...prev, court: e.target.value || null }));\n        }}\n        placeholder=\"Campo #\"\n        className=\"w-24 rounded-full border border-white/15 bg-white/5 px-3 py-1 text-white/80\"\n      />\n      <label className=\"flex items-center gap-1 text-white/75\">\n        <input\n          type=\"checkbox\"\n          checked={todayOnly}\n          onChange={(e) => {\n            setTodayOnly(e.target.checked);\n            setFilters((prev: any) => ({ ...prev, todayOnly: e.target.checked }));\n          }}\n        />\n        Só hoje\n      </label>\n      <input\n        value={search}\n        onChange={(e) => {\n          setSearch(e.target.value);\n          setFilters((prev: any) => ({ ...prev, search: e.target.value }));\n        }}\n        placeholder=\"Pesquisar jogador #\"\n        className=\"rounded-full border border-white/15 bg-white/5 px-3 py-1 text-white/80\"\n      />\n    </div>\n  );\n}\n\nexport function TournamentLiveManager({ tournamentId }: TournamentLiveManagerProps) {\n  const router = useRouter();\n  const isValidTournamentId = Number.isFinite(tournamentId);\n  const [authError, setAuthError] = useState<string | null>(null);\n  const [slots, setSlots] = useState<Array<Participant | null>>([]);\n  const [bracketSize, setBracketSize] = useState(16);\n  const [participantsMessage, setParticipantsMessage] = useState<string | null>(null);\n  const [savingParticipants, setSavingParticipants] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [generationMessage, setGenerationMessage] = useState<string | null>(null);\n  const [activeSlotIndex, setActiveSlotIndex] = useState<number | null>(null);\n  const [slotDraft, setSlotDraft] = useState<ParticipantDraft>({\n    name: \"\",\n    username: \"\",\n    email: \"\",\n    avatarUrl: null,\n  });\n  const [slotMode, setSlotMode] = useState<\"user\" | \"guest\">(\"guest\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [searchResults, setSearchResults] = useState<UserResult[]>([]);\n  const [searching, setSearching] = useState(false);\n  const [uploadingAvatar, setUploadingAvatar] = useState(false);\n  const autoSaveTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const slotDraftTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const hasLoadedParticipantsRef = useRef(false);\n  const lastSavedKeyRef = useRef<string | null>(null);\n\n  useEffect(() => {\n    if (authError === \"login\") router.replace(\"/login\");\n    if (authError === \"organizador\") router.replace(\"/organizador\");\n  }, [authError, router]);\n\n  const { data, error } = useSWR(\n    isValidTournamentId ? `/api/organizador/tournaments/${tournamentId}/live` : null,\n    fetcher,\n  );\n  const { data: participantsRes, mutate: mutateParticipants } = useSWR(\n    isValidTournamentId ? `/api/organizador/tournaments/${tournamentId}/participants` : null,\n    fetcher,\n  );\n\n  const buildParticipantsPayload = (items: Array<Participant | null>) =>\n    items\n      .map((slot, idx) =>\n        slot\n          ? {\n              id: slot.id,\n              name: slot.name,\n              username: slot.username ?? null,\n              email: slot.email ?? null,\n              avatarUrl: slot.avatarUrl ?? null,\n              seed: idx + 1,\n            }\n          : null,\n      )\n      .filter(Boolean) as Participant[];\n\n  const buildParticipantsKey = (items: Array<Participant | null>, size: number) =>\n    JSON.stringify({ size, participants: buildParticipantsPayload(items) });\n\n  const buildSlotsFromParticipants = (list: Participant[], size: number) => {\n    const nextSlots: Array<Participant | null> = Array.from({ length: size }, () => null);\n    const seeded: Participant[] = [];\n    const unseeded: Participant[] = [];\n    list.forEach((p) => {\n      const seed = Number.isFinite(p.seed) ? Number(p.seed) : null;\n      if (seed && seed >= 1 && seed <= size) seeded.push(p);\n      else unseeded.push(p);\n    });\n    seeded\n      .sort((a, b) => (Number(a.seed) || 0) - (Number(b.seed) || 0))\n      .forEach((p) => {\n        const idx = Number(p.seed) - 1;\n        if (idx >= 0 && idx < size && !nextSlots[idx]) nextSlots[idx] = p;\n      });\n    let cursor = 0;\n    unseeded.forEach((p) => {\n      while (cursor < nextSlots.length && nextSlots[cursor]) cursor += 1;\n      if (cursor < nextSlots.length) {\n        nextSlots[cursor] = p;\n        cursor += 1;\n      }\n    });\n    return nextSlots;\n  };\n\n  useEffect(() => {\n    if (!participantsRes?.ok) return;\n    const list = Array.isArray(participantsRes.participants) ? (participantsRes.participants as Participant[]) : [];\n    const nextSize = Number.isFinite(participantsRes.bracketSize) ? Number(participantsRes.bracketSize) : bracketSize;\n    const resolvedSize = Number.isFinite(nextSize) ? nextSize : bracketSize;\n    const nextSlots = buildSlotsFromParticipants(list, resolvedSize);\n    if (Number.isFinite(resolvedSize)) setBracketSize(resolvedSize);\n    setSlots(nextSlots);\n    lastSavedKeyRef.current = buildParticipantsKey(nextSlots, resolvedSize);\n    hasLoadedParticipantsRef.current = true;\n  }, [participantsRes]);\n\n  useEffect(() => {\n    setSlots((prev) => {\n      if (prev.length === bracketSize) return prev;\n      if (bracketSize > prev.length) {\n        return [...prev, ...Array.from({ length: bracketSize - prev.length }, () => null)];\n      }\n      return prev.slice(0, bracketSize);\n    });\n  }, [bracketSize]);\n\n  useEffect(() => {\n    if (activeSlotIndex !== null && activeSlotIndex >= bracketSize) {\n      closeSlotEditor();\n    }\n  }, [activeSlotIndex, bracketSize]);\n\n  useEffect(() => {\n    if (!data?.error) return;\n    if (data.error === \"UNAUTHENTICATED\") setAuthError(\"login\");\n    if (data.error === \"FORBIDDEN\") setAuthError(\"organizador\");\n  }, [data?.error]);\n\n  useEffect(() => {\n    if (slotMode !== \"user\") {\n      setSearchResults([]);\n      setSearching(false);\n      return;\n    }\n    if (!searchTerm.trim()) {\n      setSearchResults([]);\n      setSearching(false);\n      return;\n    }\n    let active = true;\n    setSearching(true);\n    const term = searchTerm.trim();\n    const timer = setTimeout(async () => {\n      try {\n        const res = await fetch(`/api/users/search?q=${encodeURIComponent(term)}&limit=6`);\n        const json = await res.json().catch(() => null);\n        if (!active) return;\n        if (!res.ok || !json?.ok) {\n          setSearchResults([]);\n          return;\n        }\n        setSearchResults(Array.isArray(json.results) ? (json.results as UserResult[]) : []);\n      } catch {\n        if (active) setSearchResults([]);\n      } finally {\n        if (active) setSearching(false);\n      }\n    }, 250);\n    return () => {\n      active = false;\n      clearTimeout(timer);\n    };\n  }, [searchTerm, slotMode]);\n\n  const nextNegativeId = () => {\n    const min = slots.reduce((acc, item) => {\n      if (item && item.id < acc) return item.id;\n      return acc;\n    }, 0);\n    return min <= -1 ? min - 1 : -1;\n  };\n\n  const openSlotEditor = (index: number) => {\n    const current = slots[index];\n    setActiveSlotIndex(index);\n    setSlotMode(current?.username ? \"user\" : \"guest\");\n    setSlotDraft({\n      id: current?.id ?? nextNegativeId(),\n      name: current?.name ?? \"\",\n      username: current?.username ?? \"\",\n      email: current?.email ?? \"\",\n      avatarUrl: current?.avatarUrl ?? null,\n    });\n    setSearchTerm(\"\");\n    setSearchResults([]);\n  };\n\n  const closeSlotEditor = () => {\n    setActiveSlotIndex(null);\n    setSlotDraft({ name: \"\", username: \"\", email: \"\", avatarUrl: null });\n    setSearchTerm(\"\");\n    setSearchResults([]);\n  };\n\n  const applyUserToDraft = (user: UserResult) => {\n    const displayName = user.fullName || (user.username ? `@${user.username}` : \"\");\n    setSlotDraft((prev) => ({\n      ...prev,\n      name: displayName,\n      username: user.username ?? \"\",\n      avatarUrl: user.avatarUrl ?? null,\n      email: \"\",\n    }));\n    setSlotMode(\"user\");\n  };\n\n  const handleSlotAvatarUpload = async (file: File | null) => {\n    if (!file) return;\n    setUploadingAvatar(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload\", { method: \"POST\", body: formData });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.url) {\n        setParticipantsMessage(json?.error || \"Falha no upload da imagem.\");\n        return;\n      }\n      setSlotDraft((prev) => ({ ...prev, avatarUrl: json.url as string }));\n    } catch {\n      setParticipantsMessage(\"Erro ao carregar imagem.\");\n    } finally {\n      setUploadingAvatar(false);\n    }\n  };\n\n  useEffect(() => {\n    if (activeSlotIndex === null) return;\n    const name = slotDraft.name.trim();\n    if (!name) return;\n    if (slotDraftTimerRef.current) clearTimeout(slotDraftTimerRef.current);\n    slotDraftTimerRef.current = setTimeout(() => {\n      const next: Participant = {\n        id: slotDraft.id ?? nextNegativeId(),\n        name,\n        username: slotMode === \"user\" ? slotDraft.username.trim().replace(/^@/, \"\") || null : null,\n        email: slotMode === \"guest\" ? slotDraft.email.trim().toLowerCase() || null : null,\n        avatarUrl: slotDraft.avatarUrl?.trim() || null,\n        seed: activeSlotIndex + 1,\n      };\n      setSlots((prev) => {\n        const current = prev[activeSlotIndex];\n        if (\n          current &&\n          current.id === next.id &&\n          current.name === next.name &&\n          (current.username ?? null) === (next.username ?? null) &&\n          (current.email ?? null) === (next.email ?? null) &&\n          (current.avatarUrl ?? null) === (next.avatarUrl ?? null)\n        ) {\n          return prev;\n        }\n        const copy = [...prev];\n        copy[activeSlotIndex] = next;\n        return copy;\n      });\n    }, 400);\n    return () => {\n      if (slotDraftTimerRef.current) clearTimeout(slotDraftTimerRef.current);\n    };\n  }, [activeSlotIndex, slotDraft, slotMode]);\n\n  const clearSlot = () => {\n    if (activeSlotIndex === null) return;\n    setSlots((prev) => {\n      const copy = [...prev];\n      copy[activeSlotIndex] = null;\n      return copy;\n    });\n    setParticipantsMessage(null);\n    closeSlotEditor();\n  };\n\n  const moveSlot = (from: number, to: number) => {\n    setSlots((prev) => {\n      if (to < 0 || to >= prev.length) return prev;\n      const copy = [...prev];\n      const temp = copy[from];\n      copy[from] = copy[to];\n      copy[to] = temp;\n      return copy;\n    });\n  };\n\n  const tournament = data?.tournament;\n  const tieBreakRules: TieBreakRule[] = Array.isArray(tournament?.tieBreakRules)\n    ? (tournament.tieBreakRules as TieBreakRule[])\n    : ([\"WINS\", \"SET_DIFF\", \"GAME_DIFF\", \"HEAD_TO_HEAD\", \"RANDOM\"] as TieBreakRule[]);\n\n  const stages = useMemo(\n    () =>\n      tournament\n        ? tournament.stages.map((s: any) => ({\n            ...s,\n            groups: s.groups.map((g: any) => ({\n              ...g,\n              standings: computeStandingsForGroup(g.matches, tieBreakRules, tournament.generationSeed || undefined),\n              matches: g.matches.map((m: any) => ({ ...m, statusLabel: summarizeMatchStatus(m.status) })),\n            })),\n            matches: s.matches.map((m: any) => ({ ...m, statusLabel: summarizeMatchStatus(m.status) })),\n          }))\n        : [],\n    [tournament, tieBreakRules],\n  );\n\n  const flatMatches = useMemo(\n    () => stages.flatMap((s: any) => [...s.matches, ...s.groups.flatMap((g: any) => g.matches)]),\n    [stages],\n  );\n\n  const warnings = useMemo(\n    () =>\n      tournament\n        ? computeLiveWarnings({\n            matches: flatMatches,\n            pairings: data?.pairings ?? [],\n            startThresholdMinutes: 60,\n          })\n        : [],\n    [tournament, flatMatches, data?.pairings],\n  );\n\n  const [filters, setFilters] = useState<any>({\n    status: null,\n    stageId: null,\n    court: null,\n    todayOnly: false,\n    search: \"\",\n  });\n  const filledCount = slots.filter(Boolean).length;\n\n  const saveParticipants = async (options?: { silent?: boolean }) => {\n    if (savingParticipants) return;\n    const filled = slots.filter((p): p is Participant => Boolean(p));\n    if (filled.length > bracketSize) {\n      setParticipantsMessage(\"Há mais participantes do que o tamanho da bracket.\");\n      return;\n    }\n    setSavingParticipants(true);\n    setParticipantsMessage(null);\n    try {\n      const payload = buildParticipantsPayload(slots);\n      const res = await fetch(`/api/organizador/tournaments/${tournamentId}/participants`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ participants: payload, bracketSize }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setParticipantsMessage(json?.error || \"Erro ao guardar participantes.\");\n        return;\n      }\n      const list = Array.isArray(json.participants) ? (json.participants as Participant[]) : [];\n      const nextSize = Number.isFinite(json.bracketSize) ? Number(json.bracketSize) : bracketSize;\n      const nextSlots = buildSlotsFromParticipants(list, nextSize);\n      setBracketSize(nextSize);\n      setSlots(nextSlots);\n      lastSavedKeyRef.current = buildParticipantsKey(nextSlots, nextSize);\n      if (!options?.silent) {\n        setParticipantsMessage(\"Participantes guardados.\");\n      }\n      mutateParticipants();\n    } catch {\n      setParticipantsMessage(\"Erro inesperado ao guardar participantes.\");\n    } finally {\n      setSavingParticipants(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!hasLoadedParticipantsRef.current) return;\n    const nextKey = buildParticipantsKey(slots, bracketSize);\n    if (nextKey === lastSavedKeyRef.current) return;\n    if (autoSaveTimerRef.current) clearTimeout(autoSaveTimerRef.current);\n    autoSaveTimerRef.current = setTimeout(() => {\n      saveParticipants({ silent: true });\n    }, 700);\n    return () => {\n      if (autoSaveTimerRef.current) clearTimeout(autoSaveTimerRef.current);\n    };\n  }, [slots, bracketSize]);\n\n  const generateBracket = async () => {\n    const count = slots.filter(Boolean).length;\n    if (count === 0) {\n      setGenerationMessage(\"Adiciona participantes antes de gerar a bracket.\");\n      return;\n    }\n    if (count > bracketSize) {\n      setGenerationMessage(\"Há mais participantes do que o tamanho da bracket.\");\n      return;\n    }\n    const shouldRegenerate = flatMatches.length > 0;\n    if (shouldRegenerate) {\n      const confirmed = window.confirm(\n        \"Já existem jogos. Gerar novamente vai apagar resultados e reagendar a bracket. Queres continuar?\",\n      );\n      if (!confirmed) return;\n    }\n    setGenerating(true);\n    setGenerationMessage(null);\n    try {\n      const res = await fetch(`/api/organizador/tournaments/${tournamentId}/generate`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ source: \"manual\", bracketSize, forceGenerate: shouldRegenerate }),\n      });\n      const json = await res.json().catch(() => null);\n      if (!res.ok || !json?.ok) {\n        setGenerationMessage(json?.error || \"Erro ao gerar bracket.\");\n        return;\n      }\n      setGenerationMessage(\"Bracket gerada.\");\n    } catch {\n      setGenerationMessage(\"Erro inesperado ao gerar bracket.\");\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const filteredMatches = useMemo(() => {\n    const now = new Date();\n    return flatMatches.filter((m: any) => {\n      if (filters.status && m.status !== filters.status) return false;\n      if (filters.stageId && m.stageId !== filters.stageId) return false;\n      if (filters.court && `${m.courtId ?? \"\"}` !== filters.court) return false;\n      if (filters.todayOnly && m.startAt) {\n        const d = new Date(m.startAt);\n        if (\n          d.getFullYear() !== now.getFullYear() ||\n          d.getMonth() !== now.getMonth() ||\n          d.getDate() !== now.getDate()\n        )\n          return false;\n      }\n      if (filters.search) {\n        const term = filters.search.trim();\n        if (!term) return true;\n        return `${m.pairing1Id ?? \"\"}`.includes(term) || `${m.pairing2Id ?? \"\"}`.includes(term);\n      }\n      return true;\n    });\n  }, [flatMatches, filters]);\n\n  if (!isValidTournamentId) {\n    return (\n      <div className=\"p-4 text-white/70\">\n        <p>ID de torneio inválido.</p>\n        <button\n          onClick={() => router.back()}\n          className=\"mt-3 rounded-full border border-white/20 px-3 py-1 text-sm text-white hover:border-white/40\"\n        >\n          Voltar\n        </button>\n      </div>\n    );\n  }\n\n  if (error) {\n    return <div className=\"p-4 text-white/70\">Erro a carregar dados do torneio.</div>;\n  }\n\n  if (!tournament) return <div className=\"p-4 text-white/70\">A carregar…</div>;\n\n  const summary = {\n    pending: flatMatches.filter((m: any) => m.status === \"PENDING\").length,\n    inProgress: flatMatches.filter((m: any) => m.status === \"IN_PROGRESS\").length,\n    done: flatMatches.filter((m: any) => m.status === \"DONE\").length,\n  };\n  const showLivePanel = tournament?.event?.isFree === false;\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"space-y-4 rounded-2xl border border-white/10 bg-black/40 p-4\">\n        <div className=\"flex flex-wrap items-center justify-between gap-3\">\n          <div>\n            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/60\">Preparação</p>\n            <h2 className=\"text-lg font-semibold text-white\">Bracket & participantes</h2>\n            <p className=\"text-sm text-white/60\">Define o tamanho e prepara a lista de jogadores.</p>\n          </div>\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <span className=\"rounded-full border border-white/15 px-3 py-1 text-xs text-white/60\">\n              {savingParticipants ? \"A guardar…\" : \"Auto-guardar ativo\"}\n            </span>\n            <button\n              type=\"button\"\n              onClick={generateBracket}\n              disabled={generating}\n              className=\"rounded-full border border-emerald-400/40 bg-emerald-500/10 px-3 py-1 text-sm text-emerald-100 hover:border-emerald-300/60 disabled:opacity-60\"\n            >\n              {generating ? \"A gerar…\" : \"Gerar bracket\"}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"grid gap-4 lg:grid-cols-[240px_1fr]\">\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium text-white/80\">Tamanho da bracket</label>\n              <select\n                value={bracketSize}\n                onChange={(e) => {\n                  const nextSize = Number(e.target.value);\n                  if (filledCount > nextSize) {\n                    const ok = window.confirm(\"A bracket vai ficar menor do que o numero de jogadores. Continuar?\");\n                    if (!ok) return;\n                  }\n                  setBracketSize(nextSize);\n                }}\n                className=\"w-full rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/80\"\n              >\n                {[2, 4, 8, 16, 32, 64].map((size) => (\n                  <option key={size} value={size}>\n                    {size} jogadores\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-[11px] text-white/50\">\n                {filledCount} participantes · ordem top-down/left-right\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-white/10 bg-white/5 p-3 text-[11px] text-white/60\">\n              Preenche os slots na ordem desejada. Cada slot corresponde a uma posicao no bracket.\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div className=\"grid gap-3 sm:grid-cols-2 lg:grid-cols-3\">\n              {slots.map((slot, idx) => {\n                const isActive = activeSlotIndex === idx;\n                return (\n                  <div key={`slot-${idx}`} className=\"rounded-xl border border-white/10 bg-white/5 p-3 space-y-3\">\n                    <div className=\"flex items-center justify-between text-[11px] text-white/60\">\n                      <span>Seed {idx + 1}</span>\n                      <div className=\"flex items-center gap-1\">\n                        <button\n                          type=\"button\"\n                          onClick={() => moveSlot(idx, idx - 1)}\n                          disabled={!slot || idx === 0}\n                          className=\"rounded-full border border-white/15 px-2 py-0.5 text-[10px] text-white/70 hover:border-white/40 disabled:opacity-50\"\n                        >\n                          Subir\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => moveSlot(idx, idx + 1)}\n                          disabled={!slot || idx === slots.length - 1}\n                          className=\"rounded-full border border-white/15 px-2 py-0.5 text-[10px] text-white/70 hover:border-white/40 disabled:opacity-50\"\n                        >\n                          Descer\n                        </button>\n                      </div>\n                    </div>\n                    {slot ? (\n                      <>\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"h-10 w-10 overflow-hidden rounded-full border border-white/10 bg-white/10\">\n                            {/* eslint-disable-next-line @next/next/no-img-element */}\n                            <img\n                              src={slot.avatarUrl || DEFAULT_GUEST_AVATAR}\n                              alt={slot.name}\n                              className=\"h-full w-full object-cover\"\n                            />\n                          </div>\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate text-sm font-medium text-white\">{slot.name}</p>\n                            <p className=\"text-[11px] text-white/50\">\n                              {slot.username ? `@${slot.username}` : \"Convidado\"}\n                              {slot.email ? ` · ${slot.email}` : \"\"}\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <button\n                            type=\"button\"\n                            onClick={() => (isActive ? closeSlotEditor() : openSlotEditor(idx))}\n                            className=\"rounded-full border border-white/20 px-3 py-1 text-[11px] text-white/70 hover:border-white/40\"\n                          >\n                            {isActive ? \"Fechar\" : \"Editar\"}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              setSlots((prev) => {\n                                const copy = [...prev];\n                                copy[idx] = null;\n                                return copy;\n                              });\n                            }}\n                            className=\"rounded-full border border-white/10 px-3 py-1 text-[11px] text-white/50 hover:border-white/30\"\n                          >\n                            Limpar\n                          </button>\n                        </div>\n                      </>\n                    ) : (\n                      <div className=\"space-y-2 text-sm text-white/60\">\n                        <p>Slot vazio</p>\n                        <button\n                          type=\"button\"\n                          onClick={() => (isActive ? closeSlotEditor() : openSlotEditor(idx))}\n                          className=\"rounded-full border border-white/20 px-3 py-1 text-[11px] text-white/70 hover:border-white/40\"\n                        >\n                          {isActive ? \"Fechar\" : \"Adicionar jogador\"}\n                        </button>\n                      </div>\n                    )}\n\n                    {isActive && (\n                      <div className=\"rounded-xl border border-white/10 bg-black/40 p-3 space-y-3\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/60\">\n                              Slot {idx + 1}\n                            </p>\n                            <h3 className=\"text-base font-semibold text-white\">Editar jogador</h3>\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={closeSlotEditor}\n                            className=\"rounded-full border border-white/15 px-3 py-1 text-[11px] text-white/70 hover:border-white/40\"\n                          >\n                            Fechar\n                          </button>\n                        </div>\n\n                        <div className=\"flex flex-wrap gap-2 text-xs\">\n                          {([\"user\", \"guest\"] as const).map((mode) => (\n                            <button\n                              key={mode}\n                              type=\"button\"\n                              onClick={() => {\n                                if (mode === slotMode) return;\n                                setSlotMode(mode);\n                                if (mode === \"guest\") {\n                                  setSlotDraft((prev) => ({ ...prev, username: \"\", avatarUrl: null }));\n                                }\n                                if (mode === \"user\") {\n                                  setSlotDraft((prev) => ({ ...prev, email: \"\", avatarUrl: null }));\n                                }\n                              }}\n                              className={`rounded-full border px-3 py-1 ${\n                                slotMode === mode\n                                  ? \"border-fuchsia-400/40 bg-fuchsia-500/10 text-fuchsia-100\"\n                                  : \"border-white/15 bg-white/5 text-white/60\"\n                              }`}\n                            >\n                              {mode === \"user\" ? \"Utilizador ORYA\" : \"Convidado\"}\n                            </button>\n                          ))}\n                        </div>\n\n                        <div className=\"grid gap-3 md:grid-cols-2\">\n                          <label className=\"text-sm text-white/70\">\n                            Nome\n                            <input\n                              value={slotDraft.name}\n                              onChange={(e) => setSlotDraft((prev) => ({ ...prev, name: e.target.value }))}\n                              placeholder=\"Nome publico\"\n                              className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                            />\n                          </label>\n                          {slotMode === \"guest\" && (\n                            <label className=\"text-sm text-white/70\">\n                              Email (para reclamar)\n                              <input\n                                value={slotDraft.email}\n                                onChange={(e) => setSlotDraft((prev) => ({ ...prev, email: e.target.value }))}\n                                placeholder=\"email@dominio.com\"\n                                className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                              />\n                            </label>\n                          )}\n                          {slotMode === \"user\" && (\n                            <label className=\"text-sm text-white/70\">\n                              Username\n                              <input\n                                value={slotDraft.username}\n                                onChange={(e) => setSlotDraft((prev) => ({ ...prev, username: e.target.value }))}\n                                placeholder=\"@username\"\n                                className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                              />\n                            </label>\n                          )}\n                        </div>\n\n                        {slotMode === \"user\" && (\n                          <div className=\"space-y-2\">\n                            <label className=\"text-sm text-white/70\">\n                              Procurar utilizador\n                              <input\n                                value={searchTerm}\n                                onChange={(e) => setSearchTerm(e.target.value)}\n                                placeholder=\"Nome ou @username\"\n                                className=\"mt-1 w-full rounded-xl border border-white/15 bg-black/40 px-3 py-2 text-sm text-white\"\n                              />\n                            </label>\n                            {searching && <p className=\"text-[11px] text-white/50\">A procurar...</p>}\n                            {!searching && searchTerm && searchResults.length === 0 && (\n                              <p className=\"text-[11px] text-white/50\">Sem resultados.</p>\n                            )}\n                            {searchResults.length > 0 && (\n                              <div className=\"grid gap-2 md:grid-cols-2\">\n                                {searchResults.map((user) => (\n                                  <button\n                                    key={user.id}\n                                    type=\"button\"\n                                    onClick={() => applyUserToDraft(user)}\n                                    className=\"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-left text-sm text-white/80 hover:border-white/30\"\n                                  >\n                                    <div className=\"h-8 w-8 overflow-hidden rounded-full border border-white/10 bg-white/10\">\n                                      {/* eslint-disable-next-line @next/next/no-img-element */}\n                                      <img\n                                        src={user.avatarUrl || DEFAULT_GUEST_AVATAR}\n                                        alt={user.fullName ?? \"\"}\n                                        className=\"h-full w-full object-cover\"\n                                      />\n                                    </div>\n                                    <div className=\"min-w-0\">\n                                      <p className=\"truncate text-sm\">{user.fullName || user.username || \"Utilizador\"}</p>\n                                      {user.username && <p className=\"text-[11px] text-white/50\">@{user.username}</p>}\n                                    </div>\n                                  </button>\n                                ))}\n                              </div>\n                            )}\n                          </div>\n                        )}\n\n                        {slotMode === \"guest\" ? (\n                          <div className=\"space-y-2\">\n                            <p className=\"text-sm text-white/70\">Avatar (upload)</p>\n                            <div className=\"flex flex-wrap items-center gap-3 text-[11px] text-white/60\">\n                              <label className=\"cursor-pointer rounded-full border border-white/15 px-3 py-1 hover:border-white/40\">\n                                {uploadingAvatar ? \"A carregar...\" : \"Upload imagem\"}\n                                <input\n                                  type=\"file\"\n                                  accept=\"image/*\"\n                                  className=\"hidden\"\n                                  disabled={uploadingAvatar}\n                                  onChange={(e) => handleSlotAvatarUpload(e.target.files?.[0] ?? null)}\n                                />\n                              </label>\n                              {slotDraft.avatarUrl && (\n                                <button\n                                  type=\"button\"\n                                  onClick={() => setSlotDraft((prev) => ({ ...prev, avatarUrl: null }))}\n                                  className=\"rounded-full border border-white/10 px-3 py-1 text-[11px] text-white/50 hover:border-white/30\"\n                                >\n                                  Remover imagem\n                                </button>\n                              )}\n                              {!slotDraft.avatarUrl && (\n                                <span className=\"text-white/50\">Se não fizer upload, usa o avatar default.</span>\n                              )}\n                            </div>\n                          </div>\n                        ) : (\n                          <p className=\"text-[11px] text-white/50\">Usa o avatar do utilizador ORYA.</p>\n                        )}\n\n                        <div className=\"flex flex-wrap items-center gap-2\">\n                          <span className=\"text-[11px] text-white/50\">Guarda automaticamente.</span>\n                          <button\n                            type=\"button\"\n                            onClick={clearSlot}\n                            className=\"rounded-full border border-white/10 px-4 py-2 text-sm text-white/60 hover:border-white/30\"\n                          >\n                            Limpar slot\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n\n        {(participantsMessage || generationMessage) && (\n          <p className=\"text-[12px] text-white/70\">\n            {participantsMessage || generationMessage}\n          </p>\n        )}\n      </div>\n\n      {showLivePanel && (\n        <div className=\"space-y-4 rounded-2xl border border-white/10 bg-black/40 p-4\">\n          <div className=\"flex items-center justify-between gap-2\">\n            <div>\n              <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/60\">Live Torneio</p>\n              <h1 className=\"text-xl font-semibold text-white\">{tournament?.event?.title ?? \"Torneio\"}</h1>\n              <p className=\"text-white/70 text-sm\">Formato: {tournament.format}</p>\n            </div>\n            <div className=\"rounded-xl border border-white/15 bg-white/5 px-3 py-2 text-sm text-white/80\">\n              <p>Jogos: {flatMatches.length}</p>\n              <p>Pendentes {summary.pending} · Em jogo {summary.inProgress} · Terminados {summary.done}</p>\n            </div>\n          </div>\n\n          {warnings.length > 0 && (\n            <div className=\"rounded-xl border border-amber-400/40 bg-amber-400/10 p-3 text-sm text-amber-100\">\n              <p className=\"font-semibold\">Avisos</p>\n              <ul className=\"list-disc pl-4 space-y-1\">\n                {warnings.map((w: any, idx: number) => (\n                  <li key={`${w.type}-${w.matchId ?? w.pairingId}-${idx}`}>\n                    {w.type === \"REQUIRES_ACTION\" && <>Jogador #{w.pairingId} exige ação</>}\n                    {w.type === \"MISSING_COURT\" && <>Jogo #{w.matchId}: sem court</>}\n                    {w.type === \"MISSING_START\" && <>Jogo #{w.matchId}: sem horário definido</>}\n                    {w.type === \"INVALID_SCORE\" && <>Jogo #{w.matchId}: score inválido</>}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          <Filters stages={stages} setFilters={setFilters} />\n\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            {stages.map((stage: any) => (\n            <div key={stage.id} className=\"rounded-xl border border-white/10 bg-white/5 p-3 space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-[11px] uppercase tracking-[0.2em] text-white/60\">\n                    {stage.name || stage.stageType}\n                  </p>\n                  <p className=\"text-white/75 text-sm\">{stage.matches.length} jogos</p>\n                </div>\n                <div className=\"rounded-full border border-white/15 bg-white/10 px-3 py-1 text-[11px] text-white/70\">\n                  {stage.stageType}\n                </div>\n              </div>\n\n              {stage.groups.length > 0 && (\n                <div className=\"space-y-2\">\n                  {stage.groups.map((group: any) => (\n                    <div key={group.id} className=\"rounded-lg border border-white/10 bg-black/40 p-2\">\n                      <p className=\"text-[12px] text-white/70 mb-1\">{group.name}</p>\n                      <div className=\"space-y-1\">\n                        {group.standings.map((row: any, idx: number) => (\n                          <div key={row.pairingId ?? idx} className=\"flex items-center justify-between text-[12px] text-white/80\">\n                            <span>\n                              #{idx + 1} · Jogador {row.pairingId ?? \"—\"}\n                            </span>\n                            <span>{row.points} pts</span>\n                          </div>\n                        ))}\n                      </div>\n                      <div className=\"mt-2 space-y-1\">\n                        {group.matches.map((match: any) => (\n                          <div\n                            key={match.id}\n                            className=\"rounded border border-white/10 bg-white/5 px-2 py-1 text-[12px] text-white/75\"\n                          >\n                            <div className=\"flex items-center justify-between\">\n                              <span>Jogo #{match.id}</span>\n                              <span>{match.statusLabel}</span>\n                            </div>\n                            <div className=\"text-white/60\">\n                              {match.pairing1Id ?? \"—\"} vs {match.pairing2Id ?? \"—\"}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {stage.matches.length > 0 && (\n                <div className=\"space-y-1\">\n                  {stage.matches.map((match: any) => (\n                    <div\n                      key={match.id}\n                      className=\"rounded border border-white/10 bg-white/5 px-3 py-2 text-[12px] text-white/75\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Jogo #{match.id}</span>\n                        <span>{match.statusLabel}</span>\n                      </div>\n                      <div className=\"text-white/60\">\n                        {match.pairing1Id ?? \"—\"} vs {match.pairing2Id ?? \"—\"}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function OrganizerTournamentLivePage({ params }: PageProps) {\n  const resolvedParams = use(params);\n  const tournamentId = Number(resolvedParams.id);\n  const router = useRouter();\n  const isValidTournamentId = Number.isFinite(tournamentId);\n  const { data } = useSWR(\n    isValidTournamentId ? `/api/organizador/tournaments/${tournamentId}/live` : null,\n    fetcher,\n  );\n\n  useEffect(() => {\n    const eventId = data?.tournament?.event?.id;\n    if (Number.isFinite(eventId)) {\n      router.replace(`/organizador/eventos/${eventId}/live?tab=bracket`);\n    }\n  }, [data?.tournament?.event?.id, router]);\n\n  return (\n    <div className=\"p-4 text-white/70\">\n      A redirecionar para a preparação do evento...\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8008, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/eventos/EventLiveDashboardClient.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { useSearchParams } from \"next/navigation\";\nimport EventLivePrepClient from \"@/app/organizador/(dashboard)/eventos/EventLivePrepClient\";\nimport EventLiveClient from \"@/app/eventos/[slug]/EventLiveClient\";\nimport { TournamentLiveManager } from \"@/app/organizador/(dashboard)/tournaments/[id]/live/page\";\n\ntype LiveHubVisibility = \"PUBLIC\" | \"PRIVATE\" | \"DISABLED\";\n\ntype Props = {\n  event: {\n    id: number;\n    slug: string;\n    title: string;\n    liveHubVisibility: LiveHubVisibility;\n    liveStreamUrl: string | null;\n    templateType?: string | null;\n  };\n  tournamentId: number | null;\n  canManageLiveConfig: boolean;\n};\n\nconst TABS = [\n  { id: \"setup\", label: \"LiveHub\" },\n  { id: \"bracket\", label: \"Bracket\" },\n  { id: \"preview\", label: \"Preview\" },\n] as const;\n\nexport default function EventLiveDashboardClient({ event, tournamentId, canManageLiveConfig }: Props) {\n  const searchParams = useSearchParams();\n  const tabs = TABS.filter((item) => (canManageLiveConfig ? true : item.id === \"preview\"));\n  const requestedTab = searchParams?.get(\"tab\") || (canManageLiveConfig ? \"setup\" : \"preview\");\n  const tab = tabs.find((item) => item.id === requestedTab)?.id ?? tabs[0]?.id ?? \"preview\";\n\n  const basePath = `/organizador/eventos/${event.id}/live`;\n\n  return (\n    <div className=\"space-y-6\">\n      <header className=\"rounded-3xl border border-white/12 bg-gradient-to-br from-white/10 via-[#0b1226]/70 to-[#050912]/90 p-5 shadow-[0_26px_90px_rgba(0,0,0,0.6)] backdrop-blur-2xl\">\n        <div className=\"flex flex-wrap items-center justify-between gap-3\">\n          <div>\n            <p className=\"text-[11px] uppercase tracking-[0.24em] text-white/60\">Gerir · Preparar live</p>\n            <h1 className=\"text-2xl font-semibold text-white\">{event.title}</h1>\n            <p className=\"text-sm text-white/60\">Configura LiveHub, bracket e preview no mesmo lugar.</p>\n          </div>\n        </div>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          {tabs.map((item) => {\n            const params = new URLSearchParams(searchParams?.toString());\n            params.set(\"tab\", item.id);\n            if (item.id === \"preview\") {\n              params.set(\"edit\", \"1\");\n            } else {\n              params.delete(\"edit\");\n            }\n            const href = `${basePath}?${params.toString()}`;\n            return (\n              <Link\n                key={item.id}\n                href={href}\n                className={`rounded-full border px-4 py-1 text-[11px] uppercase tracking-[0.2em] ${\n                  tab === item.id\n                    ? \"border-fuchsia-400/50 bg-fuchsia-500/10 text-fuchsia-100\"\n                    : \"border-white/15 bg-white/5 text-white/60\"\n                }`}\n              >\n                {item.label}\n              </Link>\n            );\n          })}\n        </div>\n      </header>\n\n      {tab === \"setup\" && (\n        <EventLivePrepClient\n          event={{\n            id: event.id,\n            slug: event.slug,\n            title: event.title,\n            liveHubVisibility: event.liveHubVisibility,\n            liveStreamUrl: event.liveStreamUrl,\n          }}\n          tournamentId={tournamentId}\n        />\n      )}\n\n      {tab === \"bracket\" && (\n        <>\n          {!tournamentId && (\n            <div className=\"rounded-2xl border border-amber-400/40 bg-amber-400/10 p-4 text-sm text-amber-100\">\n              Ainda não existe um torneio associado. Cria o torneio no separador LiveHub para começar a preparar a bracket.\n            </div>\n          )}\n          {tournamentId && <TournamentLiveManager tournamentId={tournamentId} />}\n        </>\n      )}\n\n      {tab === \"preview\" && (\n        <div className=\"space-y-4\">\n          <div className=\"rounded-2xl border border-white/10 bg-white/5 p-3 text-sm text-white/70\">\n            Preview do LiveHub com overlay do organizador. Usa <span className=\"text-white\">Editar</span> nos jogos\n            para atualizar resultados.\n          </div>\n          <EventLiveClient slug={event.slug} />\n        </div>\n      )}\n\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAuBA,MAAM,OAAO;IACX;QAAE,IAAI;QAAS,OAAO;IAAU;IAChC;QAAE,IAAI;QAAW,OAAO;IAAU;IAClC;QAAE,IAAI;QAAW,OAAO;IAAU;CACnC;AAEc,SAAS,yBAAyB,EAAE,KAAK,EAAE,YAAY,EAAE,mBAAmB,EAAS;IAClG,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,OAAO,KAAK,MAAM,CAAC,CAAC,OAAU,sBAAsB,OAAO,KAAK,EAAE,KAAK;IAC7E,MAAM,eAAe,cAAc,IAAI,UAAU,CAAC,sBAAsB,UAAU,SAAS;IAC3F,MAAM,MAAM,KAAK,IAAI,CAAC,CAAC,OAAS,KAAK,EAAE,KAAK,eAAe,MAAM,IAAI,CAAC,EAAE,EAAE,MAAM;IAEhF,MAAM,WAAW,CAAC,qBAAqB,EAAE,MAAM,EAAE,CAAC,KAAK,CAAC;IAExD,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;;8CACC,8OAAC;oCAAE,WAAU;8CAAwD;;;;;;8CACrE,8OAAC;oCAAG,WAAU;8CAAqC,MAAM,KAAK;;;;;;8CAC9D,8OAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;;;;;;kCAGzC,8OAAC;wBAAI,WAAU;kCACZ,KAAK,GAAG,CAAC,CAAC;4BACT,MAAM,SAAS,IAAI,gBAAgB,cAAc;4BACjD,OAAO,GAAG,CAAC,OAAO,KAAK,EAAE;4BACzB,IAAI,KAAK,EAAE,KAAK,WAAW;gCACzB,OAAO,GAAG,CAAC,QAAQ;4BACrB,OAAO;gCACL,OAAO,MAAM,CAAC;4BAChB;4BACA,MAAM,OAAO,GAAG,SAAS,CAAC,EAAE,OAAO,QAAQ,IAAI;4BAC/C,qBACE,8OAAC,uKAAI;gCAEH,MAAM;gCACN,WAAW,CAAC,qEAAqE,EAC/E,QAAQ,KAAK,EAAE,GACX,6DACA,4CACJ;0CAED,KAAK,KAAK;+BARN,KAAK,EAAE;;;;;wBAWlB;;;;;;;;;;;;YAIH,QAAQ,yBACP,8OAAC,iLAAmB;gBAClB,OAAO;oBACL,IAAI,MAAM,EAAE;oBACZ,MAAM,MAAM,IAAI;oBAChB,OAAO,MAAM,KAAK;oBAClB,mBAAmB,MAAM,iBAAiB;oBAC1C,eAAe,MAAM,aAAa;gBACpC;gBACA,cAAc;;;;;;YAIjB,QAAQ,2BACP;;oBACG,CAAC,8BACA,8OAAC;wBAAI,WAAU;kCAAoF;;;;;;oBAIpG,8BAAgB,8OAAC,sMAAqB;wBAAC,cAAc;;;;;;;;YAIzD,QAAQ,2BACP,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;4BAA0E;0CACpC,8OAAC;gCAAK,WAAU;0CAAa;;;;;;4BAAa;;;;;;;kCAG/F,8OAAC,yJAAe;wBAAC,MAAM,MAAM,IAAI;;;;;;;;;;;;;;;;;;AAM3C"}}]
}