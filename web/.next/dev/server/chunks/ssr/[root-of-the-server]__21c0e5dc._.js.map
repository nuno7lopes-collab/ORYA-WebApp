{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/organizerPermissions.ts"],"sourcesContent":["import { OrganizerMemberRole } from \"@prisma/client\";\n\nconst ROLE_WEIGHT: Record<OrganizerMemberRole, number> = {\n  [OrganizerMemberRole.VIEWER]: 0,\n  [OrganizerMemberRole.STAFF]: 1,\n  [OrganizerMemberRole.ADMIN]: 2,\n  [OrganizerMemberRole.CO_OWNER]: 3,\n  [OrganizerMemberRole.OWNER]: 4,\n};\n\nconst ADMIN_MANAGEABLE = new Set<OrganizerMemberRole>([\n  OrganizerMemberRole.STAFF,\n  OrganizerMemberRole.VIEWER,\n]);\n\nconst CO_OWNER_MANAGEABLE = new Set<OrganizerMemberRole>([\n  OrganizerMemberRole.ADMIN,\n  OrganizerMemberRole.STAFF,\n  OrganizerMemberRole.VIEWER,\n]);\n\nexport function isOrgOwner(role: OrganizerMemberRole | null | undefined) {\n  return role === OrganizerMemberRole.OWNER;\n}\n\nexport function isOrgCoOwnerOrAbove(role: OrganizerMemberRole | null | undefined) {\n  return role ? ROLE_WEIGHT[role] >= ROLE_WEIGHT[OrganizerMemberRole.CO_OWNER] : false;\n}\n\nexport function isOrgAdminOrAbove(role: OrganizerMemberRole | null | undefined) {\n  return role ? ROLE_WEIGHT[role] >= ROLE_WEIGHT[OrganizerMemberRole.ADMIN] : false;\n}\n\nexport function canManageEvents(role: OrganizerMemberRole | null | undefined) {\n  return isOrgAdminOrAbove(role);\n}\n\nexport function canManageBilling(role: OrganizerMemberRole | null | undefined) {\n  return role === OrganizerMemberRole.OWNER;\n}\n\nexport function canManageMembers(\n  actorRole: OrganizerMemberRole | null | undefined,\n  targetCurrentRole: OrganizerMemberRole | null | undefined,\n  desiredRole: OrganizerMemberRole | null | undefined,\n) {\n  if (!actorRole) return false;\n  if (actorRole === OrganizerMemberRole.OWNER) return true;\n\n  if (actorRole === OrganizerMemberRole.CO_OWNER) {\n    if (\n      targetCurrentRole === OrganizerMemberRole.OWNER ||\n      targetCurrentRole === OrganizerMemberRole.CO_OWNER ||\n      desiredRole === OrganizerMemberRole.OWNER ||\n      desiredRole === OrganizerMemberRole.CO_OWNER\n    ) {\n      return false;\n    }\n    const target = targetCurrentRole ?? desiredRole;\n    return target ? CO_OWNER_MANAGEABLE.has(target) : true;\n  }\n\n  if (actorRole === OrganizerMemberRole.ADMIN) {\n    const target = targetCurrentRole ?? desiredRole;\n    if (target && !ADMIN_MANAGEABLE.has(target)) return false;\n    return desiredRole ? ADMIN_MANAGEABLE.has(desiredRole) : true;\n  }\n\n  return false;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAEA,MAAM,cAAmD;IACvD,CAAC,oJAAmB,CAAC,MAAM,CAAC,EAAE;IAC9B,CAAC,oJAAmB,CAAC,KAAK,CAAC,EAAE;IAC7B,CAAC,oJAAmB,CAAC,KAAK,CAAC,EAAE;IAC7B,CAAC,oJAAmB,CAAC,QAAQ,CAAC,EAAE;IAChC,CAAC,oJAAmB,CAAC,KAAK,CAAC,EAAE;AAC/B;AAEA,MAAM,mBAAmB,IAAI,IAAyB;IACpD,oJAAmB,CAAC,KAAK;IACzB,oJAAmB,CAAC,MAAM;CAC3B;AAED,MAAM,sBAAsB,IAAI,IAAyB;IACvD,oJAAmB,CAAC,KAAK;IACzB,oJAAmB,CAAC,KAAK;IACzB,oJAAmB,CAAC,MAAM;CAC3B;AAEM,SAAS,WAAW,IAA4C;IACrE,OAAO,SAAS,oJAAmB,CAAC,KAAK;AAC3C;AAEO,SAAS,oBAAoB,IAA4C;IAC9E,OAAO,OAAO,WAAW,CAAC,KAAK,IAAI,WAAW,CAAC,oJAAmB,CAAC,QAAQ,CAAC,GAAG;AACjF;AAEO,SAAS,kBAAkB,IAA4C;IAC5E,OAAO,OAAO,WAAW,CAAC,KAAK,IAAI,WAAW,CAAC,oJAAmB,CAAC,KAAK,CAAC,GAAG;AAC9E;AAEO,SAAS,gBAAgB,IAA4C;IAC1E,OAAO,kBAAkB;AAC3B;AAEO,SAAS,iBAAiB,IAA4C;IAC3E,OAAO,SAAS,oJAAmB,CAAC,KAAK;AAC3C;AAEO,SAAS,iBACd,SAAiD,EACjD,iBAAyD,EACzD,WAAmD;IAEnD,IAAI,CAAC,WAAW,OAAO;IACvB,IAAI,cAAc,oJAAmB,CAAC,KAAK,EAAE,OAAO;IAEpD,IAAI,cAAc,oJAAmB,CAAC,QAAQ,EAAE;QAC9C,IACE,sBAAsB,oJAAmB,CAAC,KAAK,IAC/C,sBAAsB,oJAAmB,CAAC,QAAQ,IAClD,gBAAgB,oJAAmB,CAAC,KAAK,IACzC,gBAAgB,oJAAmB,CAAC,QAAQ,EAC5C;YACA,OAAO;QACT;QACA,MAAM,SAAS,qBAAqB;QACpC,OAAO,SAAS,oBAAoB,GAAG,CAAC,UAAU;IACpD;IAEA,IAAI,cAAc,oJAAmB,CAAC,KAAK,EAAE;QAC3C,MAAM,SAAS,qBAAqB;QACpC,IAAI,UAAU,CAAC,iBAAiB,GAAG,CAAC,SAAS,OAAO;QACpD,OAAO,cAAc,iBAAiB,GAAG,CAAC,eAAe;IAC3D;IAEA,OAAO;AACT"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/eventos/EventLiveDashboardClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/organizador/(dashboard)/eventos/EventLiveDashboardClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/(dashboard)/eventos/EventLiveDashboardClient.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAoU,GACjW,kGACA","ignoreList":[0]}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/eventos/EventLiveDashboardClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/organizador/(dashboard)/eventos/EventLiveDashboardClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/organizador/(dashboard)/eventos/EventLiveDashboardClient.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAgT,GAC7U,8EACA","ignoreList":[0]}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/organizador/%28dashboard%29/eventos/%5Bid%5D/live/page.tsx"],"sourcesContent":["// app/organizador/(dashboard)/eventos/[id]/live/page.tsx\nimport { notFound, redirect } from \"next/navigation\";\nimport { OrganizerMemberRole } from \"@prisma/client\";\nimport { prisma } from \"@/lib/prisma\";\nimport { createSupabaseServer } from \"@/lib/supabaseServer\";\nimport { getActiveOrganizerForUser } from \"@/lib/organizerContext\";\nimport { canManageEvents } from \"@/lib/organizerPermissions\";\nimport EventLiveDashboardClient from \"@/app/organizador/(dashboard)/eventos/EventLiveDashboardClient\";\n\ntype PageProps = {\n  params: Promise<{ id: string }>;\n};\n\nexport default async function OrganizerEventLivePrepPage({ params }: PageProps) {\n  const { id } = await params;\n  const eventId = Number(id);\n  if (!Number.isFinite(eventId)) notFound();\n\n  const supabase = await createSupabaseServer();\n  const { data, error } = await supabase.auth.getUser();\n  if (error || !data?.user) {\n    redirect(`/login?redirectTo=${encodeURIComponent(`/organizador/eventos/${eventId}/live`)}`);\n  }\n\n  const event = await prisma.event.findUnique({\n    where: { id: eventId },\n    select: {\n      id: true,\n      slug: true,\n      title: true,\n      organizerId: true,\n      liveHubVisibility: true,\n      liveStreamUrl: true,\n      templateType: true,\n      tournament: { select: { id: true } },\n    },\n  });\n  if (!event || !event.organizerId) notFound();\n\n  let { organizer, membership } = await getActiveOrganizerForUser(data.user.id, {\n    organizerId: event.organizerId,\n  });\n  if (!organizer) {\n    const legacyOrganizer = await prisma.organizer.findFirst({\n      where: { id: event.organizerId, userId: data.user.id },\n    });\n    if (legacyOrganizer) {\n      organizer = legacyOrganizer;\n      membership = { role: OrganizerMemberRole.OWNER };\n    }\n  }\n\n  if (!organizer || !membership) redirect(\"/organizador\");\n  const canOperateLive = [\n    OrganizerMemberRole.OWNER,\n    OrganizerMemberRole.CO_OWNER,\n    OrganizerMemberRole.ADMIN,\n    OrganizerMemberRole.STAFF,\n  ].includes(membership.role);\n  const canManageLiveConfig = canManageEvents(membership.role);\n  if (!canOperateLive) redirect(\"/organizador?tab=manage\");\n\n  return (\n    <div className=\"w-full px-4 py-8 text-white md:px-6 lg:px-8\">\n      <EventLiveDashboardClient\n        event={{\n          id: event.id,\n          slug: event.slug,\n          title: event.title,\n          liveHubVisibility: event.liveHubVisibility ?? \"PUBLIC\",\n          liveStreamUrl: event.liveStreamUrl ?? null,\n          templateType: event.templateType ?? null,\n        }}\n        tournamentId={event.tournament?.id ?? null}\n        canManageLiveConfig={canManageLiveConfig}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,yDAAyD;;;;;;AACzD;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AAMe,eAAe,2BAA2B,EAAE,MAAM,EAAa;IAC5E,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,UAAU,OAAO;IACvB,IAAI,CAAC,OAAO,QAAQ,CAAC,UAAU,IAAA,iMAAQ;IAEvC,MAAM,WAAW,MAAM,IAAA,6IAAoB;IAC3C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACnD,IAAI,SAAS,CAAC,MAAM,MAAM;QACxB,IAAA,iMAAQ,EAAC,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,qBAAqB,EAAE,QAAQ,KAAK,CAAC,GAAG;IAC5F;IAEA,MAAM,QAAQ,MAAM,uHAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAQ;QACrB,QAAQ;YACN,IAAI;YACJ,MAAM;YACN,OAAO;YACP,aAAa;YACb,mBAAmB;YACnB,eAAe;YACf,cAAc;YACd,YAAY;gBAAE,QAAQ;oBAAE,IAAI;gBAAK;YAAE;QACrC;IACF;IACA,IAAI,CAAC,SAAS,CAAC,MAAM,WAAW,EAAE,IAAA,iMAAQ;IAE1C,IAAI,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,MAAM,IAAA,oJAAyB,EAAC,KAAK,IAAI,CAAC,EAAE,EAAE;QAC5E,aAAa,MAAM,WAAW;IAChC;IACA,IAAI,CAAC,WAAW;QACd,MAAM,kBAAkB,MAAM,uHAAM,CAAC,SAAS,CAAC,SAAS,CAAC;YACvD,OAAO;gBAAE,IAAI,MAAM,WAAW;gBAAE,QAAQ,KAAK,IAAI,CAAC,EAAE;YAAC;QACvD;QACA,IAAI,iBAAiB;YACnB,YAAY;YACZ,aAAa;gBAAE,MAAM,oJAAmB,CAAC,KAAK;YAAC;QACjD;IACF;IAEA,IAAI,CAAC,aAAa,CAAC,YAAY,IAAA,iMAAQ,EAAC;IACxC,MAAM,iBAAiB;QACrB,oJAAmB,CAAC,KAAK;QACzB,oJAAmB,CAAC,QAAQ;QAC5B,oJAAmB,CAAC,KAAK;QACzB,oJAAmB,CAAC,KAAK;KAC1B,CAAC,QAAQ,CAAC,WAAW,IAAI;IAC1B,MAAM,sBAAsB,IAAA,8IAAe,EAAC,WAAW,IAAI;IAC3D,IAAI,CAAC,gBAAgB,IAAA,iMAAQ,EAAC;IAE9B,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,sLAAwB;YACvB,OAAO;gBACL,IAAI,MAAM,EAAE;gBACZ,MAAM,MAAM,IAAI;gBAChB,OAAO,MAAM,KAAK;gBAClB,mBAAmB,MAAM,iBAAiB,IAAI;gBAC9C,eAAe,MAAM,aAAa,IAAI;gBACtC,cAAc,MAAM,YAAY,IAAI;YACtC;YACA,cAAc,MAAM,UAAU,EAAE,MAAM;YACtC,qBAAqB;;;;;;;;;;;AAI7B"}}]
}