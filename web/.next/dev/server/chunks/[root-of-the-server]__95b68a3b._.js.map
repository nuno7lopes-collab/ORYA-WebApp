{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/env.ts"],"sourcesContent":["// Central helper for server-side environment variables (server-only).\n// ⚠️ Não importar este módulo em componentes com \"use client\".\nconst required = [\n  \"SUPABASE_URL\",\n  \"SUPABASE_ANON_KEY\",\n  \"SUPABASE_SERVICE_ROLE\",\n  \"DATABASE_URL\",\n  \"STRIPE_SECRET_KEY\",\n  \"STRIPE_WEBHOOK_SECRET\",\n  \"QR_SECRET_KEY\",\n  \"RESEND_API_KEY\",\n] as const;\n\ntype EnvKey = (typeof required)[number];\n\nfunction getEnv(key: EnvKey): string {\n  const value = process.env[key];\n  if (!value) {\n    throw new Error(`Missing env var: ${key}`);\n  }\n  return value;\n}\n\nfunction getOptionalUrlEnv(...keys: string[]) {\n  for (const key of keys) {\n    const value = process.env[key];\n    if (typeof value === \"string\" && value.trim().length > 0) {\n      return value.trim().replace(/\\/+$/, \"\"); // remove trailing slash para URLs previsíveis\n    }\n  }\n  return \"\";\n}\n\nfunction parseBoolean(raw: unknown, fallback: boolean) {\n  if (typeof raw === \"boolean\") return raw;\n  if (typeof raw === \"string\") {\n    const normalized = raw.trim().toLowerCase();\n    if ([\"1\", \"true\", \"yes\", \"on\"].includes(normalized)) return true;\n    if ([\"0\", \"false\", \"no\", \"off\"].includes(normalized)) return false;\n  }\n  return fallback;\n}\n\nfunction parseNumber(raw: unknown, fallback: number) {\n  const n = Number(raw);\n  return Number.isFinite(n) ? n : fallback;\n}\n\nexport const env = {\n  supabaseUrl: getEnv(\"SUPABASE_URL\"),\n  supabaseAnonKey: getEnv(\"SUPABASE_ANON_KEY\"),\n  serviceRoleKey: getEnv(\"SUPABASE_SERVICE_ROLE\"),\n  dbUrl: getEnv(\"DATABASE_URL\"),\n  stripeSecretKey: getEnv(\"STRIPE_SECRET_KEY\"),\n  stripeWebhookSecret: getEnv(\"STRIPE_WEBHOOK_SECRET\"),\n  qrSecretKey: getEnv(\"QR_SECRET_KEY\"),\n  resendApiKey: getEnv(\"RESEND_API_KEY\"),\n  resendFrom:\n    process.env.RESEND_FROM ??\n    process.env.RESEND_FROM_EMAIL ??\n    \"no-reply@orya.pt\",\n  appBaseUrl: getOptionalUrlEnv(\"APP_BASE_URL\", \"NEXT_PUBLIC_BASE_URL\", \"NEXT_PUBLIC_SITE_URL\", \"VERCEL_URL\"),\n  uploadsBucket:\n    process.env.SUPABASE_STORAGE_BUCKET_UPLOADS ??\n    process.env.SUPABASE_STORAGE_BUCKET ??\n    \"uploads\",\n  avatarsBucket: process.env.SUPABASE_STORAGE_BUCKET_AVATARS ?? \"\",\n  eventCoversBucket: process.env.SUPABASE_STORAGE_BUCKET_EVENT_COVERS ?? \"\",\n  storageSignedUrls: parseBoolean(process.env.SUPABASE_STORAGE_SIGNED_URLS, false),\n  storageSignedTtlSeconds: parseNumber(process.env.SUPABASE_STORAGE_SIGNED_TTL_SECONDS, 60 * 60 * 24 * 30), // 30 dias\n};\n"],"names":[],"mappings":"AAAA,sEAAsE;AACtE,+DAA+D;;;;;AAC/D,MAAM,WAAW;IACf;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAID,SAAS,OAAO,GAAW;IACzB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;IAC9B,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,KAAK;IAC3C;IACA,OAAO;AACT;AAEA,SAAS,kBAAkB,GAAG,IAAc;IAC1C,KAAK,MAAM,OAAO,KAAM;QACtB,MAAM,QAAQ,QAAQ,GAAG,CAAC,IAAI;QAC9B,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,GAAG,MAAM,GAAG,GAAG;YACxD,OAAO,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,KAAK,8CAA8C;QACzF;IACF;IACA,OAAO;AACT;AAEA,SAAS,aAAa,GAAY,EAAE,QAAiB;IACnD,IAAI,OAAO,QAAQ,WAAW,OAAO;IACrC,IAAI,OAAO,QAAQ,UAAU;QAC3B,MAAM,aAAa,IAAI,IAAI,GAAG,WAAW;QACzC,IAAI;YAAC;YAAK;YAAQ;YAAO;SAAK,CAAC,QAAQ,CAAC,aAAa,OAAO;QAC5D,IAAI;YAAC;YAAK;YAAS;YAAM;SAAM,CAAC,QAAQ,CAAC,aAAa,OAAO;IAC/D;IACA,OAAO;AACT;AAEA,SAAS,YAAY,GAAY,EAAE,QAAgB;IACjD,MAAM,IAAI,OAAO;IACjB,OAAO,OAAO,QAAQ,CAAC,KAAK,IAAI;AAClC;AAEO,MAAM,MAAM;IACjB,aAAa,OAAO;IACpB,iBAAiB,OAAO;IACxB,gBAAgB,OAAO;IACvB,OAAO,OAAO;IACd,iBAAiB,OAAO;IACxB,qBAAqB,OAAO;IAC5B,aAAa,OAAO;IACpB,cAAc,OAAO;IACrB,YACE,QAAQ,GAAG,CAAC,WAAW,IACvB,QAAQ,GAAG,CAAC,iBAAiB,IAC7B;IACF,YAAY,kBAAkB,gBAAgB,wBAAwB,wBAAwB;IAC9F,eACE,QAAQ,GAAG,CAAC,+BAA+B,IAC3C,QAAQ,GAAG,CAAC,uBAAuB,IACnC;IACF,eAAe,QAAQ,GAAG,CAAC,+BAA+B,IAAI;IAC9D,mBAAmB,QAAQ,GAAG,CAAC,oCAAoC,IAAI;IACvE,mBAAmB,aAAa,QAAQ,GAAG,CAAC,4BAA4B,EAAE;IAC1E,yBAAyB,YAAY,QAAQ,GAAG,CAAC,mCAAmC,EAAE,KAAK,KAAK,KAAK;AACvG"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/supabaseServer.ts"],"sourcesContent":["import \"server-only\";\nimport { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\nimport { env } from \"@/lib/env\";\n\nfunction decodeBase64Cookie(raw: string) {\n  const BASE64_PREFIX = \"base64-\";\n  if (!raw.startsWith(BASE64_PREFIX)) return raw;\n\n  const base = raw.slice(BASE64_PREFIX.length);\n  const encodings: BufferEncoding[] = [\"base64url\", \"base64\"];\n\n  for (const enc of encodings) {\n    try {\n      return Buffer.from(base, enc).toString(\"utf-8\");\n    } catch {\n      /* try next */\n    }\n  }\n\n  // Se não conseguirmos decodificar, tratamos como cookie ausente para evitar JSON.parse de strings inválidas\n  return undefined;\n}\n\n/**\n * Server-side Supabase client (SSR + Route Handlers)\n * - Safe cookie reading\n * - Safe cookie writing\n * - Prevents JSON parse errors\n * - No profile fetching here\n */\nexport async function createSupabaseServer() {\n  const cookieStore = (await cookies());\n\n  const supabase = createServerClient(\n    env.supabaseUrl,\n    env.supabaseAnonKey,\n    {\n      cookies: {\n        get(name: string) {\n          try {\n            // Só devolvemos cookies do Supabase (sb-*) e ignoramos o resto\n            if (!name.startsWith(\"sb-\")) return undefined;\n            const raw = cookieStore.get(name)?.value;\n            if (!raw) return undefined;\n\n            // Se for um chunk (sb-*.0, sb-*.1, ...), deixamos intacto para o combinador do Supabase tratar\n            const isChunk = /\\.\\d+$/.test(name);\n            return isChunk ? raw : decodeBase64Cookie(raw);\n          } catch {\n            return undefined;\n          }\n        },\n        set(name: string, value: string, options: Record<string, unknown>) {\n          try {\n            cookieStore.set({ name, value, ...options });\n          } catch {\n            /* ignore errors for RSC */\n          }\n        },\n        remove(name: string, options: Record<string, unknown>) {\n          try {\n            cookieStore.set({ name, value: \"\", ...options, maxAge: 0 });\n          } catch {\n            /* ignore */\n          }\n        },\n      },\n    }\n  );\n\n  return supabase;\n}\n\n\nexport async function getCurrentUser() {\n  const supabase = await createSupabaseServer();\n\n  try {\n    const { data, error } = await supabase.auth.getUser();\n\n    if (error || !data?.user) {\n      return { user: null, error };\n    }\n\n    return { user: data.user, error: null };\n  } catch (err) {\n    return { user: null, error: err };\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;AAEA,SAAS,mBAAmB,GAAW;IACrC,MAAM,gBAAgB;IACtB,IAAI,CAAC,IAAI,UAAU,CAAC,gBAAgB,OAAO;IAE3C,MAAM,OAAO,IAAI,KAAK,CAAC,cAAc,MAAM;IAC3C,MAAM,YAA8B;QAAC;QAAa;KAAS;IAE3D,KAAK,MAAM,OAAO,UAAW;QAC3B,IAAI;YACF,OAAO,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,CAAC;QACzC,EAAE,OAAM;QACN,YAAY,GACd;IACF;IAEA,4GAA4G;IAC5G,OAAO;AACT;AASO,eAAe;IACpB,MAAM,cAAe,MAAM,IAAA,4IAAO;IAElC,MAAM,WAAW,IAAA,iMAAkB,EACjC,mHAAG,CAAC,WAAW,EACf,mHAAG,CAAC,eAAe,EACnB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,IAAI;oBACF,+DAA+D;oBAC/D,IAAI,CAAC,KAAK,UAAU,CAAC,QAAQ,OAAO;oBACpC,MAAM,MAAM,YAAY,GAAG,CAAC,OAAO;oBACnC,IAAI,CAAC,KAAK,OAAO;oBAEjB,+FAA+F;oBAC/F,MAAM,UAAU,SAAS,IAAI,CAAC;oBAC9B,OAAO,UAAU,MAAM,mBAAmB;gBAC5C,EAAE,OAAM;oBACN,OAAO;gBACT;YACF;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAgC;gBAC/D,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAM;gBACN,yBAAyB,GAC3B;YACF;YACA,QAAO,IAAY,EAAE,OAAgC;gBACnD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;wBAAE,QAAQ;oBAAE;gBAC3D,EAAE,OAAM;gBACN,UAAU,GACZ;YACF;QACF;IACF;IAGF,OAAO;AACT;AAGO,eAAe;IACpB,MAAM,WAAW,MAAM;IAEvB,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAEnD,IAAI,SAAS,CAAC,MAAM,MAAM;YACxB,OAAO;gBAAE,MAAM;gBAAM;YAAM;QAC7B;QAEA,OAAO;YAAE,MAAM,KAAK,IAAI;YAAE,OAAO;QAAK;IACxC,EAAE,OAAO,KAAK;QACZ,OAAO;YAAE,MAAM;YAAM,OAAO;QAAI;IAClC;AACF"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/auth/requireUser.ts"],"sourcesContent":["import \"server-only\";\nimport { createSupabaseServer } from \"@/lib/supabaseServer\";\n\nexport class AuthRequiredError extends Error {\n  code = \"AUTH_REQUIRED\";\n  status = 401;\n  constructor(message = \"Autenticação obrigatória\") {\n    super(message);\n    this.name = \"AuthRequiredError\";\n  }\n}\n\n/**\n * Obtém o utilizador autenticado (server-side).\n * Lança AuthRequiredError se não existir sessão válida.\n */\nexport async function requireUser() {\n  const supabase = await createSupabaseServer();\n  const { data, error } = await supabase.auth.getUser();\n\n  if (error || !data?.user) {\n    throw new AuthRequiredError();\n  }\n\n  return data.user;\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,0BAA0B;IACrC,OAAO,gBAAgB;IACvB,SAAS,IAAI;IACb,YAAY,UAAU,0BAA0B,CAAE;QAChD,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAMO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,+IAAoB;IAC3C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAEnD,IAAI,SAAS,CAAC,MAAM,MAAM;QACxB,MAAM,IAAI;IACZ;IAEA,OAAO,KAAK,IAAI;AAClB"}},
    {"offset": {"line": 257, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/lib/supabaseAdmin.ts"],"sourcesContent":["import \"server-only\";\nimport { createClient } from \"@supabase/supabase-js\";\nimport { env } from \"@/lib/env\";\n\nexport const supabaseAdmin = createClient(env.supabaseUrl, env.serviceRoleKey);\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,MAAM,gBAAgB,IAAA,yMAAY,EAAC,mHAAG,CAAC,WAAW,EAAE,mHAAG,CAAC,cAAc"}},
    {"offset": {"line": 272, "column": 0}, "map": {"version":3,"sources":["file:///Users/nuno/orya/ORYA-WebApp/app/api/upload/route.ts"],"sourcesContent":["// app/api/upload/route.ts\nexport const runtime = \"nodejs\";\nexport const dynamic = \"force-dynamic\";\n\nimport { NextRequest, NextResponse } from \"next/server\";\nimport crypto from \"crypto\";\nimport { AuthRequiredError, requireUser } from \"@/lib/auth/requireUser\";\nimport { supabaseAdmin } from \"@/lib/supabaseAdmin\";\nimport { env } from \"@/lib/env\";\n\nconst MAX_UPLOAD_BYTES = 5 * 1024 * 1024; // 5MB\nconst UPLOAD_WINDOW_MS = 5 * 60 * 1000; // 5 minutos\nconst MAX_UPLOADS_PER_WINDOW = 30;\nconst ipHits = new Map<string, number[]>();\n\ntype DetectedImage = { ext: string; mime: string };\n\nfunction detectImageType(buffer: Buffer): DetectedImage | null {\n  if (buffer.length < 12) return null;\n\n  // PNG\n  if (buffer.slice(0, 8).equals(Buffer.from([0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a]))) {\n    return { ext: \"png\", mime: \"image/png\" };\n  }\n\n  // JPEG\n  if (buffer[0] === 0xff && buffer[1] === 0xd8 && buffer[2] === 0xff) {\n    return { ext: \"jpg\", mime: \"image/jpeg\" };\n  }\n\n  // GIF\n  const gifHeader = buffer.slice(0, 6).toString(\"ascii\");\n  if (gifHeader === \"GIF87a\" || gifHeader === \"GIF89a\") {\n    return { ext: \"gif\", mime: \"image/gif\" };\n  }\n\n  // WebP\n  const riffHeader = buffer.slice(0, 4).toString(\"ascii\");\n  const webpHeader = buffer.slice(8, 12).toString(\"ascii\");\n  if (riffHeader === \"RIFF\" && webpHeader === \"WEBP\") {\n    return { ext: \"webp\", mime: \"image/webp\" };\n  }\n\n  return null;\n}\n\nfunction getClientIp(req: NextRequest) {\n  const header = req.headers.get(\"x-forwarded-for\") || \"\";\n  const first = header.split(\",\")[0]?.trim();\n  return first || \"unknown\";\n}\n\nfunction isRateLimited(ip: string) {\n  const now = Date.now();\n  const windowStart = now - UPLOAD_WINDOW_MS;\n  const hits = ipHits.get(ip)?.filter((ts) => ts > windowStart) ?? [];\n  hits.push(now);\n  ipHits.set(ip, hits);\n  return hits.length > MAX_UPLOADS_PER_WINDOW;\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    await requireUser(); // só utilizadores autenticados podem fazer upload\n\n    const ip = getClientIp(req);\n    if (isRateLimited(ip)) {\n      return NextResponse.json({ error: \"Demasiados uploads. Tenta mais tarde.\" }, { status: 429 });\n    }\n\n    const contentLengthHeader = req.headers.get(\"content-length\");\n    const declaredSize = contentLengthHeader ? Number(contentLengthHeader) : null;\n    if (declaredSize && (!Number.isFinite(declaredSize) || declaredSize > MAX_UPLOAD_BYTES)) {\n      return NextResponse.json(\n        { error: \"Ficheiro demasiado grande.\" },\n        { status: 413 },\n      );\n    }\n\n    const formData = await req.formData();\n    const file = formData.get(\"file\");\n\n    if (!(file instanceof File)) {\n      return NextResponse.json({ error: \"Nenhum ficheiro enviado.\" }, { status: 400 });\n    }\n\n    const bytes = await file.arrayBuffer();\n    const buffer = Buffer.from(bytes);\n\n    if (buffer.byteLength === 0) {\n      return NextResponse.json({ error: \"Ficheiro vazio.\" }, { status: 400 });\n    }\n    if (buffer.byteLength > MAX_UPLOAD_BYTES) {\n      return NextResponse.json({ error: \"Ficheiro demasiado grande.\" }, { status: 413 });\n    }\n\n    const detected = detectImageType(buffer);\n    if (!detected) {\n      return NextResponse.json({ error: \"Só são permitidas imagens (png, jpg, gif, webp).\" }, { status: 400 });\n    }\n\n    const scope = req.nextUrl.searchParams.get(\"scope\");\n\n    const bucketResolution = (() => {\n      if (scope === \"avatar\") {\n        if (env.avatarsBucket) return { bucket: env.avatarsBucket, folder: \"avatars\" };\n        // fallback para bucket geral se avatars não estiver configurado\n        return { bucket: env.uploadsBucket || \"uploads\", folder: \"avatars\" };\n      }\n      if (scope === \"event-cover\") {\n        if (env.eventCoversBucket) return { bucket: env.eventCoversBucket, folder: \"event-covers\" };\n        return { bucket: env.uploadsBucket || \"uploads\", folder: \"event-covers\" };\n      }\n      // default/general uploads\n      return { bucket: env.uploadsBucket || \"uploads\", folder: \"uploads\" };\n    })();\n\n    if (!bucketResolution.bucket) {\n      return NextResponse.json({ error: \"Bucket de storage não configurado.\" }, { status: 500 });\n    }\n\n    const randomName = crypto.randomBytes(16).toString(\"hex\");\n    const filename = `${Date.now()}-${randomName}.${detected.ext}`;\n    const objectPath = `${bucketResolution.folder}/${filename}`;\n\n    const uploadRes = await supabaseAdmin.storage\n      .from(bucketResolution.bucket)\n      .upload(objectPath, buffer, {\n        contentType: detected.mime,\n        cacheControl: \"3600\",\n        upsert: false,\n      });\n\n    if (uploadRes.error) {\n      console.error(\"[POST /api/upload] supabase upload error\", uploadRes.error);\n      return NextResponse.json({ error: \"Erro ao fazer upload da imagem.\" }, { status: 500 });\n    }\n\n    let url: string | null = null;\n    let signedUrl: string | null = null;\n\n    if (env.storageSignedUrls) {\n      const signed = await supabaseAdmin.storage\n        .from(bucketResolution.bucket)\n        .createSignedUrl(objectPath, env.storageSignedTtlSeconds);\n      if (signed.error || !signed.data?.signedUrl) {\n        console.error(\"[POST /api/upload] signed url error\", signed.error);\n        return NextResponse.json({ error: \"Erro ao gerar URL de download.\" }, { status: 500 });\n      }\n      signedUrl = signed.data.signedUrl;\n      url = signedUrl;\n    } else {\n      const { data: publicUrlData } = supabaseAdmin.storage.from(bucketResolution.bucket).getPublicUrl(objectPath);\n      url = publicUrlData.publicUrl;\n    }\n\n    return NextResponse.json(\n      {\n        url,\n        signedUrl,\n        mime: detected.mime,\n        size: buffer.byteLength,\n        scope: scope ?? \"general\",\n        bucket: bucketResolution.bucket,\n      },\n      { status: 201 },\n    );\n  } catch (err) {\n    if (err instanceof AuthRequiredError) {\n      return NextResponse.json({ error: \"Precisas de iniciar sessão.\" }, { status: 401 });\n    }\n    console.error(\"[POST /api/upload]\", err);\n    return NextResponse.json(\n      { error: \"Erro ao fazer upload da imagem.\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}